<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.45">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/icon/111.ico"><title>MyBatis | shAilene</title><meta name="description" content="just be simple.">
    <link rel="modulepreload" href="/study/assets/app.4069d6c3.js"><link rel="modulepreload" href="/study/assets/Mybatis.html.efeaf0a0.js"><link rel="modulepreload" href="/study/assets/Mybatis.html.ba780e59.js"><link rel="prefetch" href="/study/assets/index.html.790dca3f.js"><link rel="prefetch" href="/study/assets/index.html.01169d55.js"><link rel="prefetch" href="/study/assets/index.html.a3c150a8.js"><link rel="prefetch" href="/study/assets/index.html.f8939ddf.js"><link rel="prefetch" href="/study/assets/gin.html.61514f05.js"><link rel="prefetch" href="/study/assets/golang.html.930f8c9e.js"><link rel="prefetch" href="/study/assets/gorm.html.da6f2fc9.js"><link rel="prefetch" href="/study/assets/Javaweb.html.af29281b.js"><link rel="prefetch" href="/study/assets/一些知识点的记录.html.a43a2686.js"><link rel="prefetch" href="/study/assets/Java笔记.html.de9ec565.js"><link rel="prefetch" href="/study/assets/dubbo.html.205a25a9.js"><link rel="prefetch" href="/study/assets/springcloud（上）.html.3f4ef1a1.js"><link rel="prefetch" href="/study/assets/springcloud（下）.html.002e12e5.js"><link rel="prefetch" href="/study/assets/zookeeper.html.4b974878.js"><link rel="prefetch" href="/study/assets/《并发编程的艺术》笔记.html.4756d930.js"><link rel="prefetch" href="/study/assets/并发编程.html.c775283f.js"><link rel="prefetch" href="/study/assets/尚硅谷_宋红康_JDBC.html.720e22a6.js"><link rel="prefetch" href="/study/assets/redis.html.0c075c9e.js"><link rel="prefetch" href="/study/assets/spring.html.996bbe54.js"><link rel="prefetch" href="/study/assets/springboot.html.98b8e1be.js"><link rel="prefetch" href="/study/assets/springboot.html.2e82dfe3.js"><link rel="prefetch" href="/study/assets/springMVC.html.d9ae1b95.js"><link rel="prefetch" href="/study/assets/RabbitMQ.html.01d13c06.js"><link rel="prefetch" href="/study/assets/操作系统.html.e9fca663.js"><link rel="prefetch" href="/study/assets/MySQL数据库笔记-第一部分.html.5b88ac17.js"><link rel="prefetch" href="/study/assets/MySQL数据库笔记-第二部分.html.9a0d542a.js"><link rel="prefetch" href="/study/assets/404.html.93146c89.js"><link rel="prefetch" href="/study/assets/index.html.baf04ea4.js"><link rel="prefetch" href="/study/assets/index.html.bde41b3c.js"><link rel="prefetch" href="/study/assets/index.html.71d450e3.js"><link rel="prefetch" href="/study/assets/index.html.6c2c0e88.js"><link rel="prefetch" href="/study/assets/gin.html.cfbce436.js"><link rel="prefetch" href="/study/assets/golang.html.8cf974bb.js"><link rel="prefetch" href="/study/assets/gorm.html.c1e053df.js"><link rel="prefetch" href="/study/assets/Javaweb.html.96fcefe4.js"><link rel="prefetch" href="/study/assets/一些知识点的记录.html.6415bd6c.js"><link rel="prefetch" href="/study/assets/Java笔记.html.4e742aa7.js"><link rel="prefetch" href="/study/assets/dubbo.html.077798ab.js"><link rel="prefetch" href="/study/assets/springcloud（上）.html.b83d54fe.js"><link rel="prefetch" href="/study/assets/springcloud（下）.html.16500d6d.js"><link rel="prefetch" href="/study/assets/zookeeper.html.e441ceda.js"><link rel="prefetch" href="/study/assets/《并发编程的艺术》笔记.html.ff3789f0.js"><link rel="prefetch" href="/study/assets/并发编程.html.c7201f16.js"><link rel="prefetch" href="/study/assets/尚硅谷_宋红康_JDBC.html.1c0b86c6.js"><link rel="prefetch" href="/study/assets/redis.html.ddb3b824.js"><link rel="prefetch" href="/study/assets/spring.html.8d8d3abd.js"><link rel="prefetch" href="/study/assets/springboot.html.79db4984.js"><link rel="prefetch" href="/study/assets/springboot.html.651d2e76.js"><link rel="prefetch" href="/study/assets/springMVC.html.a3989ff0.js"><link rel="prefetch" href="/study/assets/RabbitMQ.html.316d3e97.js"><link rel="prefetch" href="/study/assets/操作系统.html.abe01acb.js"><link rel="prefetch" href="/study/assets/MySQL数据库笔记-第一部分.html.d6c51fa9.js"><link rel="prefetch" href="/study/assets/MySQL数据库笔记-第二部分.html.00a449cd.js"><link rel="prefetch" href="/study/assets/404.html.2cb4c0bf.js"><link rel="prefetch" href="/study/assets/404.80047ee6.js"><link rel="prefetch" href="/study/assets/Layout.2e4a5b19.js">
    <link rel="stylesheet" href="/study/assets/style.2bba04cf.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/study/" class=""><img class="logo" src="/study/images/leo.jpg" alt="shAilene"><span class="site-name can-hide">shAilene</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/study/java/" class="router-link-active" aria-label="Java"><!--[--><!--]--> Java <!--[--><!--]--></a></div><div class="navbar-item"><a href="/study/go/" class="" aria-label="Go"><!--[--><!--]--> Go <!--[--><!--]--></a></div><div class="navbar-item"><a href="/study/python/" class="" aria-label="Python"><!--[--><!--]--> Python <!--[--><!--]--></a></div><div class="navbar-item"><a href="/study/mw/" class="" aria-label="中间件"><!--[--><!--]--> 中间件 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/study/java/" class="router-link-active" aria-label="Java"><!--[--><!--]--> Java <!--[--><!--]--></a></div><div class="navbar-item"><a href="/study/go/" class="" aria-label="Go"><!--[--><!--]--> Go <!--[--><!--]--></a></div><div class="navbar-item"><a href="/study/python/" class="" aria-label="Python"><!--[--><!--]--> Python <!--[--><!--]--></a></div><div class="navbar-item"><a href="/study/mw/" class="" aria-label="中间件"><!--[--><!--]--> 中间件 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">MyBatis <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#第1章-框架概述" class="router-link-active router-link-exact-active sidebar-item" aria-label="第1章 框架概述"><!--[--><!--]--> 第1章 框架概述 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#三层架构" class="router-link-active router-link-exact-active sidebar-item" aria-label="三层架构"><!--[--><!--]--> 三层架构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#框架定义" class="router-link-active router-link-exact-active sidebar-item" aria-label="框架定义"><!--[--><!--]--> 框架定义 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#使用jdbc的缺陷" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用JDBC的缺陷"><!--[--><!--]--> 使用JDBC的缺陷 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#mybatis框架概述" class="router-link-active router-link-exact-active sidebar-item" aria-label="Mybatis框架概述"><!--[--><!--]--> Mybatis框架概述 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#第2章-mybatis快速入门" class="router-link-active router-link-exact-active sidebar-item" aria-label="第2章 MyBatis快速入门"><!--[--><!--]--> 第2章 MyBatis快速入门 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#mybatis入门例子" class="router-link-active router-link-exact-active sidebar-item" aria-label="MyBatis入门例子"><!--[--><!--]--> MyBatis入门例子 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#实现步骤" class="router-link-active router-link-exact-active sidebar-item" aria-label="实现步骤"><!--[--><!--]--> 实现步骤 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#sql映射文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="sql映射文件"><!--[--><!--]--> sql映射文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#mybatis主配置文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="mybatis主配置文件"><!--[--><!--]--> mybatis主配置文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#通过mybatis访问数据库" class="router-link-active router-link-exact-active sidebar-item" aria-label="通过mybatis访问数据库"><!--[--><!--]--> 通过mybatis访问数据库 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#mybatis用到的类和对象的介绍" class="router-link-active router-link-exact-active sidebar-item" aria-label="Mybatis用到的类和对象的介绍"><!--[--><!--]--> Mybatis用到的类和对象的介绍 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#创建sqlsession所需要的类" class="router-link-active router-link-exact-active sidebar-item" aria-label="创建SqlSession所需要的类"><!--[--><!--]--> 创建SqlSession所需要的类 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#mybatis工具类写法" class="router-link-active router-link-exact-active sidebar-item" aria-label="MyBatis工具类写法"><!--[--><!--]--> MyBatis工具类写法 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#第3章-mybatis框架的dao代理" class="router-link-active router-link-exact-active sidebar-item" aria-label="第3章 MyBatis框架的Dao代理"><!--[--><!--]--> 第3章 MyBatis框架的Dao代理 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#dao代理实现数据库操作" class="router-link-active router-link-exact-active sidebar-item" aria-label="DAO代理实现数据库操作"><!--[--><!--]--> DAO代理实现数据库操作 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#实现原理" class="router-link-active router-link-exact-active sidebar-item" aria-label="实现原理"><!--[--><!--]--> 实现原理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#实现步骤-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="实现步骤"><!--[--><!--]--> 实现步骤 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#深入理解参数" class="router-link-active router-link-exact-active sidebar-item" aria-label="深入理解参数"><!--[--><!--]--> 深入理解参数 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#parametertype" class="router-link-active router-link-exact-active sidebar-item" aria-label="parameterType"><!--[--><!--]--> parameterType <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#sql-mapper-映射文件-一个简单类型的参数传值方式" class="router-link-active router-link-exact-active sidebar-item" aria-label="sql mapper 映射文件，一个简单类型的参数传值方式"><!--[--><!--]--> sql mapper 映射文件，一个简单类型的参数传值方式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#sql-mapper-映射文件-多个参数传值方式" class="router-link-active router-link-exact-active sidebar-item" aria-label="sql mapper 映射文件，多个参数传值方式"><!--[--><!--]--> sql mapper 映射文件，多个参数传值方式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#和" class="router-link-active router-link-exact-active sidebar-item" aria-label="## 和 $"><!--[--><!--]--> ## 和 $ <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#mybatis的返回结果" class="router-link-active router-link-exact-active sidebar-item" aria-label="Mybatis的返回结果"><!--[--><!--]--> Mybatis的返回结果 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#resulttype" class="router-link-active router-link-exact-active sidebar-item" aria-label="resultType"><!--[--><!--]--> resultType <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#resultmap" class="router-link-active router-link-exact-active sidebar-item" aria-label="resultMap"><!--[--><!--]--> resultMap <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#mybatis模糊查询的两种方式" class="router-link-active router-link-exact-active sidebar-item" aria-label="Mybatis模糊查询的两种方式"><!--[--><!--]--> Mybatis模糊查询的两种方式 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#第4章-动态sql" class="router-link-active router-link-exact-active sidebar-item" aria-label="第4章 动态SQL"><!--[--><!--]--> 第4章 动态SQL <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#概述" class="router-link-active router-link-exact-active sidebar-item" aria-label="概述"><!--[--><!--]--> 概述 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#介绍三种标签" class="router-link-active router-link-exact-active sidebar-item" aria-label="介绍三种标签"><!--[--><!--]--> 介绍三种标签 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#代码片段" class="router-link-active router-link-exact-active sidebar-item" aria-label="代码片段"><!--[--><!--]--> 代码片段 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#第5章-mybatis配置文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="第5章 MyBatis配置文件"><!--[--><!--]--> 第5章 MyBatis配置文件 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#主配置文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="主配置文件"><!--[--><!--]--> 主配置文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#数据库属性配置文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="数据库属性配置文件"><!--[--><!--]--> 数据库属性配置文件 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#补充" class="router-link-active router-link-exact-active sidebar-item" aria-label="补充"><!--[--><!--]--> 补充 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/study/java/%E6%A1%86%E6%9E%B6/mybatis/Mybatis.html#使用pagehelper在mybatis来自动帮助分页" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用PageHelper在mybatis来自动帮助分页"><!--[--><!--]--> 使用PageHelper在mybatis来自动帮助分页 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="mybatis" tabindex="-1"><a class="header-anchor" href="#mybatis" aria-hidden="true">#</a> MyBatis</h1><h2 id="第1章-框架概述" tabindex="-1"><a class="header-anchor" href="#第1章-框架概述" aria-hidden="true">#</a> 第1章 框架概述</h2><h3 id="三层架构" tabindex="-1"><a class="header-anchor" href="#三层架构" aria-hidden="true">#</a> 三层架构</h3><ol><li><p><img src="/study/assets/image-20210910213003041.a7e1ac01.png" alt="image-20210910213003041"></p></li><li><p>三层对应的包：</p><p><strong>界面层：controller包（servlet）</strong></p><p><strong>业务逻辑层：service包（XXXService类）</strong></p><p><strong>数据访问层：dao包（XXXDao类）</strong></p><p>我认为MVC中的V在spring这三层架构下，V已经被分离出去，C代表的业务逻辑层，就是controller+service</p></li><li><p>MVC三层架构，M代表数据，V代表视图，C代表控制，也就是业务逻辑处理。</p><p>MVC中的C就代表了springboot中的controller层和service层。</p><p>V就是界面层，M就是数据访问层，C就是业务逻辑层。</p><p>用户---&gt;界面层----&gt;业务逻辑层----&gt;数据访问层----&gt;数据库</p></li><li><p>在springBoot中，业务逻辑层又分为了controller层和service层，视图层被拿了出去，实现了前后端的分离，</p><p>controller层用于接受请求，调用service层处理请求，返回请求，以JSON或XML格式返回给前端页面进行处理。这涉及到REST</p><p>service层 专心处理业务逻辑，并调用DAO层</p><p>总结：</p><ul><li>controller层----web层，有的也叫界面层，但实际和html、jsp不是一类，**这一层做的就是servlet做的工作，接收、处理请求，返回请求的结果。**在springboot中，不和界面挂钩，返回xml或json格式的结果给前端。------<strong>对应框架：springMVC</strong></li><li>service层---业务逻辑层，专心处理业务逻辑------<strong>对应框架：spring</strong></li><li>DAO层---持久层，和数据库打交道------<strong>对应框架：mybatis</strong></li></ul></li><li><p>根据第二点：</p><p><strong>controller层 对应 spring MVC : 接收请求，响应处理结果</strong></p><p><strong>service层 对应 spring ： 处理业务，返回处理结果给controller层</strong></p><p><strong>DAO层 对应 mybatis</strong></p></li></ol><h3 id="框架定义" tabindex="-1"><a class="header-anchor" href="#框架定义" aria-hidden="true">#</a> 框架定义</h3><ol><li><p>框架中定义好了一些功能、组件，这些功能、组件是可用的，</p><p>自己写的项目中的功能，可以利用框架中已有的功能</p><p>框架是一个半成品的软件，定义好了一些基础功能，需要加入自己的功能才是完整的。</p><p>这些基础功能是可重复使用的，可升级的。</p><p><strong>框架是一个提供好了基础功能的平台</strong></p></li><li><p>框架是整个或部分系统的可重用设计</p><p>是安全的、可复用的、不断升级的软件。是写好一部分功能、组件的软件，这些功能、组件供我们开发出完整的产品。</p></li><li><p>框架特点：</p><ul><li>框架一般不是全能的，不能做所有事情</li><li>框架是针对某一个领域有效，特长在某一个方面，比如mybatis，做数据库操作强。</li></ul></li></ol><h3 id="使用jdbc的缺陷" tabindex="-1"><a class="header-anchor" href="#使用jdbc的缺陷" aria-hidden="true">#</a> 使用JDBC的缺陷</h3><ol><li>代码比较多，开发效率低</li><li>需要关注Connection、Statement、ResultSet对象创建和销毁</li><li>对ResultSet查询的结果，需要自己封装为List</li><li>重复的代码比较多些。</li><li><strong>业务代码和数据库的操作混杂在一起。</strong></li></ol><h3 id="mybatis框架概述" tabindex="-1"><a class="header-anchor" href="#mybatis框架概述" aria-hidden="true">#</a> Mybatis框架概述</h3><ol><li><p>Mybatis是一个框架，用于DAO层，提供了访问数据库的基本功能，改进了JDBC的缺点</p></li><li><p>解决的主要问题：</p><p>减轻JDBC的复杂性，不用重复的创建connection，关闭connection（即使我们已经把创建connection和关闭connection封装到了专门的工具类里），不用重复编写statement，不用考虑资源代码的关闭</p><p><strong>目的：让开发者专心SQL的处理，其他这些关于数据库的操作，由Mybatis代劳</strong></p><p>在JDBC中，虽然我们创建了工具类，但是还是要不断调用创建connection的方法，在BaseDAO抽象类提供的方法里，虽然connection是传入的，但是每次都要关闭资源</p></li><li><p><strong>Mybatis 是SQL Mapper Framework for Java 即 sql映射框架</strong></p><ul><li><p>SQL mapper ： SQL映射：</p><p><strong>是说我们可以把数据库中表中的一行数据映射为一个Java类的实例化对象（一行数据是具体的，所以是实例化对象）</strong></p><p><strong>数据库中的一个表对应于一个Java类</strong></p><p>这是ORM思想，对象关系映射思想。</p></li><li><p>Data Access Objects：</p><p>数据访问，即对数据库执行增删改查操作。</p></li></ul></li><li><p>mybatis提供了哪些功能</p><ul><li>提供了创建connection、statement、ResultSet的能力，不用开发人员创建了</li><li>提供了执行SQL语句的能力（之前JDBC通过QueryRunner执行），不用开发人员执行sql</li><li>提供了循环SQL，把SQL的结果转为Java对象，List集合的能力</li><li>提供了关闭资源的能力，不用开发人员关闭Connection、Statement等。</li></ul><p><strong>开发人员做的是：提供SQL语句</strong></p><p><strong>开发人员提供sql语句---mybatis处理sql----开发人员得到List集合或Java对象（表中的数据映射到Java层面）</strong></p><p><strong>也就是对数据库的操作，交给Mybatis执行，开发人员只提供SQL，专注于业务的处理.和数据库打交道的一些流水线工作,交给mybatis处理</strong></p></li><li><p>mybatis是一个SQL映射框架，提供的数据库的操作能力，是增强的JDBC</p></li></ol><h2 id="第2章-mybatis快速入门" tabindex="-1"><a class="header-anchor" href="#第2章-mybatis快速入门" aria-hidden="true">#</a> 第2章 MyBatis快速入门</h2><h3 id="mybatis入门例子" tabindex="-1"><a class="header-anchor" href="#mybatis入门例子" aria-hidden="true">#</a> MyBatis入门例子</h3><h4 id="实现步骤" tabindex="-1"><a class="header-anchor" href="#实现步骤" aria-hidden="true">#</a> 实现步骤</h4><ol><li><p>新建数据库</p></li><li><p>新建表</p></li><li><p>创建maven项目</p></li><li><p><strong>添加mybatis依赖，添加MYSQL驱动connector依赖</strong></p></li><li><p>创建实体类（Java Bean），对应于mysql中一个表，表中一行数据对应于Java层面的一个类的对象，这是ORM，<strong>对象关系映射模型</strong></p></li><li><p>创建持久层的DAO接口，定义操作数据库的方法，此方法名要作为SQL语句标签的ID，标识所要执行的SQL语句。而SQL语句的ID和接口里的方法名是相同的</p><p>nameSpace + “.”+此ID = sqlId</p><p>nameSpace为接口的全限定名。</p></li><li><p><strong>创建sql映射文件(也叫mapper文件)</strong></p><p><strong>sql映射文件：写sql语句的，一般一个表（对应一个类）对应一个sql映射文件</strong></p><p><strong>这个文件是xml文件，写在接口所在的目录中，这个文件的名称和接口保持一致</strong></p></li><li><p>创建mybatis主配置文件：</p><p>一个项目就一个主配置文件</p><p>主配置文件提供了</p><ul><li><p>数据库的连接信息（环境信息，即主配置文件中的environment），除了连接信息，还有事务信息，是否使用连接池等。</p></li><li><p>SQL映射文件的位置信息</p><p>可以写多个SQL映射文件</p></li></ul></li><li><p>创建使用mybatis类</p><p>通过mybatis访问数据库</p><p>使用mybatis的对象SqlSession，通过它的方法执行sql语句</p></li></ol><h4 id="sql映射文件" tabindex="-1"><a class="header-anchor" href="#sql映射文件" aria-hidden="true">#</a> sql映射文件</h4><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span>
        <span class="token name">PUBLIC</span> <span class="token string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
        <span class="token string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.example.dao.StudentDao<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--
        select：表示查询操作
        id：你要执行的sql语句的唯一标识，mybatis会使用这个id的值来找到要执行的sql语句，这个id和数据库中表的属性那个id不一样！！！
        可以自定义，但是要求使用接口中的方法名称
        resultType: 表示结果类型的，是sql语句执行后得到的ResultSet，遍历这个ResultSet得到的Java对象的类型，就不需要像JDBC一样，我们得到ResultSet，然后自己做赋值操作，将ResultSet里的值赋值给对象。
        值写的是类型的全限定名称
    --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectStudent<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.example.domain.Student<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select id, name, email, age from student order by id;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--
    sql映射文件：写sql语句的，mybatis会执行这些sql
    1. 指定约束文件
    &lt;!DOCTYPE mapper
        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
    mybatis-3-mapper.dtd是约束文件的名称，扩展名是dtd的
    2. 约束文件作用：限制，检查在当前文件中出现的标签，属性必须符合mybatis的要求

    3. mapper是当前文件的根标签，必须的。
       namespace：叫做命名空间，唯一值的，可以是自定义的字符串
                  虽然是自定义字符串，但是我们要求使用dao接口的全限定名称
    4. 在当前文件中，可以使用特定的标签，表示数据库的特定操作
       &lt;select&gt; 表示执行查询
       &lt;update&gt;  表示更新数据库的操作，就是在&lt;update&gt;标签中，写的update sql语句
       &lt;delete&gt;  表示删除  写的是delete语句
       &lt;insert&gt;  表示插入，写的是insert语句
 --&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="mybatis主配置文件" tabindex="-1"><a class="header-anchor" href="#mybatis主配置文件" aria-hidden="true">#</a> mybatis主配置文件</h4><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>mybatis 的主配置文件：主要定义了数据库的配置信息，sql映射文件的位置
    1. 约束文件
    &lt;!DOCTYPE configuration
        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
    mybatis-3-config.dtd 是约束文件的名称，固定值
    2. configuration:各种配置信息
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">configuration</span>
        <span class="token name">PUBLIC</span> <span class="token string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span>
        <span class="token string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 环境配置，是数据库的连接信息 --&gt;</span>
    <span class="token comment">&lt;!-- 可以配置多个环境--&gt;</span>
    <span class="token comment">&lt;!-- 这个标签是environments，内部配置了多个环境，
	default属性的值必须和其中一个环境的id是一样的，告诉mybatis使用哪个数据库的连接信息--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environments</span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mydev<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--
            environment：一个数据库信息的配置，环境
            id: 一个唯一值，自定义，表示环境的名称，给这段配置起个名字
        --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mydev<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--
                transactionManager：mybatis的事务类型
                type:
					1.JDBC(表示使用jdbc中的Connection对象的commit、rollback做事务处理)
					2.MANAGED:把mybatis的事务处理委托给其他的容器（一个服务器软件，一个框架（spring））
             --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>JDBC<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token comment">&lt;!--
                dataSource：表示数据源，连接数据库的，数据源表示connection对象
							Java体系中，规定实现了javax.sql.DataSource接口的都是数据源
                type：表示数据源的类型，
					1. POOLED表示使用连接池
					2. UNPOOLED 不使用连接池，在每次执行sql语句时，先创建连接，执行sql，再关闭连接
						mybatis会创建一个UnpooledDataSource对象，来管理connection对象的使用
					3. JDNI:JAVA命名和目录服务（windows注册表）
             --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POOLED<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token comment">&lt;!-- property是标签，name是属性，name属性的值不能改！！！是固定的。--&gt;</span>
                <span class="token comment">&lt;!-- 数据库的驱动类名--&gt;</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>driver<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.mysql.jdbc.Driver<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbc:mysql://localhost:3306/test?serverTimezone=Asia/Shanghai<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>123456<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environments</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- sql mapper文件的位置 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--
			一个mapper标签指定一个sql mapper文件的位置
			从类路径开始的路径信息。target/classes（类路径）
		--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org/mybatis/example/BlogMapper.xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--
    mybatis 的主配置文件：主要定义了数据库的配置信息，sql映射文件的位置
    1. 约束文件
    &lt;!DOCTYPE configuration
        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
    mybatis-3-config.dtd 是约束文件的名称，固定值
    2. configuration:各种配置信息

 --&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- &lt;configuration&gt;下的&lt;settings&gt;是控制mybatis的全局行为 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- 设置mybatis输出日志 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>logImpl<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>STDOUT_LOGGING<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>主配置文件做两个事情：</p><ol><li><p><strong>配置好环境信息，包括连接信息、是否使用连接池、默认环境名、事务类型。</strong></p></li><li><p><strong>指定sql映射文件的位置，即sql mapper文件。注意这个文件要从类路径写全名。</strong></p><p><strong>mapper标签可以出现多次，即可以配置多个SQL mapper文件。</strong></p><p><strong>可以通过编译，看到sql mapper文件在类路径下的地方，</strong></p><p><strong>如果看不到，在pom文件中添加以下内容在build标签里，意思是如果不添加，那么包下的xml或properties等配置文件，在编译的过程中会自动忽略掉，但是加上以下配置之后，意思就是目录下的这些配置文件在编译时仍然会被扫描到。</strong></p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">&gt;</span></span>src/main/java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!-- 包括目录下的.properties,.xml文件都会扫描到 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">&gt;</span></span>**/*.properties<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">&gt;</span></span>**/*.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h4 id="通过mybatis访问数据库" tabindex="-1"><a class="header-anchor" href="#通过mybatis访问数据库" aria-hidden="true">#</a> 通过mybatis访问数据库</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token comment">// 访问mybatis读取数据库中数据</span>
        <span class="token comment">//1. 定义mybatis主配置文件的名称</span>
        <span class="token class-name">String</span> config <span class="token operator">=</span> <span class="token string">&quot;mybatis.xml&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// 2. 读取这个config表示的文件</span>
        <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3. 创建SqlSessionFactoryBuilder对象</span>
        <span class="token class-name">SqlSessionFactoryBuilder</span> sqlSessionFactoryBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//4. 创建SqlSessionFactory对象</span>
        <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> sqlSessionFactoryBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//5. 获取SqlSession对象，从SqlSessionFactory中获取SqlSession对象</span>
        <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//6. 指定要执行的SQL语句的标识即sql语句id。sql映射文件中的namespace + &quot;.&quot; + 标签的id值</span>
        <span class="token class-name">String</span> sqlId <span class="token operator">=</span> <span class="token string">&quot;com.example.dao.StudentDao&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;selectStudent&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//7. 执行sql语句，通过sqlId找到语句</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> studentList <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>sqlId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//8. 输出结果</span>
        studentList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//9. 关闭SqlSession</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>注意：mybatis不是默认提交事务的（不过还是要看创建SqlSession所调用的构造方法），如果执行的是插入或者更新、删除操作而不是查询（DQL）操作，那么就要在insert、update、delete后手动提交事务。事务的处理方式，是在主配置文件中的环境配置中声明的，采用的是JDBC的事务处理方式，即commit 和 rollback</strong></p><p><strong>如果不想手动提交事务，那么通过SqlSessionFactory的实例化对象获取SqlSession的时候，调用openSession方法，传入参数true，即为创建具有自动提交的SqlSession</strong></p><h3 id="mybatis用到的类和对象的介绍" tabindex="-1"><a class="header-anchor" href="#mybatis用到的类和对象的介绍" aria-hidden="true">#</a> Mybatis用到的类和对象的介绍</h3><h4 id="创建sqlsession所需要的类" tabindex="-1"><a class="header-anchor" href="#创建sqlsession所需要的类" aria-hidden="true">#</a> 创建SqlSession所需要的类</h4><ol><li><p><code>Resources</code>类，工具类，负责读主配置文件</p></li><li><p><code>SqlSessionFactoryBuilder</code> 调用无参构造方法得到<code>sqlSessionFactoryBuilder</code>对象</p><p>目的是通过<code>sqlSessionFactoryBuilder</code>对象创建<code>SqlSessionFactory</code>对象</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//4. 创建SqlSessionFactory对象</span>
<span class="token comment">// 左边是接口，右边是接口的实现类的实例化对象。</span>
<span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> sqlSessionFactoryBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>SqlSessionFactory</code>重量级对象，就是程序创建这个对象，耗时比较长，使用资源比较多，在整个项目中有一个就够用了，整个项目只需创建一个这个对象</p><p>作用：获取<code>SqlSession</code>对象</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>方法说明：</p><p><code>openSession()</code>:无参数的，获取的是非自动提交事务的SqlSession对象</p><p><code>openSession(boolean)</code>:</p><ul><li><code>openSession(true)</code>:获取自动提交事务的SqlSession</li><li><code>openSession(false)</code>:获取非自动提交事务的SqlSession</li></ul></li><li><p><code>SqlSession</code>这是个接口（我们创建的是接口的实现类的实例化对象，也就是左边是接口，右边是实例化对象），执行方法，执行sql语句，类似于JDBC里的queryRunner</p><p>总之执行的是操作数据库用到的各种方法</p><p><code>selectOne() selectList() insert() update() delete() commit() rollback()</code></p><p><code>SqlSession</code>的实现类---<code>DefaultSqlSession</code></p><p><strong>使用要求：<code>SqlSession</code>的实例化对象不是线程安全的，需要在方法内部使用，在执行SQL语句之前，要使用openSession()获取SqlSession对象，在执行完SQL语句后，需要关闭它，执行SqlSession.close()，这样能保证在只用SqlSession过程中是线程安全的。</strong></p></li></ol><h4 id="mybatis工具类写法" tabindex="-1"><a class="header-anchor" href="#mybatis工具类写法" aria-hidden="true">#</a> MyBatis工具类写法</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>example<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Resources</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span></span><span class="token class-name">SqlSession</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span></span><span class="token class-name">SqlSessionFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span></span><span class="token class-name">SqlSessionFactoryBuilder</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MybatisUtils</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> config <span class="token operator">=</span> <span class="token string">&quot;mybatis.xml&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SqlSessionFactoryBuilder</span> sqlSessionFactoryBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sqlSessionFactory <span class="token operator">=</span> sqlSessionFactoryBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 获取SqlSession的方法，定义成静态的</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">SqlSession</span> <span class="token function">getSqlSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sqlSessionFactory <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> sqlSession<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="第3章-mybatis框架的dao代理" tabindex="-1"><a class="header-anchor" href="#第3章-mybatis框架的dao代理" aria-hidden="true">#</a> 第3章 MyBatis框架的Dao代理</h2><h3 id="dao代理实现数据库操作" tabindex="-1"><a class="header-anchor" href="#dao代理实现数据库操作" aria-hidden="true">#</a> DAO代理实现数据库操作</h3><h4 id="实现原理" tabindex="-1"><a class="header-anchor" href="#实现原理" aria-hidden="true">#</a> 实现原理</h4><ol><li><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StudentDao</span> studentDao <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StudentDaoImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> students <span class="token operator">=</span> studentDao<span class="token punctuation">.</span><span class="token function">selectStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        students<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        Student student = new Student(1111, &quot;富富&quot;, &quot;fufu@qq.com&quot;, 18);</span>
<span class="token comment">//        int count = studentDao.insertStudent(student);</span>
<span class="token comment">//        System.out.println(count);</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><strong>通过StudentDao接口，就可以拿到 StudentDao的全限定名称</strong></p></li><li><p><strong>通过studentDao实例化对象调用（或者说接口定义）的方法名就可以拿到SQL映射文件中Sql语句的语句id</strong></p><p><strong>通过拿到的全限定名和id就可以拿到<code>SqlSession</code>执行方法所需要的<code>sqlId</code></strong></p></li><li><p>而<code>SqlSession</code>的对象应该执行什么方法怎么拿到呢？</p><p>通过<code>StudentDao</code>接口中的方法的返回值可以确定<code>Mybatis</code>要调用的<code>SqlSession</code>的方法</p><ul><li>如果返回值是List，调用的是<code>SqlSession.selectList()</code>方法</li><li>如果返回值是int，或是非List的，看mapper文件中的标签是&lt;insert&gt;还是&lt;update&gt;来判断调用的是<code>SqlSession</code>的insert还是update方法</li></ul></li></ul><p><strong>在Dao接口的实现类Impl里，写的方法，内部有很多是相同的，唯一不同的两点就是sqlId，和SqlSession所调用的方法，而这两点可以分别通过上面的两点拿到，所以Mybatis可以通过动态代理来实现这个过程</strong></p><p>SqlId可以通过接口的全限定名成和<strong>接口实例化对象调用方法名</strong>组合起来拿到，也就是可以通过前面两点拿到</p><p>SqlSession调用方法可以通过mapper文件里的标签和<strong>接口实例化对象调用方法的返回值</strong>拿到。</p></li></ol><h4 id="实现步骤-1" tabindex="-1"><a class="header-anchor" href="#实现步骤-1" aria-hidden="true">#</a> 实现步骤</h4><ol><li><p>mybatis的动态代理</p><p>mybatis根据StudentDao接口的方法调用，获取执行sql语句的信息，比如sqlId</p><p><strong>mybatis根据dao接口，创建出一个dao接口的实现类，并创建这个类的对象</strong></p><p>完成SqlSession调用方法，访问数据库</p><p>这个过程叫动态代理</p><p><strong>也就是我们的程序中不需要创建Dao接口的实现类Impl了！！！！</strong></p><p><strong>mybatis帮我们完成这个过程！！帮我们创建Dao接口的实现类，并调用SqlSession访问数据库的方法</strong></p><p><strong>SqlSession的getMapper方法来自动获取DAO接口的实现类的实例化对象！！！！！！</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">selectStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token doc-comment comment">/**
         * 使用mybatis的动态代理机制，使用SqlSession.getMapper(dao 接口)
         * getMapper能获取dao接口对应的实现类对象
         */</span>
        <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> <span class="token class-name">MyBatisUtils</span><span class="token punctuation">.</span><span class="token function">getSqlSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 这行代码获得的studentDao实际是jdk的动态代理：com.sun.proxy.$Proxy2</span>
        <span class="token class-name">StudentDao</span> studentDao <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">StudentDao</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> students <span class="token operator">=</span> studentDao<span class="token punctuation">.</span><span class="token function">selectStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        students<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>现在只需要写主配置文件，SQL映射文件mapper和dao接口！！</strong></p><p>动态代理机制，是项目中主要开发方式</p></li><li><p>使用动态代理步骤</p><ul><li>获取SqlSession对象，SqlSessionFactory.openSession()</li><li>使用getMapper()方法获取某个接口的对象，sqlSession.getMapper(接口.class)</li><li>使用dao接口的方法，调用方法就执行了mapper文件中的sql语句</li></ul></li><li><p>使用动态代理方式的要求：</p><ul><li>mapper文件中的namespace的值是dao接口的全限定名称</li><li>mapper文件中的&lt;select&gt;&lt;insert&gt;&lt;update&gt;&lt;delete&gt;等sql语句的语句ID是接口中方法名称</li><li>dao接口和mapper文件放在同一个目录</li><li>dao接口的名称和mapper文件名称相同。</li></ul></li></ol><h3 id="深入理解参数" tabindex="-1"><a class="header-anchor" href="#深入理解参数" aria-hidden="true">#</a> 深入理解参数</h3><h4 id="parametertype" tabindex="-1"><a class="header-anchor" href="#parametertype" aria-hidden="true">#</a> parameterType</h4><ol><li><p>mybatis的接口的方法的形参是怎么通过Java代码对应到sql映射文件的sql语句的参数的？</p><p><strong>传入参数：从Java代码中把数据传入到mapper文件中的sql语句中</strong></p><p><code>parameterType</code>:写在mapper映射文件中的一个属性，表示dao接口中方法的形参的数据类型</p><p>例如StudentDao接口中有一个方法</p><p><code>public Student selectStudentById(Integer id)</code></p><p>可知，接口中定义的方法的形参类型是Integer</p><p><strong>那么parameterType就应该写在mapper文件中，值是Java数据类型的全限定名称或者mybatis定义的别名，表示dao接口中的这个形参的数据类型Integer</strong></p><p><code>parameterType</code>不是强制的，mybatis通过反射机制能够发现接口参数的数据类型</p><p>所以可以没有，一般我们也不写</p></li></ol><h4 id="sql-mapper-映射文件-一个简单类型的参数传值方式" tabindex="-1"><a class="header-anchor" href="#sql-mapper-映射文件-一个简单类型的参数传值方式" aria-hidden="true">#</a> sql mapper 映射文件，一个简单类型的参数传值方式</h4><ol><li><p><strong>简单类型：mybatis把Java的基本数据类型和String都叫做简单类型</strong></p><p>在mapper文件获取简单类型的一个参数的值：使用**#{任意字符}**</p></li><li><p>一个简单类型的参数，sql mapper文件中sql语句使用#{}这种方式，对应于JDBC中什么形式呢？</p><p><strong>使用#{}之后，mybatis执行sql是使用的jdbc中的PreparedStatement对象</strong></p><p>由mybatis执行下面的代码</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//1. mybatis创建connection，PreparedStatement对象</span>
<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;select id, name, email, age from student where id = ?&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">PreparedStatement</span> pst <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">preparedStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
pst<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1001</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">// 或者相当于这样写，用PreparedStatement对象来执行</span>
			<span class="token comment">//1.获取数据库的连接</span>
			conn <span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			<span class="token comment">//2.获取PreparedStatement的实例 (或：预编译sql语句)</span>
			ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//3.填充占位符</span>
			<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				ps<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
			<span class="token comment">//4.执行sql语句</span>
			ps<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// 或者 ResultSet rs = ps.executeQuery();</span>
			<span class="token class-name">Student</span> student <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                student <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          		student<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                student<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                student<span class="token punctuation">.</span><span class="token function">setEmail</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                student<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
			<span class="token keyword">return</span> student<span class="token punctuation">;</span>
			<span class="token comment">// 这个student,就是对应于下面这一句mybatis的代码</span>
			<span class="token comment">// 这个studentDao，是mybatis根据动态代理自动创建出的dao接口的实现类的实例化对象</span>
			<span class="token comment">// selectStudentById这个方法的执行过程，mybatis帮我们完成了，实际执行的就是上述代码的过程，直到返回student对象！！！</span>
			<span class="token comment">// 相当于上面这些操作全都在mybatis内部来完成</span>
			<span class="token comment">// Student student = studentDao.selectStudentById(1002);</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>要注意，上面的while循环体内，是通过拿到的结果ResultSet的对象，来设置Student的属性值，一个表对应一个类，一个表的一行对应一个类的一个实例对象，那么拿到一行结果，就要实例化Student类，然后给这个实例化对象赋值，但是在实际开发中，有很多表，我们怎么确定查的是哪个表，对应于Java中的哪个类呢？while循环体内就是实例化对象，然后赋值的操作，并且实际开发中有太多的JavaBean类，根本无法确定在while循环体内实例化哪个类的对象，这个时候就是通过反射来创建对象并且赋值，反射可以通过构造函数创建对象，也可以通过newInstance()创建对象，也可以拿到属性值，也可以拿到方法名，甚至是私有的属性值都可以通过设置setAccessible来访问到，也就是说私有的属性并不是完全不能被外界访问到的，只是在形式上告诉你不要来访问，实际上反射可以访问到一个类的内部并且能访问到私有属性。反射是动态的，通过反射，这一份代码我们就只有写一次，查到什么，就给对应的类实例化并且赋值。要查什么，传入类.class这个大Class对象，就可以通过反射来操作了。while循环体内的代码，就高度抽象化，降低耦合度。</strong></p><p>反射是动态的，Java本身是静态语言，和JavaScript、python不一样，Java是静态语言，很多对象在编译期间就创建好了，要是编译期间不能确定创建哪个对象怎么办？通过反射！！！</p></li><li><p>介绍PreparedStatement</p><ul><li><p>预编译，提高性能</p><p>PreparedStatement接口是Statement接口的子接口，它表示一条预编译过的sql语句，预编译语句有可能重复调用，被DBServer编译过后的执行代码被缓存下来，那么下次调用时只要是相同的预编译语句那么就不需要编译，<strong>只要将参数直接传入</strong>已经编译的预编译sql语句就可以执行。</p><p>statement没有预编译，因为没有预编译的意义，在statement语句中,即使是相同操作但因为数据内容不一样,所以整个语句本身不能匹配,没有缓存语句的意义.事实是没有数据库会对普通语句编译后的执行代码缓存。这样<u>每执行一次都要对传入的语句编译一次。</u></p><p>PreparedStatement能够预编译，<strong>有预编译的意义正是因为它是通过占位符的方式来设置参数</strong></p></li><li><p>解决sql注入问题</p><p>PreparedStatement 对象所代表的 SQL 语句中的参数用问号(?)来表示，这是占位符，调用 PreparedStatement 对象的 setXxx() 方法来设置这些参数即占位符. <strong>setXxx() 方法有两个参数，第一个参数是要设置的 SQL 语句中的参数的索引(从 1 开始)，第二个是设置的 SQL 语句中的参数的值</strong></p><p>正是因为是通过占位符的方式设置参数，所以可以解决<strong>sql注入问题</strong>。</p></li></ul></li></ol><h4 id="sql-mapper-映射文件-多个参数传值方式" tabindex="-1"><a class="header-anchor" href="#sql-mapper-映射文件-多个参数传值方式" aria-hidden="true">#</a> sql mapper 映射文件，多个参数传值方式</h4><ol><li><p>多个参数，使用@Param命名参数</p><p>接口<code>public List&lt;Student&gt; selectMultiParam(@Param(&quot;MyName&quot;) String name, @Param(&quot;MyAge&quot;) Integer age)</code></p><p>使用@Param(&quot;参数名&quot;) String name 这种方式</p><p>mapper文件中：</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span><span class="token punctuation">&gt;</span></span>
    select * from student where name = #{MyName} or age = #{MyAge};
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>多个参数，使用对象</p><p>接口中的方法的<strong>形参是一个Java对象</strong>，一般来说，一个Java对象就没问题</p><p>这个对象里面有多个属性，这些<strong>属性值就是参数值！！！</strong></p><p><strong>用对象来传递SQL语句的占位参数</strong></p><div class="language-xm ext-xm line-numbers-mode"><pre class="language-xm"><code>&lt;!--
        多个参数，使用Java对象的属性值，作为实际sql语句参数值
        使用对象语法，#{属性名，javaType=类型名称，jdbcType=数据库中数据类型} 很少用
        javaType 指在Java代码中的属性数据类型
        jdbcType 指在数据库中的数据类型
        例如 #{paramName，javaType=java.lang.String，jdbcType=VARCHAR}

        简化方式:
        #{属性名} javaType，jdbcType的值， mybatis反射可以获取，不用提供
    --&gt;
    &lt;select id=&quot;selectMultiObject&quot; resultType=&quot;org.example.domain.Student&quot;&gt;
        select id, name, email, age from student where name = #{paramName} or age = #{paramAge};
    &lt;/select&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>多个参数，按位置传值</p><p><img src="/study/assets/image-20210912204827485.44851558.png" alt="image-20210912204827485"></p><p><img src="/study/assets/image-20210912204838670.076d9948.png" alt="image-20210912204838670"></p></li><li><p>多个参数，通过Map传值</p><p><img src="/study/assets/image-20210912204940961.2e2e3e9f.png" alt="image-20210912204940961"></p><p><img src="/study/assets/image-20210912204900434.cda15062.png" alt="image-20210912204900434"></p></li><li><p><strong>总结：</strong></p><ul><li><strong>一个简单类型的参数：#{任意字符}</strong></li><li><strong>多个简单类型的参数：使用@Param(&quot;自定义名称&quot;)</strong></li><li><strong>使用一个java对象，对象的属性值作为mapper文件的参数，#{Java对象的属性名称}</strong></li><li><strong>使用参数的位置，语法#{arg0},#{arg1}，mybatis3.4之前的版本使用#{0},#{1}</strong></li><li><strong>使用Map作为参数，#{map的key}</strong></li></ul></li></ol><h4 id="和" tabindex="-1"><a class="header-anchor" href="#和" aria-hidden="true">#</a> ## 和 $</h4><ol><li><p><code>#</code>是占位符</p><p><img src="/study/assets/image-20210912205159195.8e35dc8f.png" alt="image-20210912205159195"></p><p>因为PreparedStatement接口就是采用的占位符的方式，然后setXxx的方式来设置占位符的参数，而不是像Statement接口采用的拼接的方式，所以避免了sql注入的问题</p><p>在前面说过，mybatis执行原理，能够通过动态代理自动生成dao接口的实现类的实例化对象，并调用SqlSession的方法来执行数据库操作，然后返回结果，正式通过PreparedStatement的方式，所以也是采用的占位符，避免了sql注入的问题</p><p><code>#</code>放在等号的后面，<strong>代表的是列值，在Java层面就是属性值。</strong></p><p>能用<code>#</code>号的地方，都可以替换成<code>$</code></p></li><li><p><strong><code>$</code>用于字符串连接和替换</strong></p><p><img src="/study/assets/image-20210912210543125.494a603b.png" alt="image-20210912210543125"></p><p><strong>可以看见使用<code>$</code>是使用的statement对象来进行sql语句的执行</strong>，可能产生sql注入的问题，也没有PreparedStatement接口的预编译功能。DBServer能对sql语句预编译，后面重复调用的时候，就不用再次编译，直接根据占位符传入参数就可以执行了。</p><p>因为这种方式，相当于不是占位符了，而是字符串替换，或者说拼接。</p><p>PreparedStatement能避免sql注入，正是因为采用了占位符的方式。</p><p>statement无法预编译，因为它是采用的字符串拼接的方式来构成sql，相当于高度耦合，每一条插入语句即使只有参数不同，他们也是不同的sql语句，预编译没有意义。</p><p>总结：</p><p>statement对比PreparedStatement：</p><ul><li>无法预编译</li><li>会产生sql注入的问题</li></ul><p><code>#</code>是占位符，而<code>$</code>不是</p><p>使用<code>$</code>，要保证传入的参数符合sql语法，更麻烦</p></li><li><p>使用<code>$</code>一般替换表名或列名，如果能确定数据是安全的，可以用<code>$</code></p></li><li><p><code>#</code>和<code>$</code>的区别</p><ul><li><code>#</code>，是使用<code>?</code>在sql语句中做占位的，使用的是PreparedStatement执行sql，效率高（预编译）</li><li><code>#</code>能够避免sql注入，更安全</li><li><code>$</code>不使用占位符，是字符串连接方式，使用的是Statement执行sql，效率低</li><li><code>$</code>有sql注入的风险，缺乏安全性</li><li><code>$</code>可用于替换列名和表名</li></ul></li></ol><h3 id="mybatis的返回结果" tabindex="-1"><a class="header-anchor" href="#mybatis的返回结果" aria-hidden="true">#</a> Mybatis的返回结果</h3><h4 id="resulttype" tabindex="-1"><a class="header-anchor" href="#resulttype" aria-hidden="true">#</a> resultType</h4><ol><li><p>mybatis执行了sql语句，得到Java对象</p></li><li><p>resultType结果类型，指sql语句执行完毕后，数据转为的Java对象</p><p>只要是查询语句，也就是标签是&lt;select&gt;的，都有resultType属性</p><p>处理方式：</p><ol><li><p>mybatis执行sql语句，然后mybatis调用类的无参构造方法，创建对象</p></li><li><p>mybatis把ResultSet指定列值付给同名的属性</p><p>对应的jdbc的操作</p></li></ol><p><img src="/study/assets/image-20210912214202756.46acff6c.png" alt="image-20210912214202756"></p><p><img src="/study/assets/image-20210912214209011.3bd39a1b.png" alt="image-20210912214209011"></p><p><strong>同名的列名的值赋给Java代码中同名的属性</strong>，那么不同名的列的值，便不会赋值</p></li><li><p><strong>resultType里面的值是一个任意的Java类型，而不一定是一个实体类</strong></p><p>也可以是Integer的全限定名，或者是Integer的别名，比如说查询表中有多少数据，查询行数，需要返回整型值，那么resultType可以这样写。</p><p>java.lang.Integer的别名是int</p></li><li><p>resultType结果类型，它的值可以是两种</p><ul><li>类型的全限定名称</li><li>类型的别名---如果写别名，一定要配置，除非是基本数据类型，mybatis有自动配置别名。</li></ul><p>自定义类也可以用别名，需要配置。</p></li><li><p><strong>定义自定义类型的别名，需要在主配置文件中去定义，使用&lt;typeAlias&gt;定义别名</strong></p><p>定义完后，可以在resultType后，使用自定义类的别名</p><p>定义别名：</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAliases</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--
            第一种方式
            type是自定义类型的全限定名称，alias是别名，短小并容易记忆的
			可以指定一个类型一个自定义别名
        --&gt;</span>
<span class="token comment">&lt;!--        &lt;typeAlias type=&quot;org.example.domain.Student&quot; alias=&quot;stu&quot; /&gt;--&gt;</span>
        <span class="token comment">&lt;!--
            第二种方式
            &lt;package&gt; name属性的值是全限定包名，那么这个包中的所有类，类名就是别名，不区分大小写
        --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.example.domain<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>typeAliases</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>用第二种方式居多，不用自己定义别名，用类名作为别名，而不使用全限定名</p><p>并且第二种方式通过包来定义，一行代码就可以定义多个类的别名，第一种方式一行代码只能定义一个类的别名</p><p>定义了别名，也可以使用全限定名，为了不出错，全部使用全限定名也可以</p><p>而且如果使用别名，可能出现歧义性，因为在不同包下面，可以有同样名称的类名</p></li><li><p>还可以使用Map来接收resultType</p><p>返回Map，数据库的表的<strong>列名是map的key</strong>，<strong>列值是map的value</strong></p><p><strong>使用Map来接收结果只能返回一行记录，返回多行记录会报错</strong>，因为Map里记录的是一个对象的属性名和属性值，属性名作为key，属性值作为value，也就是列名和列值，但是只是一行的。一行数据对应一个Java Bean对象，对应一个map对象，key就是对象的属性，value就是对象的属性值。</p><p><img src="/study/assets/image-20211231170347832.7663e77c.png" alt="image-20211231170347832"></p><p>接口里的方法的返回值也要是Map</p></li></ol><h4 id="resultmap" tabindex="-1"><a class="header-anchor" href="#resultmap" aria-hidden="true">#</a> resultMap</h4><ol><li><p>这个resultMap和上面的resultType里写HashMap不一样</p><p>上面的resultType里写HashMap，是为了用Map来接收返回结果，Map作为返回结果的接收对象！！</p><p>这里的resultMap，起一个映射的关系，将数据库中表的列名映射到Java对象的属性名！！</p><p>而返回结果，仍然是用自定义Java对象接收，这个Map不是作为接收返回结果的对象，是起映射作用，返回结果仍是自定义Java对象。</p><p>结果映射，指定列名和Java对象的属性对应关系</p><ul><li>自定义列值赋值给哪个属性</li><li><strong>当列名和属性名不一样时，一种方式是使用resultMap，另一种方式是使用resultType结合列的别名<code>as</code>来写sql语句</strong></li></ul></li><li><p>使用resultMap</p><ul><li>先定义resultMap</li><li>在select标签，使用resultMap来引用1定义的</li></ul></li><li><p>定义resultMap</p><ul><li>id：自定义名称，表示定义的这个resultMap</li><li>type：Java类型的全限定名称</li></ul><p><img src="/study/assets/image-20210913111244558.3bda3309.png" alt="image-20210913111244558"></p></li><li><p>resultType的原则是同名列名的列值赋给Java对象中同名的属性。</p><p>如果列名和属性名不同，对应不上，那么就要采用resultMap映射或者使用别名！！</p><p>使用Mybatis的时候，实体类的属性名原则上要和数据库中表的列名一样！！！</p></li><li><p>resultType和resultMap不要一起用，二选一。</p><p>resultMap和resultType的值写HashMap是不同的，前者是映射，返回对象仍是Java自定义对象。后者返回对象则是HashMap</p></li></ol><h3 id="mybatis模糊查询的两种方式" tabindex="-1"><a class="header-anchor" href="#mybatis模糊查询的两种方式" aria-hidden="true">#</a> Mybatis模糊查询的两种方式</h3><ol><li><p>把模糊查询的内容写在Java中，通过占位符的方式传入</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- 第一种like，Java代码指定like的内容 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectLikeOne<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.example.domain.Student<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select id, name, email, age from student where name like #{name};
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- 第二种like，在mapper文件中拼接like的内容 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectLikeTwo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.example.domain.Student<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select id, name, email, age from student where name like &quot;%&quot; #{name} &quot;%&quot;;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="第4章-动态sql" tabindex="-1"><a class="header-anchor" href="#第4章-动态sql" aria-hidden="true">#</a> 第4章 动态SQL</h2><h3 id="概述" tabindex="-1"><a class="header-anchor" href="#概述" aria-hidden="true">#</a> 概述</h3><ol><li><p>动态sql：sql的内容是变化的，可以根据条件获取到不同的sql语句</p><p><strong>主要是where部分发生变化</strong></p></li><li><p>动态sql的实现，使用的是mybatis提供的标签</p><ul><li><p><code>&lt;if&gt;</code></p><p>是判断条件的</p><p>语法：</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>判断Java对象的属性值<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    部分sql语句
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>&lt;where&gt;</code></p></li><li><p><code>&lt;foreach&gt;</code></p></li></ul></li></ol><h3 id="介绍三种标签" tabindex="-1"><a class="header-anchor" href="#介绍三种标签" aria-hidden="true">#</a> 介绍三种标签</h3><ol><li><p>sql-if</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- 
	&lt;if:test=&quot;Java对象的属性 运算符 xxx值&quot;&gt;
--&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/study/assets/image-20210913113956465.a4a70347.png" alt="image-20210913113956465"></p></li><li><p>sql-where</p><p><strong>&lt;where&gt; 标签用来包含多个&lt;if &gt;的，当多个if有一个成立的，&lt;where&gt;会自动增加一个where关键字，并去掉if中多余的and、or等。</strong></p><p><img src="/study/assets/image-20210913114945145.caadaab4.png" alt="image-20210913114945145"></p></li><li><p>sql-foreach</p><p>主要用在sql的in语句中，比如学生id是1001，1002，1003的三个学生</p><p>sql语句如下</p><p><code>select * from student where id in (1001,1002,1003)</code></p><p>sql映射文件sql语句如下：</p><p>方式一</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectForeachOne<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.example.domain.Student<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select id, name, email, age from student where id in
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">open</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(<span class="token punctuation">&quot;</span></span> <span class="token attr-name">close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>,<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            #{myid}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>collection: 用来表示接口中方法参数的类型，</p><ul><li>如果是数组，使用array</li><li>如果是list集合，使用list</li></ul></li><li><p>item：自定义的，表示数组和集合成员的变量</p><p><strong>item的属性值是list或数组里的元素，给其起个名字！！</strong></p></li><li><p>open:循环开始时的字符</p></li><li><p>close:循环结束时的字符</p></li><li><p>separator：集合成员之间的分隔符</p></li></ul><p><img src="/study/assets/image-20210913142035391.ed925244.png" alt="image-20210913142035391"></p><p>方式二：</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectForeachTwo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.example.domain.Student<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select id, name, email, age from student where id in
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>student<span class="token punctuation">&quot;</span></span> <span class="token attr-name">open</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(<span class="token punctuation">&quot;</span></span> <span class="token attr-name">close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>,<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            #{student.id}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="代码片段" tabindex="-1"><a class="header-anchor" href="#代码片段" aria-hidden="true">#</a> 代码片段</h3><ol><li><p>&lt;sql/&gt;标签用于定义sql语句片段，以便其他sql标签复用，而其他标签使用该sql片段，需要使用&lt;include/&gt;子标签，该&lt;sql/&gt;标签可以定义sql语句中的任何部分，所以&lt;include/&gt;子标签可以放在动态sql的任何位置</p><p><img src="/study/assets/image-20210913145213669.4a7237d0.png" alt="image-20210913145213669"></p><p><img src="/study/assets/image-20210913145239671.2539ba2f.png" alt="image-20210913145239671"></p></li></ol><h2 id="第5章-mybatis配置文件" tabindex="-1"><a class="header-anchor" href="#第5章-mybatis配置文件" aria-hidden="true">#</a> 第5章 MyBatis配置文件</h2><h3 id="主配置文件" tabindex="-1"><a class="header-anchor" href="#主配置文件" aria-hidden="true">#</a> 主配置文件</h3><ol><li><p>&lt;settings&gt;</p></li><li><p>&lt;typeAliases&gt;</p><p><strong>定义自定义类型的别名，需要在主配置文件中去定义，使用&lt;typeAlias&gt;定义别名</strong></p><p>定义完后，可以在resultType后，使用自定义类的别名</p><p>定义别名：</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAliases</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--
            第一种方式
            type是自定义类型的全限定名称，alias是别名，短小并容易记忆的
			可以指定一个类型一个自定义别名
        --&gt;</span>
<span class="token comment">&lt;!--        &lt;typeAlias type=&quot;org.example.domain.Student&quot; alias=&quot;stu&quot; /&gt;--&gt;</span>
        <span class="token comment">&lt;!--
            第二种方式
            &lt;package&gt; name属性的值是全限定包名，那么这个包中的所有类，类名就是别名，不区分大小写
        --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.example.domain<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>typeAliases</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>用第二种方式居多，不用自己定义别名，用类名作为别名，而不使用全限定名</p><p>并且第二种方式通过包来定义，一行代码就可以定义多个类的别名，第一种方式一行代码只能定义一个类的别名</p><p>定义了别名，也可以使用全限定名，为了不出错，全部使用全限定名也可以</p><p>而且如果使用别名，可能出现歧义性，因为在不同包下面，可以有同样名称的类名</p></li><li><p>&lt;environments&gt;环境信息</p><ul><li><p>数据库连接信息</p></li><li><p>数据源：dataSource(在实际项目中，必然使用连接池)</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POOLED<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>driver<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.mysql.cj.jdbc.Driver<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbc:mysql://localhost:3306/ssm?serverTimezone=Asia/Shanghai<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>123456<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>dataSource：表示数据源，Java体系中，规定实现了javax.sql.DataSource接口的都是数据源</p><p>数据源表示Connection对象的。</p><p>type:指定数据源的类型</p><ul><li><p>POOLED：使用连接池，mybatis会创建PooledDataSource类的对象</p></li><li><p>UNPOOLED：不使用连接池，在每一次执行SQL语句的时候，先创建Connection，执行SQL，再关闭Connection</p><p>这种情况Mybatis会创建UnpooledDataSource类的对象，管理Connection对象的使用（创建、关闭）</p></li><li><p>JNDI：Java命名和目录服务（windows注册表）</p></li></ul></li><li><p>提交事务、回滚事务的方式：transactionManager</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>JDBC<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><p>JDBC，表示mybatis底层是调用JDBC中的Connection对象的，commit、rollback</p></li><li><p>MANAGED，表示mybatis的事务处理委托给其他的容器（一个服务器软件或者是一个框架（spring））</p></li></ul></li></ul></li><li><p>&lt;mappers&gt;</p><p>sql mapper(sql映射文件)的位置</p><ul><li><p>第一种方式：通过&lt;mapper&gt;标签，指定多个mapper文件位置</p></li><li><p>第二种方式：通过xml文件（mapper文件）所在的包名，这个包中所有xml文件一次都能加载给mybatis</p><p><img src="/study/assets/image-20210913152221165.0f9ad036.png" alt="image-20210913152221165"></p><p>使用package的要求：</p><ol><li>mapper文件名称需要和接口名称一样，区分大小写</li><li>mapper文件和dao接口需要在同一目录</li></ol></li></ul><p>这两种方式，指定多个mapper文件，和typeAliases一样的，都是可以写多个，每一对标签指定单独的，也可以通过写包名，来批量指定。</p></li></ol><h3 id="数据库属性配置文件" tabindex="-1"><a class="header-anchor" href="#数据库属性配置文件" aria-hidden="true">#</a> 数据库属性配置文件</h3><ol><li><p>数据库的属性配置文件：</p><p>把数据库连接信息放到一个单独的文件中，和mybatis主配置文件分开</p><p>目的是便于修改和保存，处理多个数据库的信息</p></li><li><p>使用步骤：</p><ol><li><p>在resources目录中，定义一个属性配置文件，xxx.properties，例如jdbc.properties</p><p>在属性配置文件中，定义数据，格式是key=value</p><p>key一般使用<code>.</code>做多级目录。</p><p>例如 jdbc.mysql.driver</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">jdbc.driver</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysq.jdbc.Driver</span>
<span class="token key attr-name">jdbc.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql//....</span>
<span class="token key attr-name">jdbc.username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token key attr-name">jdbc.password</span><span class="token punctuation">=</span><span class="token value attr-value">123456</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>在mybatis的主配置文件，使用&lt;property&gt;标签指定文件的位置，在需要使用值的地方，${key}</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbc.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>    
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environments</span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mydev<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mydev<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>JDBC<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POOLED<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>driver<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.driver}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.url}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.username}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${jdbc.password}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol></li></ol><h2 id="补充" tabindex="-1"><a class="header-anchor" href="#补充" aria-hidden="true">#</a> 补充</h2><h3 id="使用pagehelper在mybatis来自动帮助分页" tabindex="-1"><a class="header-anchor" href="#使用pagehelper在mybatis来自动帮助分页" aria-hidden="true">#</a> 使用PageHelper在mybatis来自动帮助分页</h3><ol><li><p>添加maven依赖</p><p><img src="/study/assets/image-20210913153350204.b3fe36ff.png" alt="image-20210913153350204"></p></li><li><p>在主配置文件中文件中加入plugin配置</p><p><img src="/study/assets/image-20210913153406267.faccce93.png" alt="image-20210913153406267"></p></li><li><p>调用PageHelper对象的startPage方法，这是静态方法。</p><p><img src="/study/assets/image-20210913153140997.98e5100b.png" alt="image-20210913153140997"></p></li></ol><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 64005626+shaileneF@users.noreply.github.com">shailene</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/study/assets/app.4069d6c3.js" defer></script>
  </body>
</html>
