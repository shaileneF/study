import{_ as i,e as l}from"./app.8bf1b206.js";var p="/study/assets/image-20210904170008584.9ae2a8f6.png",e="/study/assets/image-20210904170145964.0bd58d87.png",a="/study/assets/image-20210904171814442.cab9591e.png",r="/study/assets/image-20210906143610290.528cb25f.png",t="/study/assets/image-20210906171812809.363b01dc.png",n="/study/assets/image-20210906144113619.a2f3c5c0.png",o="/study/assets/image-20210906145616412.1f9a56da.png",s="/study/assets/image-20210906162329611.4aeaf574.png",d="/study/assets/image-20210906162952714.4ab2d7a4.png",h="/study/assets/image-20210906163537132.2ae5e1a6.png",g="/study/assets/image-20210906164102507.06a0f57c.png",c="/study/assets/image-20210906164652141.f4114c6d.png",u="/study/assets/image-20210906165418735.d4e940a9.png",m="/study/assets/image-20210906165650753.b4ead867.png",y="/study/assets/image-20210906171021229.847adf9b.png",b="/study/assets/image-20210906172322150.a19aa7e0.png",k="/study/assets/image-20210906200431146.322d30b9.png",C="/study/assets/image-20210906204102015.ee560150.png",_="/study/assets/image-20210906211624798.1e983e7e.png",f="/study/assets/image-20210906221104293.53356d9b.png",A="/study/assets/image-20210907152327885.fd5de064.png",v="/study/assets/image-20210907153022187.a7654d9b.png",M="/study/assets/image-20210907153037877.e43be6ba.png",S="/study/assets/image-20210907153118988.b218cc5c.png",T="/study/assets/image-20210907164801520.1d739494.png",N="/study/assets/image-20210908142615745.58119378.png",j="/study/assets/image-20210908143216090.b17deb87.png",L="/study/assets/image-20210908144636043.58ea9b75.png",E="/study/assets/image-20210908152216836.530d1011.png",x="/study/assets/image-20210908183204652.5c29db96.png",R="/study/assets/image-20210908205551426.6b105bd3.png",I="/study/assets/image-20210908205814692.348bf473.png",U="/study/assets/image-20210908210307737.74fd6924.png",H="/study/assets/image-20210908211936243.e49a9e21.png",P="/study/assets/image-20210908212728493.f94e54d5.png",O="/study/assets/image-20210908212946761.13e79584.png",w="/study/assets/image-20210908213524594.2796de8e.png",z="/study/assets/image-20210908214251452.dbec5cfa.png",W="/study/assets/image-20210909140256403.96bb1dac.png",D="/study/assets/image-20210909141045584.1c039d2d.png",J="/study/assets/image-20210909141325138.dc54b65c.png",B="/study/assets/image-20210909142412154.4f507845.png",K="/study/assets/image-20210909142301150.f77386b0.png",Q="/study/assets/image-20210909152652554.4b233dc1.png",q="/study/assets/image-20210909163938947.4746849b.png",F="/study/assets/image-20210909175235649.71692bdb.png",G="/study/assets/image-20210909190349224.68892225.png",V="/study/assets/image-20210909191200097.e7b4c7b6.png",X="/study/assets/image-20210909191210548.6c5b6aef.png",Y="/study/assets/image-20210909194450657.164d751a.png",Z="/study/assets/image-20210909194836695.ef1f5332.png",$="/study/assets/image-20210909201243193.2061ec64.png",ii="/study/assets/image-20210909201251908.bb55024d.png",li="/study/assets/image-20210909203507236.90565c2f.png",pi="/study/assets/image-20210909203742017.5d415a09.png",ei="/study/assets/image-20210909204148130.0deb1dbb.png",ai="/study/assets/image-20210909204356085.9982e796.png",ri="/study/assets/image-20210909220203679.668a59b8.png",ti="/study/assets/image-20210909220242221.33efead5.png",ni="/study/assets/image-20210909220502184.e5bb662a.png",oi="/study/assets/image-20210909220707854.648fa4b9.png",si="/study/assets/image-20210910125940213.7c096c9b.png",di="/study/assets/image-20210910125952369.fc2f30be.png",hi="/study/assets/image-20210910183523679.7f21dde5.png",gi="/study/assets/image-20210910130603196.2012b989.png",ci="/study/assets/image-20210910130839000.39b704f6.png",ui="/study/assets/image-20210910144345408.ab990a24.png",mi="/study/assets/image-20210910145407027.d393b697.png",yi="/study/assets/image-20210910170942805.515bc66e.png",bi="/study/assets/image-20210910171404634.2fceb33c.png";const ki={},Ci=l('<h1 id="\u5E76\u53D1\u7F16\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u5E76\u53D1\u7F16\u7A0B" aria-hidden="true">#</a> \u5E76\u53D1\u7F16\u7A0B</h1><h2 id="\u8FDB\u7A0B\u4E0E\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u8FDB\u7A0B\u4E0E\u7EBF\u7A0B" aria-hidden="true">#</a> \u8FDB\u7A0B\u4E0E\u7EBF\u7A0B</h2><h3 id="\u8FDB\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u8FDB\u7A0B" aria-hidden="true">#</a> \u8FDB\u7A0B</h3><ol><li><p>\u5F53\u4E00\u4E2A\u7A0B\u5E8F\u88AB\u8FD0\u884C\uFF0C\u4ECE\u78C1\u76D8\u52A0\u8F7D\u8FD9\u4E2A\u7A0B\u5E8F\u7684\u4EE3\u7801\u5230\u5185\u5B58\uFF0C\u8FD9\u5C31\u5F00\u542F\u4E86\u4E00\u4E2A\u8FDB\u7A0B</p><p>\u8FDB\u7A0B\u662F\u6D3B\u52A8\u7684\uFF0C\u7A0B\u5E8F\u5DF2\u7ECF\u88ABCPU\u6267\u884C\u4E86\uFF0C\u8FD9\u5C31\u662F\u8FDB\u7A0B</p><p>\u7A0B\u5E8F\u662F\u9759\u6001\u7684\uFF0C\u8FDB\u7A0B\u662F\u52A8\u6001\u7684\u3002</p></li></ol><h3 id="\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B" aria-hidden="true">#</a> \u7EBF\u7A0B</h3><ol><li>\u4E00\u4E2A\u8FDB\u7A0B\u4E4B\u5185\u53EF\u4EE5\u5206\u4E3A\u4E00\u5230\u591A\u4E2A\u7EBF\u7A0B\uFF0C\u53EF\u4EE5\u8BA4\u4E3A\u4E00\u4E2A\u8FDB\u7A0B\u662F\u7531\u591A\u4E2A\u7EBF\u7A0B\u7EC4\u6210\u7684\u3002</li><li>\u4E00\u4E2A\u7EBF\u7A0B\u5C31\u662F\u4E00\u4E2A\u6307\u4EE4\u6D41\uFF0C\u5C06\u6307\u4EE4\u6D41\u4E2D\u7684\u4E00\u6761\u6761\u6307\u4EE4\u4EE5\u4E00\u5B9A\u7684\u987A\u5E8F\u4EA4\u7ED9CPU\u6267\u884C</li><li><strong>Java\u4E2D\uFF0C\u7EBF\u7A0B\u4F5C\u4E3A\u6700\u5C0F\u7684\u8C03\u5EA6\u5355\u4F4D\uFF0C\u8FDB\u7A0B\u4F5C\u4E3A\u8D44\u6E90\u5206\u914D\u7684\u6700\u5C0F\u5355\u4F4D</strong></li></ol><h3 id="\u4E8C\u8005\u5BF9\u6BD4" tabindex="-1"><a class="header-anchor" href="#\u4E8C\u8005\u5BF9\u6BD4" aria-hidden="true">#</a> \u4E8C\u8005\u5BF9\u6BD4</h3><ol><li><p>\u8FDB\u7A0B\u57FA\u672C\u4E0A\u76F8\u4E92\u72EC\u7ACB\uFF0C\u800C\u7EBF\u7A0B\u5B58\u5728\u4E8E\u8FDB\u7A0B\u5185\uFF0C\u662F\u8FDB\u7A0B\u7684\u4E00\u4E2A\u5B50\u96C6</p></li><li><p>\u8FDB\u7A0B\u62E5\u6709\u5171\u4EAB\u7684\u8D44\u6E90\uFF0C\u4F9B\u5185\u90E8\u7684\u7EBF\u7A0B\u5171\u4EAB</p></li><li><p>\u4E0D\u540C\u8BA1\u7B97\u673A\u4E4B\u95F4\u7684\u8FDB\u7A0B\u901A\u4FE1\uFF0C\u6BD4\u5982\u5BA2\u6237\u7AEF\u548C\u670D\u52A1\u5668\u4E4B\u95F4\u7684\u901A\u4FE1\uFF0C\u9700\u8981\u9075\u5FAA\u5171\u540C\u7684\u534F\u8BAE\uFF0C\u5982HTTP</p><p>\u6D4F\u89C8\u5668\u662F\u4E00\u4E2A\u8FDB\u7A0B\uFF0C\u670D\u52A1\u5668\u662Ftomcat\uFF0C\u4ED6\u4EEC\u4E4B\u95F4\u7684\u901A\u4FE1\u9700\u8981\u9075\u5FAAhttp</p></li><li><p>\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u5C31\u662F\u4E00\u4E2A\u4EFB\u52A1\u6682\u505C\u4E0E\u7EE7\u7EED\u7684\u8FD9\u4E2A\u8FC7\u7A0B\uFF08\u4E00\u4E2A\u4EFB\u52A1\u4ECE\u4FDD\u5B58\u5230\u518D\u52A0\u8F7D\u7684\u8FC7\u7A0B\uFF09</p></li></ol><h2 id="\u5E76\u884C\u4E0E\u5E76\u53D1" tabindex="-1"><a class="header-anchor" href="#\u5E76\u884C\u4E0E\u5E76\u53D1" aria-hidden="true">#</a> \u5E76\u884C\u4E0E\u5E76\u53D1</h2><ol><li><p>\u5355\u6838CPU\u4E0B\uFF0C\u7EBF\u7A0B\u5B9E\u9645\u8FD8\u662F\u4E32\u884C\u6267\u884C\u7684\uFF0C\u53EA\u662F\u7531\u4E8ECPU\u5728\u7EBF\u7A0B\u95F4\u7684\u5207\u6362\u975E\u5E38\u5FEB\uFF0C\u6240\u4EE5\u611F\u89C9\u662F\u5E76\u884C\u7684\uFF0C\u603B\u7ED3\u5C31\u662F\u5FAE\u89C2\u4E32\u884C\uFF0C\u5B8F\u89C2\u5E76\u884C</p><p>\u4E00\u822C\u5C06\u8FD9\u79CD\u7EBF\u7A0B\u8F6E\u6D41\u6267\u884C\u7684\uFF0C\u7EBF\u7A0B\u8F6E\u6D41\u4F7F\u7528CPU\u7684\u505A\u6CD5\u79F0\u4E3A<strong>\u5E76\u53D1</strong></p><p><img src="'+p+'" alt="image-20210904170008584"></p></li><li><p>CPU\u591A\u6838\u624D\u53EF\u4EE5\u5E76\u884C</p><p><img src="'+e+'" alt="image-20210904170145964"></p><p>\u6BCF\u4E2A\u6838\u5FC3\u90FD\u53EF\u4EE5\u5904\u7406\u4E00\u4E2A\u7EBF\u7A0B\u7684\u6307\u4EE4\uFF0C\u53EA\u8981\u6709\u591A\u4E2A\u6838\u5FC3\uFF0C\u90A3\u4E48\u5C31\u53EF\u4EE5\u540C\u65F6\u6267\u884C\u3002</p></li><li><p>\u66F4\u591A\u7684\u65F6\u5019\u662F\u65E2\u6709\u5E76\u53D1\u4E5F\u6709\u5E76\u884C</p><p>\u7EBF\u7A0B\u6570\u6BD4\u6838\u5FC3\u6570\u591A\u7684\u65F6\u5019\uFF0C\u5C31\u662F\u5E76\u53D1\u548C\u5E76\u884C\u90FD\u5B58\u5728</p></li><li><p>\u5E76\u4E0D\u662F\u591A\u7EBF\u7A0B\u6267\u884C\u7684\u6548\u7387\u4E00\u5B9A\u6BD4\u5355\u7EBF\u7A0B\u9AD8</p><p>\u56E0\u4E3A\u6709\u4E0A\u4E0B\u6587\u5207\u6362\u3001\u6B7B\u9501\u3001\u8D44\u6E90\u9650\u5236</p></li><li><p>\u5E76\u53D1\u5C31\u662F\u540C\u4E00\u65F6\u95F4\u5E94\u5BF9\u591A\u4EF6\u4E8B\u60C5\u7684\u80FD\u529B</p><p>\u5E76\u884C\u5C31\u662F\u540C\u4E00\u65F6\u95F4\u52A8\u624B\u505A\u591A\u4EF6\u4E8B\u60C5\u7684\u80FD\u529B</p></li><li><p>\u65E2\u6709\u5E76\u53D1\u53C8\u6709\u5E76\u884C\u662F\u6700\u5E38\u89C1\u7684\u573A\u666F</p></li><li><p>\u540C\u6B65\uFF1A</p><p>\u4ECE\u65B9\u6CD5\u8C03\u7528\u7684\u89D2\u5EA6</p><ul><li>\u5982\u679C\u9700\u8981\u7B49\u5F85\u7ED3\u679C\u8FD4\u56DE\uFF0C\u624D\u80FD\u7EE7\u7EED\u8FD0\u884C\uFF0C\u5C31\u662F\u540C\u6B65</li><li>\u4E0D\u9700\u8981\u7B49\u5F85\u7ED3\u679C\u8FD4\u56DE\uFF0C\u5C31\u80FD\u7EE7\u7EED\u8FD0\u884C\uFF0C\u8FD9\u662F\u5F02\u6B65</li></ul></li><li><p><strong>\u591A\u7EBF\u7A0B\u53EF\u4EE5\u8BA9\u65B9\u6CD5\u6267\u884C\u53D8\u4E3A\u5F02\u6B65\u7684</strong>\uFF0C\u4E0D\u9700\u8981\u5E72\u7B49\u7740\u4E0A\u4E00\u4E2A\u65B9\u6CD5\u7684\u7ED3\u679C\u8FD4\u56DE</p><p>\u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u6267\u884C\uFF0C\u6240\u4EE5\u624D\u6709\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\uFF0C\u7EBF\u7A0B\u4E4B\u95F4\u76F8\u4E92\u62A2\u5360\u8D44\u6E90</p></li><li><p>\u6BD4\u5982\u5728\u9879\u76EE\u4E2D\uFF0C\u89C6\u9891\u6587\u4EF6\u683C\u5F0F\u8F6C\u6362\u6BD4\u8F83\u8D39\u65F6\uFF0C\u8FD9\u65F6\u65B0\u5F00\u4E00\u4E2A\u7EBF\u7A0B\u5904\u7406\u89C6\u9891\u8F6C\u6362\uFF0C\u907F\u514D\u963B\u585E\u4E3B\u7EBF\u7A0B\u3002</p></li><li><p>\u591A\u7EBF\u7A0B\u53EF\u4EE5\u5145\u5206\u5229\u7528\u591A\u6838\uFF0C\u505A\u5230\u5E76\u884C\u6267\u884C\uFF01</p><p>\u5355\u6838CPU\u540C\u6837\u53EF\u4EE5\u6267\u884C\u591A\u7EBF\u7A0B\uFF0C\u8FD9\u5C31\u662F\u5E76\u53D1\uFF0C\u591A\u4E2A\u7EBF\u7A0B\u540C\u65F6\u62A2\u5360\u540C\u4E00\u4EFDCPU\u8D44\u6E90\u3002</p><p><img src="'+a+'" alt="image-20210904171814442"></p></li><li><p>\u5355\u6838\u662F\u5E76\u53D1\uFF0C\u5728\u5FAE\u89C2\u4E0A\u662F\u4E32\u884C\u6267\u884C\u7684\u3002</p><p>\u5355\u6838CPU\u4E5F\u53EF\u4EE5\u591A\u7EBF\u7A0B\uFF0C\u4F46\u662F\u5FAE\u89C2\u4E0A\u4E32\u884C\uFF0C\u5B8F\u89C2\u4E0A\u5E76\u884C\uFF0C\u5E76\u4E0D\u80FD\u63D0\u9AD8\u6548\u7387\uFF0C\u591A\u6838CPU\u624D\u80FD\u63D0\u9AD8\u6548\u7387\uFF0C\u5355\u6838\u65F6\u4ECD\u7136\u662F\u8F6E\u6D41\u6267\u884C</p><p>\u800C\u4E14\u8FD8\u53EF\u80FD\u6709\u6B7B\u9501\u3001\u8D44\u6E90\u9650\u5236\u3001\u4E0A\u4E0B\u6587\u5207\u6362\u7684\u5F71\u54CD\uFF0C\u5BFC\u81F4\u591A\u7EBF\u7A0B\u7684\u6267\u884C\u6548\u7387\u5E76\u4E0D\u4E00\u5B9A\u5C31\u6BD4\u5355\u7EBF\u7A0B\u9AD8\u3002</p><p><strong>\u5355\u6838CPU\u5373\u4F7F\u7528\u4E86\u591A\u7EBF\u7A0B\u4E5F\u6CA1\u6709\u529E\u6CD5\u63D0\u9AD8\u6548\u7387\uFF0C\u56E0\u4E3A\u5728\u5FAE\u89C2\u4E0A\u662F\u4E32\u884C\u7684\u3002</strong></p><p>\u5355\u6838CPU\u7528\u591A\u7EBF\u7A0B\u53CD\u800C\u6BD4\u5355\u7EBF\u7A0B\u6162\uFF0C\u800C\u4E0D\u662F\u6267\u884C\u65F6\u95F4\u76F8\u7B49\uFF0C\u56E0\u4E3A\u591A\u7EBF\u7A0B\u6D89\u53CA\u5230\u4E0A\u4E0B\u6587\u5207\u6362\u3002</p><p><strong>\u603B\u7ED3\uFF1A\u591A\u6838CPU\u7528\u591A\u7EBF\u7A0B\u53EF\u4EE5\u505A\u5230\u5E76\u884C\uFF0C\u53EF\u4EE5\u63D0\u9AD8\u6267\u884C\u6548\u7387\uFF0C\u800C\u5355\u6838CPU\u6267\u884C\u591A\u7EBF\u7A0B\uFF0C\u5728\u5FAE\u89C2\u4E0A\u4E32\u884C\uFF0C\u5E76\u4E14\u6709\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u53CD\u800C\u4E0D\u80FD\u63D0\u9AD8\u6267\u884C\u6548\u7387</strong></p></li><li><p>\u5E76\u4E0D\u662F\u8BF4\u5355\u6838CPU\u4E0B\uFF0C\u591A\u7EBF\u7A0B\u6CA1\u6709\u610F\u4E49</p><p>\u591A\u6838CPU\u53EF\u4EE5\u5E76\u884C\u8DD1\u591A\u4E2A\u7EBF\u7A0B\uFF0C\u4F46\u80FD\u5426\u63D0\u9AD8\u6548\u7387\u8FD8\u662F\u8981\u5206\u60C5\u51B5</p></li></ol><h2 id="java\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#java\u7EBF\u7A0B" aria-hidden="true">#</a> Java\u7EBF\u7A0B</h2><h3 id="\u521B\u5EFA\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFA\u7EBF\u7A0B" aria-hidden="true">#</a> \u521B\u5EFA\u7EBF\u7A0B</h3><ol><li><p>\u4F7F\u7528Runnable\u63A5\u53E3\uFF0C\u5BF9\u6BD4\u76F4\u63A5\u7EE7\u627FThread\u7684\u65B9\u5F0F\uFF0C\u6539\u53D8\u7684\u5730\u65B9\u662F\uFF1A\u628A\u4EFB\u52A1\u548C\u7EBF\u7A0B\u5206\u79BB\u4E86\uFF0C\u800C\u7EE7\u627FThread\u7684\u65B9\u5F0F\uFF0C\u58F0\u660EThread\u5BF9\u8C61\u662F\u548C\u4EFB\u52A1\u5728\u4E00\u8D77\u7684\u3002</p></li><li><p>\u5982\u679C\u4E00\u4E2A\u63A5\u53E3\uFF0C\u53EA\u6709\u4E00\u4E2A\u62BD\u8C61\u65B9\u6CD5\uFF0C\u90A3\u4E48\u53EF\u4EE5\u7528lambda\u8868\u8FBE\u5F0F\u6765\u7B80\u5316\uFF0C\u63A5\u53E3\u7528<code>FunctionalInterface</code>\u6765\u4FEE\u9970\uFF0C\u5982\u679C\u4E00\u4E2A\u63A5\u53E3\u6709\u591A\u4E2A\u62BD\u8C61\u65B9\u6CD5\u662F\u6CA1\u6CD5\u7528lambda\u8868\u8FBE\u5F0F\u6765\u7B80\u5316\u7684\u3002</p></li><li><p>\u539F\u7406\u4E4BThread\u548CRunnable\u7684\u5173\u7CFB</p><ul><li><p>Thread\u662F\u628A\u7EBF\u7A0B\u548C\u4EFB\u52A1\u5408\u5E76\u5728\u4E86\u4E00\u8D77</p><p>Runnable\u662F\u628A\u7EBF\u7A0B\u548C\u4EFB\u52A1\u5206\u5F00\u4E86</p></li><li><p>\u7528Runnable\u66F4\u5BB9\u6613\u4E0E\u7EBF\u7A0B\u6C60\u7B49\u9AD8\u7EA7API\u914D\u5408</p></li><li><p>\u7528Runnable\u8BA9\u4EFB\u52A1\u8131\u79BB\u4E86Thread\u7EE7\u627F\u4F53\u7CFB\uFF0C\u6CA1\u6709\u5355\u7EE7\u627F\u7684\u5C40\u9650\u6027\uFF0C\u66F4\u7075\u6D3B</p></li></ul></li><li><p>\u7528FutureTask\u914D\u5408Callable\u63A5\u53E3\u548CThread\u7684\u65B9\u5F0F\u521B\u5EFA\u7EBF\u7A0B</p><p>FutureTask\u80FD\u591F\u63A5\u6536Callable\u7C7B\u578B\u7684\u53C2\u6570\uFF0C\u7528\u6765\u5904\u7406\u6709\u8FD4\u56DE\u7ED3\u679C\u7684\u60C5\u51B5</p></li><li><p>Callable\u63A5\u53E3\u548CRunnable\u63A5\u53E3\u7684\u5DEE\u522B\uFF1A</p><p>Callable\u91CC\u7684call()\u65B9\u6CD5\u53EF\u4EE5<strong>\u629B\u51FA\u5F02\u5E38</strong>\uFF0C\u800C\u4E14\u6BD4Runnable\u63A5\u53E3\u91CC\u7684run()\u65B9\u6CD5<strong>\u591A\u4E86\u4E00\u4E2A\u8FD4\u56DE\u503C</strong></p></li><li><p><strong>\u5E95\u5C42\u662F\u591A\u6838\u6765\u5BF9\u591A\u7EBF\u7A0B\u8FDB\u884C\u5E76\u884C\u7684\u5904\u7406\u8FD8\u662F\u7531\u4E00\u4E2A\u5355\u6838CPU\u6765\u5BF9\u591A\u7EBF\u7A0B\u8FDB\u884C\u5E76\u53D1\u7684\u6267\u884C\uFF0C\u91C7\u7528\u65F6\u95F4\u7247\u8F6E\u8F6C\u7684\u65B9\u5F0F\uFF0C\u8FD9\u662F\u6211\u4EEC\u63A7\u5236\u4E0D\u4E86\u7684\uFF0C\u662F\u7531\u5E95\u5C42\u7684\u4EFB\u52A1\u8C03\u5EA6\u5668\u6765\u51B3\u5B9A\u7684\u3002</strong></p></li></ol><h3 id="\u7EBF\u7A0B\u8FD0\u884C\u7684\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u8FD0\u884C\u7684\u539F\u7406" aria-hidden="true">#</a> \u7EBF\u7A0B\u8FD0\u884C\u7684\u539F\u7406</h3><ol><li><p>JVM\u7684\u865A\u62DF\u673A\u6808\u3001\u672C\u5730\u65B9\u6CD5\u6808\u548C\u7A0B\u5E8F\u8BA1\u6570\u5668\u662F\u7EBF\u7A0B\u72EC\u6709\u7684</p><p>\u865A\u62DF\u673A\u542F\u52A8\u540E\uFF0C\u865A\u62DF\u673A\u5C31\u4F1A\u4E3A\u7EBF\u7A0B\u5206\u914D\u4E00\u5757\u6808\u5185\u5B58</p></li><li><p>\u6BCF\u4E2A\u6808\u7531\u591A\u4E2A\u6808\u5E27\u7EC4\u6210\uFF0C\u5BF9\u5E94\u7740\u6BCF\u6B21\u65B9\u6CD5\u8C03\u7528\u65F6\u6240\u5360\u7528\u7684\u5185\u5B58</p><p><strong>\u4E00\u4E2A\u6808\u5E27\u5BF9\u5E94\u7740\u4E00\u4E2A\u65B9\u6CD5\u8C03\u7528</strong></p><p>\u6BCF\u4E2A\u7EBF\u7A0B\u53EA\u80FD\u6709\u4E00\u4E2A\u6D3B\u52A8\u6808\u5E27\uFF0C\u5BF9\u5E94\u7740\u5F53\u524D\u6B63\u5728\u6267\u884C\u7684\u90A3\u4E2A\u65B9\u6CD5\u3002</p></li><li><p>\u4E00\u4E2A\u65B9\u6CD5\u8C03\u7528\u5B8C\u6BD5\u540E\uFF0C\u5373\u8FD4\u56DE\u540E\uFF0C\u90A3\u4E2A\u65B9\u6CD5\u8C03\u7528\u5BF9\u5E94\u7684\u6808\u5E27\u5C31\u6CA1\u6709\u4E86\uFF0C\u5BF9\u5E94\u7684\u6808\u5E27\u7684\u5185\u5B58\u5C31\u88AB\u91CA\u653E\u6389\u4E86\uFF0C\u6CA1\u6709\u5783\u573E\u56DE\u6536\uFF0C\u4F46\u662F\u5B58\u5728\u6808\u6EA2\u51FA</p><p>PC\u662F\u4E24\u6837\u90FD\u6CA1\u6709\uFF0C\u800C\u865A\u62DF\u673A\u6808\u548C\u672C\u5730\u65B9\u6CD5\u6808\u662F\u5B58\u5728\u6808\u6EA2\u51FA\uFF0C\u4F46\u662F\u6CA1\u6709\u5783\u573E\u56DE\u6536\uFF0C\u5806\u7A7A\u95F4\u548C\u65B9\u6CD5\u533A\u662F\u5B58\u5728OOM\uFF0C\u4E5F\u6709\u5783\u573E\u56DE\u6536\u673A\u5236</p></li><li><p>\u6808\u5E27\u91CC\u6709\u5C40\u90E8\u53D8\u91CF\u8868\uFF0C\u64CD\u4F5C\u6570\u6808\uFF0C\u65B9\u6CD5\u8FD4\u56DE\u5730\u5740\uFF0C\u52A8\u6001\u94FE\u63A5\uFF0C\u4E00\u4E9B\u9644\u52A0\u4FE1\u606F</p></li><li><p>\u6BCF\u4E2A\u7EBF\u7A0B\u62E5\u6709\u72EC\u7ACB\u7684\u865A\u62DF\u673A\u6808</p></li></ol><h3 id="\u7EBF\u7A0B\u7684\u4E0A\u4E0B\u6587\u5207\u6362" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u7684\u4E0A\u4E0B\u6587\u5207\u6362" aria-hidden="true">#</a> \u7EBF\u7A0B\u7684\u4E0A\u4E0B\u6587\u5207\u6362</h3><ol><li>\u7EBF\u7A0B\u7684\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u662F\u6307\u4E00\u4E2A\u7EBF\u7A0B\u6682\u505C\uFF0C\u7136\u540E\u6062\u590D\u6267\u884C\uFF0C\u8FD9\u662F\u4E00\u6B21\u4E0A\u4E0B\u6587\u5207\u6362</li><li>\u4EE5\u4E0B\u4E00\u4E9B\u539F\u56E0\u89E6\u53D1\u7EBF\u7A0B\u7684\u4E0A\u4E0B\u6587\u5207\u6362\uFF08\u5373\u7EBF\u7A0B\u6682\u505C\u5C31\u4F1A\u51FA\u73B0\u4E0A\u4E0B\u6587\u5207\u6362\uFF09\uFF1A <ul><li>\u7EBF\u7A0B\u7684CPU\u65F6\u95F4\u7247\u7528\u5B8C</li><li>\u5783\u573E\u56DE\u6536\uFF08\u7528\u6237\u7EBF\u7A0B\u6682\u505C\uFF08stw\uFF09\uFF0C\u5783\u573E\u56DE\u6536\u7EBF\u7A0B\u5DE5\u4F5C\uFF09</li><li>\u6709\u66F4\u9AD8\u4F18\u5148\u7EA7\u7684\u7EBF\u7A0B\u9700\u8981\u8FD0\u884C</li><li>\u7EBF\u7A0B\u81EA\u5DF1\u8C03\u7528\u4E86sleep \u3001wait\u3001join\u3001yield\u7B49\u65B9\u6CD5</li></ul></li><li>sleep\u548Cwait\u65B9\u6CD5\u90FD\u53EF\u4EE5\u4F7F\u8C03\u7528\u65B9\u6CD5\u7684\u7EBF\u7A0B\u8FDB\u5165\u963B\u585E\u72B6\u6001\uFF0C\u4F46\u662Fsleep\u4E0D\u4F1A\u91CA\u653E\u540C\u6B65\u76D1\u89C6\u5668\u9501\uFF0C\u800Cwait\u4F1A\u91CA\u653E\u540C\u6B65\u76D1\u89C6\u5668\u9501\uFF0C\u800C\u4E14sleep\u53EF\u4EE5\u5728\u4EFB\u4F55\u5730\u65B9\u8C03\u7528\uFF0C\u4F46\u662Fwait\u65B9\u6CD5\u53EA\u80FD\u5728\u540C\u6B65\u4EE3\u7801\u5757\u5185\u6216\u540C\u6B65\u65B9\u6CD5\u5185\u8C03\u7528</li><li>\u5F53\u4E0A\u4E0B\u6587\u5207\u6362\u53D1\u751F\u65F6\uFF0C\u64CD\u4F5C\u7CFB\u7EDF\u9700\u8981\u4FDD\u5B58\u5F53\u524D\u7EBF\u7A0B\u7684\u72B6\u6001\uFF0C\u5E76\u6062\u590D\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u7684\u72B6\u6001\uFF0CJava\u4E2D\u5BF9\u5E94\u7684\u6982\u5FF5\u5C31\u662F\u7A0B\u5E8F\u8BA1\u6570\u5668\uFF0C\u5DE6\u8FB9\u662F\u6307\u4EE4\u5730\u5740\uFF08\u504F\u79FB\u5730\u5740\uFF09\uFF0C\u53F3\u8FB9\u662F\u5B57\u8282\u7801\u6307\u4EE4\uFF0C\u4F5C\u7528\u5C31\u662F\u8BB0\u4F4F\u4E0B\u4E00\u6761JVM\u9700\u8981\u6267\u884C\u7684\u5B57\u8282\u7801\u6307\u4EE4\u7684\u6307\u4EE4\u5730\u5740\u3002</li><li>\u9891\u7E41\u7684\u4E0A\u4E0B\u6587\u5207\u6362\u4F1A\u5F71\u54CD\u6027\u80FD\uFF0C\u800C\u4E14\u8003\u8651\u5230\u6B7B\u9501\u3001\u8D44\u6E90\u9650\u5236\uFF0C\u5E76\u4E0D\u662F\u7EBF\u7A0B\u6570\u8D8A\u591A\u8D8A\u597D</li></ol><h3 id="start-\u4E0Erun" tabindex="-1"><a class="header-anchor" href="#start-\u4E0Erun" aria-hidden="true">#</a> start()\u4E0Erun()</h3><ol><li><p>start()\u8868\u793A\u542F\u52A8\u7EBF\u7A0B\uFF0Crun()\u8868\u793A\u7EBF\u7A0B\u542F\u52A8\u540E\u8981\u6267\u884C\u7684\u4EE3\u7801</p><p>\u4E0D\u80FD\u76F4\u63A5\u8C03\u7528run()\uFF0C\u56E0\u4E3A\u7EBF\u7A0B\u6CA1\u6709\u542F\u52A8\uFF0C\u8FD8\u662F\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u5373\u4E3B\u7EBF\u7A0B</p><p>\u8C03\u7528start()\u65B9\u6CD5\u540E\uFF0C\u7EBF\u7A0B\u4F1A\u8FDB\u5165\u5C31\u7EEA\u72B6\u6001\uFF0C\u7B49\u5F85CPU\u5206\u914D\u65F6\u95F4\u7247\u5373\u8D44\u6E90\uFF0C\u5C31\u53EF\u4EE5\u8FD0\u884C\u4E86\uFF0C\u5C31\u7EEA\u72B6\u6001\u548C\u8FD0\u884C\u72B6\u6001\u5728Java\u91CC\u90FD\u79F0\u4E3ARUNNABLE\u72B6\u6001</p></li><li><p>\u76F4\u63A5\u8C03\u7528run\u662F\u5728\u4E3B\u7EBF\u7A0B\u4E2D\u6267\u884C\u4E86run\uFF0C\u6CA1\u6709\u542F\u52A8\u65B0\u7684\u7EBF\u7A0B</p></li><li><p>\u4F7F\u7528start\u662F\u542F\u52A8\u65B0\u7684\u7EBF\u7A0B\uFF0C\u901A\u8FC7\u65B0\u7684\u7EBF\u7A0B\u95F4\u63A5\u6267\u884Crun\u4E2D\u7684\u4EE3\u7801</p></li></ol><h3 id="sleep-\u4E0Eyield" tabindex="-1"><a class="header-anchor" href="#sleep-\u4E0Eyield" aria-hidden="true">#</a> sleep()\u4E0Eyield()</h3><ol><li><p>\u8C03\u7528sleep\u4F1A\u8BA9\u5F53\u524D\u7EBF\u7A0B\u4ECERunnable\u8FDB\u5165\u5230Timed Waiting\u72B6\u6001\uFF08\u963B\u585E\uFF0C\u6216\u8005\u8BF4\u4E00\u4E2A\u6709\u65F6\u9650\u7684\u7B49\u5F85\u8FC7\u7A0B\uFF09</p></li><li><p>\u5176\u4ED6\u7EBF\u7A0B\u53EF\u4EE5\u4F7F\u7528interrupt\u65B9\u6CD5\u6253\u65AD\u6B63\u5728\u7761\u7720\u7684\u7EBF\u7A0B\uFF0C\u8FD9\u662F\u7761\u7720\u7684\u7EBF\u7A0B\u4F1A\u629B\u51FAInterruptedException</p></li><li><p>sleep()\u65B9\u6CD5\u5199\u5728\u54EA\u4E2A\u7EBF\u7A0B\u4E2D\uFF0C\u5C31\u8BA9\u54EA\u4E2A\u7EBF\u7A0B\u7761\u7720\uFF0C\u5BF9\u5F53\u524D\u7EBF\u7A0B\u8FDB\u884C\u7761\u7720\u64CD\u4F5C</p></li><li><p><strong>\u7761\u7720\u7ED3\u675F\u540E\u7684\u7EBF\u7A0B\u672A\u5FC5\u4F1A\u7ACB\u523B\u5F97\u5230\u6267\u884C\uFF0C\u4E5F\u8981\u91CD\u65B0\u7B49\u5F85\u76F4\u5230\u5F97\u5230cpu\u65F6\u95F4\u7247\u5206\u914D</strong></p></li><li><p><strong>\u8C03\u7528yield\u4F1A\u8BA9\u5F53\u524D\u7EBF\u7A0B\u4ECERunning\u8FDB\u5165Runnable\u5C31\u7EEA\u72B6\u6001\uFF0C\u7136\u540E\u8C03\u5EA6\u6267\u884C\u5176\u4ED6\u7EBF\u7A0B</strong></p><p>\u5177\u4F53\u7684\u5B9E\u73B0\u4F9D\u8D56\u4E8E\u64CD\u4F5C\u7CFB\u7EDF\u7684\u4EFB\u52A1\u8C03\u5EA6\u5668</p></li></ol><h3 id="\u7EBF\u7A0B\u4F18\u5148\u7EA7" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u4F18\u5148\u7EA7" aria-hidden="true">#</a> \u7EBF\u7A0B\u4F18\u5148\u7EA7</h3><ol><li><p>\u7EBF\u7A0B\u4F18\u5148\u7EA7\u4F1A\u63D0\u793A\u4EFB\u52A1\u8C03\u5EA6\u5668\u4F18\u5148\u8C03\u5EA6\u8BE5\u7EBF\u7A0B\uFF0C\u4F46\u662F\u5B83\u4EC5\u4EC5\u662F\u4E00\u4E2A\u63D0\u793A\uFF0C\u4F46\u662F\u8C03\u5EA6\u5668\u53EF\u4EE5\u5FFD\u7565\u5B83\u3002</p><p>\u5982\u679CCPU\u6BD4\u8F83\u5FD9\uFF0C\u90A3\u4E48\u4F18\u5148\u7EA7\u8F83\u9AD8\u7684\u7EBF\u7A0B\u4F1A\u83B7\u5F97\u66F4\u591A\u7684\u65F6\u95F4\u7247\uFF0C\u4F46CPU\u95F2\u65F6\uFF0C\u4F18\u5148\u7EA7\u51E0\u4E4E\u6CA1\u6709\u4F5C\u7528</p></li><li><p>sleep\u548Cwait\u7684\u5DEE\u522B</p><ul><li>sleep()\u65B9\u6CD5\u9002\u7528\u4E8E\u65E0\u9700\u540C\u6B65\u9501\u7684\u573A\u666F\uFF0C\u53EF\u4EE5\u5E94\u7528\u5728\u4EFB\u4F55\u5730\u65B9\uFF0C\u800Cwait()\u5219\u9700\u8981\u5728\u540C\u6B65\u65B9\u6CD5\u6216\u540C\u6B65\u4EE3\u7801\u5757\u4E2D\u4F7F\u7528</li><li>sleep()\u548Cwait()\u90FD\u662F\u4F7F\u7EBF\u7A0B\u8FDB\u5165<strong>\u963B\u585E\u72B6\u6001</strong>\uFF0Csleep\u4F7F\u7EBF\u7A0B\u8FDB\u5165timed waiting\u72B6\u6001\uFF0C\u5373\u4E00\u4E2A\u6709\u65F6\u9650\u7684\u7B49\u5F85\u8FC7\u7A0B\uFF0C\u800C\u8C03\u7528wait()\u7684\u7EBF\u7A0B\u5219\u9700\u8981\u5524\u9192</li><li>\u5982\u679C\u4E24\u4E2A\u65B9\u6CD5\u90FD\u4F7F\u7528\u5728\u540C\u6B65\u4EE3\u7801\u5757\u6216\u540C\u6B65\u65B9\u6CD5\u4E2D\uFF0Csleep()\u4E0D\u4F1A\u91CA\u653E\u540C\u6B65\u76D1\u89C6\u5668\uFF0C\u800Cwait()\u4F1A\u91CA\u653E\u540C\u6B65\u76D1\u89C6\u5668</li><li>Thread\u7C7B\u4E2D\u58F0\u660Esleep()\u65B9\u6CD5\uFF0C Object\u7C7B\u4E2D\u58F0\u660Ewait()</li></ul></li><li><p>\u5B9E\u73B0Runnable\u63A5\u53E3\uFF0C\u9996\u5148\u907F\u514D\u4E86\u7EE7\u627FThread\u7C7B\u7684\u5355\u7EE7\u627F\u7684\u5C40\u9650\u6027\u3002</p><p>\u5E76\u4E14\u5C06\u7EBF\u7A0B\u548C\u4EFB\u52A1\u5206\u5F00\u6765</p></li><li><p>\u5B9E\u73B0Runnable\u63A5\u53E3\u548C\u5B9E\u73B0Callable\u63A5\u53E3\u7684\u533A\u522B</p><ul><li><p>\u4E00\u4E2A\u91CD\u5199run()\uFF0C\u4E00\u4E2A\u91CD\u5199call()</p></li><li><p>call()\u65B9\u6CD5\u6709\u8FD4\u56DE\u503C\uFF0C\u5E76\u4E14\u8FD4\u56DE\u503C\u53EF\u4EE5\u5E26\u6CDB\u578B\uFF0C\u800Crun()\u65B9\u6CD5\u4E0D\u80FD\u6709\u8FD4\u56DE\u503C</p></li><li><p>run()\u65B9\u6CD5\u5185\u90E8\u6709\u5F02\u5E38\u7684\u8BDD\u4E0D\u80FD\u629B\u51FA\uFF0C\u53EA\u80FD\u901A\u8FC7try-catch\u8FDB\u884C\u5904\u7406\uFF0C\u4F46\u662Fcall()\u65B9\u6CD5\u5185\u90E8\u6709\u5F02\u5E38\uFF0C\u53EF\u4EE5\u5C06\u5F02\u5E38\u629B\u51FA</p></li><li><p>\u5B9E\u73B0Callable\u63A5\u53E3\u8981\u914D\u5408FutureTask\u4F7F\u7528\uFF0C\u6BD4\u5982\u83B7\u53D6\u8FD4\u56DE\u503C</p><p>// FutureTask\u7684\u5B9E\u4F8B\u5316\u5BF9\u8C61\u7684get()\u65B9\u6CD5\u7684\u8FD4\u56DE\u503C\u5373\u4E3AFutureTask\u6784\u9020\u5668Callable\u5BF9\u8C61\u7684\u5B9E\u73B0\u7C7B\u6240\u91CD\u5199\u7684call()\u65B9\u6CD5\u7684\u8FD4\u56DE\u503C</p></li></ul></li><li><p><strong>join()\u662F\u7B49\u5F85\u8C03\u7528join\u65B9\u6CD5\u7684\u7EBF\u7A0B\u8FD0\u884C\u7ED3\u675F</strong></p></li><li><p>sleep() \u3001join()\u3001wait()\uFF0Csuspend()\u3001\u7B49\u5F85\u540C\u6B65\u9501\u8FD9\u4E94\u79CD\u60C5\u51B5\u53EF\u4EE5\u8BA9\u7EBF\u7A0B\u4ECE\u8FD0\u884C\u72B6\u6001\u5230\u963B\u585E\u72B6\u6001\u3002</p></li></ol><h3 id="interrupt\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#interrupt\u65B9\u6CD5" aria-hidden="true">#</a> interrupt\u65B9\u6CD5</h3><ol><li><p>\u7EBF\u7A0B\u5728sleep\u65F6\uFF0C\u88ABinterrupt\u6253\u65AD\uFF0C\u4F1A\u7F6E\u6253\u65AD\u6807\u8BB0\u4E3Afalse</p><p>\u5373\u6253\u65ADsleep\u7684\u7EBF\u7A0B\uFF0C\u4F1A\u6E05\u7A7A\u6253\u65AD\u72B6\u6001</p><p>\u6253\u65AD\u6B63\u5E38\u8FD0\u884C\u7684\u7EBF\u7A0B\uFF0C\u4E0D\u4F1A\u6E05\u7A7A\u6253\u65AD\u72B6\u6001</p><p>\u6253\u65ADpark\u7EBF\u7A0B\uFF0C\u4E0D\u4F1A\u6E05\u7A7A\u6253\u65AD\u72B6\u6001</p><p>\u4E0D\u4F1A\u6E05\u7A7A\u6253\u65AD\u72B6\u6001\uFF0C\u5373\u6253\u65AD\u6807\u8BB0\u4E3A\u771F</p></li></ol><h3 id="\u4E3B\u7EBF\u7A0B\u548C\u5B88\u62A4\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u4E3B\u7EBF\u7A0B\u548C\u5B88\u62A4\u7EBF\u7A0B" aria-hidden="true">#</a> \u4E3B\u7EBF\u7A0B\u548C\u5B88\u62A4\u7EBF\u7A0B</h3><ol><li>\u6709\u4E00\u79CD\u7279\u6B8A\u7684\u7EBF\u7A0B\u53EB\u505A\u5B88\u62A4\u7EBF\u7A0B\uFF0C\u53EA\u8981\u5176\u4ED6\u975E\u5B88\u62A4\u7EBF\u7A0B\u8FD0\u884C\u7ED3\u675F\u4E86\uFF0C\u5373\u65F6\u5B88\u62A4\u7EBF\u7A0B\u7684\u4EE3\u7801\u6CA1\u6709\u6267\u884C\u5B8C\uFF0C\u4E5F\u4F1A\u5F3A\u5236\u7ED3\u675F\u3002</li><li>\u5783\u573E\u56DE\u6536\u5668\u7EBF\u7A0B\u5C31\u662F\u4E00\u79CD\u5B88\u62A4\u7EBF\u7A0B\u3002</li></ol><h3 id="\u516D\u79CD\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u516D\u79CD\u72B6\u6001" aria-hidden="true">#</a> \u516D\u79CD\u72B6\u6001</h3><ol><li><p>NEW \uFF0C\u7EBF\u7A0B\u521A\u88AB\u521B\u5EFA\uFF0C\u4F46\u662F\u8FD8\u6CA1\u6709\u8C03\u7528start()\u65B9\u6CD5</p><p>RUNNABLE\u5F53\u8C03\u7528\u4E86start()\u65B9\u6CD5\u4E4B\u540E\uFF0C\u7EBF\u7A0B\u5C31\u662FRUNNABLE\u72B6\u6001\uFF0C<strong>\u8FD0\u884C\u72B6\u6001\u548C\u5C31\u7EEA\u72B6\u6001\u90FD\u662FRUNNABLE\u72B6\u6001</strong></p><p>\u4ECE\u7EBF\u7A0B\u7684\u751F\u547D\u5468\u671F\u56FE\u6765\u770B\uFF0C\u662F\u533A\u5206\u4E86\u5C31\u7EEA\u72B6\u6001\u548C\u8FD0\u884C\u72B6\u6001\u3002\u6BD4\u5982\u8C03\u7528yield\u65B9\u6CD5\uFF0C\u4F1A\u4ECE\u8FD0\u884C\u72B6\u6001\u5230\u5C31\u7EEA\u72B6\u6001\u3002</p></li><li><p>NEW RUNNABLE BLOCKED WAITING TIMED_WAITING TERMINATED</p></li><li><p>BLOCKED WAITING TIMED_WAITING \u8FD9\u4E09\u79CD\u72B6\u6001\uFF0C\u662FJava\u5C42\u9762\u7684<strong>\u963B\u585E</strong>\u3002</p><p>\u6BD4\u5982<strong>sleep()\u5BF9\u5E94\u5C31\u662F\u8FDB\u5165TIMED_WAITING\u72B6\u6001</strong></p><p><strong>join()\uFF0C\u5C31\u662F\u8FDB\u5165WAITING\u72B6\u6001</strong></p></li><li><p>join()\u662F\u7B49\u5F85\u8C03\u7528join()\u7684\u7EBF\u7A0B\u8FD0\u884C\u7ED3\u675F\uFF01</p><p>\u54EA\u4E2A\u7EBF\u7A0B\u53BB\u8C03\u7528join()\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u7EBF\u7A0B\u8FD8\u5728\u8FD0\u884C\u4E2D\uFF01\u522B\u7684\u7EBF\u7A0B\u5FC5\u987B\u7B49\u5F85\u8C03\u7528join\u7684\u8FD9\u4E2A\u7EBF\u7A0B\u8FD0\u884C\u7ED3\u675F\u624D\u53EF\u4EE5\u8FD0\u884C</p><p>\u4E0D\u8981\u8BA4\u4E3A\u8C01\u8C03\u7528join()\uFF0C\u8C01\u5C31\u8FDB\u5165WAITING\u72B6\u6001\u4E86</p></li></ol><h2 id="\u5171\u4EAB\u6A21\u578B\u4E4B\u7BA1\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u5171\u4EAB\u6A21\u578B\u4E4B\u7BA1\u7A0B" aria-hidden="true">#</a> \u5171\u4EAB\u6A21\u578B\u4E4B\u7BA1\u7A0B</h2><ol><li><p>\u591A\u4E2A\u7EBF\u7A0B\u5171\u4EAB\u5185\u5B58\u4E2D\u7684\u8D44\u6E90\u4F1A\u9020\u6210\u5B89\u5168\u9690\u60A3</p><p>\u5982\u679C\u662F\u591A\u6838CPU\uFF0C\u90A3\u4E48\u591A\u4E2A\u7EBF\u7A0B\u5E76\u884C\u6267\u884C\uFF0C\u5982\u679C\u8BBF\u95EE\u5185\u5B58\u4E2D\u7684\u540C\u4E00\u4E2A\u8D44\u6E90\uFF0C\u7531\u4E8E\u7EBF\u7A0B\u90FD\u662F\u505A\u7684\u4E0D\u540C\u7684\u4EFB\u52A1\uFF0C\u80AF\u5B9A\u4F1A\u51FA\u73B0\u5B89\u5168\u95EE\u9898\uFF0C\u5373<strong>\u7ED3\u679C\u4E0D\u786E\u5B9A</strong>\u3002</p><p>\u5982\u679C\u662F\u5355\u6838CPU\uFF0C\u91C7\u7528\u7684\u662F\u65F6\u95F4\u7247\u8F6E\u8F6C\u7684\u65B9\u5F0F\uFF0C**\u90A3\u4E48\u7EBF\u7A0B\u95F4\u4ECD\u7136\u662F\u53EF\u80FD\u8BBF\u95EE\u540C\u4E00\u4E2A\u8D44\u6E90\uFF0C\u4ECD\u7136\u53EF\u80FD\u51FA\u73B0\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002**\u6BD4\u5982\u4E24\u4E2A\u7EBF\u7A0B\u4EA4\u66FF\u6267\u884C\uFF0C\u91C7\u7528\u65F6\u95F4\u7247\u8F6E\u8F6C\u7684\u65B9\u5F0F\uFF0C\u4F46\u662F\u4ED6\u4EEC\u6BCF\u6B21\u6267\u884C\u90FD\u53BB\u8BBF\u95EE\u4E00\u4E2A\u9759\u6001\u53D8\u91CF\uFF0C\u8FD9\u4E2A\u9759\u6001\u53D8\u91CF\u5C5E\u4E8E\u7C7B\u7684\u7ED3\u6784\uFF0C\u968F\u7740\u7C7B\u7684\u52A0\u8F7D\u800C\u52A0\u8F7D\uFF0C\u5C5E\u4E8E\u5171\u4EAB\u8D44\u6E90\uFF0C\u4ED6\u4EEC\u4F1A\u51FA\u73B0\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002</p><p>\u603B\u7ED3\uFF1A\u591A\u4E2A\u7EBF\u7A0B\u53EA\u8981\u8BBF\u95EE\u7684\u662F\u540C\u4E00\u5757\u8D44\u6E90\uFF0C\u5C31\u53EF\u80FD\u51FA\u73B0\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\uFF0C\u5FC5\u987B\u91C7\u53D6\u76F8\u5E94\u7684\u63AA\u65BD\u3002</p></li><li><p>\u4E5F\u5C31\u662F\u8BF4\u591A\u4E2A\u7EBF\u7A0B\u5E76\u884C\u6267\u884C\uFF0C\u53BB\u8BBF\u95EE\u540C\u4E00\u4E2A\u8D44\u6E90\uFF0C\u4F1A\u9020\u6210\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002</p><p>\u5355\u6838CPU\uFF0C\u591A\u4E2A\u7EBF\u7A0B\u4EA4\u66FF\u6267\u884C\uFF0C\u7531\u4E8E\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u9020\u6210\u7684\u6307\u4EE4\u4EA4\u9519\uFF0C\u8FD9\u591A\u4E2A\u7EBF\u7A0B\u53C8\u8BBF\u95EE\u540C\u4E00\u4E2A\u8D44\u6E90\uFF0C\u51FA\u73B0\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002</p></li><li><p>\u4E00\u4E2A\u7A0B\u5E8F\u8FD0\u884C\u591A\u4E2A\u7EBF\u7A0B\u672C\u8EAB\u662F\u6CA1\u6709\u95EE\u9898\u7684</p><p>\u95EE\u9898\u51FA\u5728\u591A\u4E2A\u7EBF\u7A0B\u8BBF\u95EE\u5171\u4EAB\u8D44\u6E90</p><p>\u591A\u4E2A\u7EBF\u7A0B\u8BFB\u53D6\u5171\u4EAB\u8D44\u6E90\u5176\u5B9E\u4E5F\u6CA1\u6709\u95EE\u9898</p><p>\u5728\u591A\u4E2A\u7EBF\u7A0B\u5BF9\u5171\u4EAB\u8D44\u6E90\u8FDB\u884C\u8BFB\u5199\u64CD\u4F5C\u65F6\uFF0C\u53D1\u751F\u4E86\u6307\u4EE4\u4EA4\u9519\uFF0C\u5C31\u4F1A\u51FA\u73B0\u95EE\u9898</p></li><li><p>\u4E00\u6BB5\u4EE3\u7801\u5757\u5185\uFF0C\u5982\u679C\u5B58\u5728<strong>\u5BF9\u5171\u4EAB\u8D44\u6E90\u7684\u591A\u7EBF\u7A0B\u8BFB\u5199\u64CD\u4F5C</strong>\uFF0C\u79F0\u8FD9\u6BB5\u4EE3\u7801\u5757\u4E3A\u4E34\u754C\u533A</p></li><li><p>\u7ADE\u6001\u6761\u4EF6</p><p><strong>\u591A\u4E2A\u7EBF\u7A0B\u5728\u4E34\u754C\u533A\u5185\u6267\u884C\uFF0C\u7531\u4E8E\u4EE3\u7801\u7684\u6267\u884C\u5E8F\u5217\u4E0D\u540C\u800C\u5BFC\u81F4\u7ED3\u679C\u65E0\u6CD5\u9884\u6D4B\uFF0C\u79F0\u4E3A\u53D1\u751F\u4E86\u7ADE\u6001\u6761\u4EF6</strong></p></li></ol><h3 id="synchronized\u89E3\u51B3\u65B9\u6848" tabindex="-1"><a class="header-anchor" href="#synchronized\u89E3\u51B3\u65B9\u6848" aria-hidden="true">#</a> synchronized\u89E3\u51B3\u65B9\u6848</h3><ol><li><p>\u4E3A\u4E86\u907F\u514D\u4E34\u754C\u533A\u7684\u7ADE\u6001\u6761\u4EF6\u53D1\u751F</p><p>\u963B\u585E\u5F0F\u7684\u89E3\u51B3\u65B9\u6848\uFF1Asynchronized\uFF0CLock</p><p>\u975E\u963B\u585E\u5F0F\u7684\u89E3\u51B3\u65B9\u6848\uFF1A\u539F\u5B50\u53D8\u91CF</p></li><li><p>synchronized\u4FD7\u79F0\u5BF9\u8C61\u9501\uFF0C\u5B83\u4F1A\u91C7\u7528\u4E92\u65A5\u7684\u65B9\u5F0F\u8BA9\u540C\u4E00\u65F6\u523B\u81F3\u591A\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u80FD\u6301\u6709\u5BF9\u8C61\u9501\u3002\u5176\u4ED6\u7EBF\u7A0B\u518D\u60F3\u83B7\u53D6\u8FD9\u4E2A\u5BF9\u8C61\u9501\u65F6\u5C31\u4F1A\u963B\u585E\u4F4F\u3002</p><p>sleep() join() \u7B49\u5F85\u540C\u6B65\u9501 wait() suspend()</p><p>\u8FD9\u51E0\u79CD\u4F1A\u8BA9\u7EBF\u7A0B\u4ECE\u8FD0\u884C\u6001\u5230\u963B\u585E\u6001\u3002</p><p>\u8FD9\u91CC\u8BF4\u7684\u5C31\u662F\u7B49\u5F85\u540C\u6B65\u9501\u3002</p><p>\u4E00\u4E2A\u7EBF\u7A0B\u9700\u8981\u67D0\u4E2A\u8D44\u6E90\u624D\u80FD\u6267\u884C\uFF0C\u8FD9\u91CC\u9501\u5C31\u662F\u8FD9\u4E2A\u8D44\u6E90\uFF0C\u4F46\u662F\u83B7\u53D6\u4E0D\u5230\u8FD9\u4E2A\u8D44\u6E90\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u7EBF\u7A0B\u4F1A\u8FDB\u5165\u963B\u585E\u72B6\u6001\u3002</p></li><li><p>synchronized\u80FD\u4FDD\u8BC1\u62E5\u6709\u9501\u7684\u7EBF\u7A0B\u53EF\u4EE5\u5B89\u5168\u5730\u6267\u884C\u4E34\u754C\u533A\u5185\u7684\u4EE3\u7801\uFF0C\u4E0D\u7528\u62C5\u5FC3\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u5207\u6362\u3002</p><p>\u56E0\u4E3A\u53EA\u8981\u8FD9\u4E2A\u7EBF\u7A0B\u4E0D\u91CA\u653E\u76D1\u89C6\u5668\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u5C31\u65E0\u6CD5\u6267\u884C\u8FD9\u5757\u4EE3\u7801</p></li><li><p>\u91C7\u7528\u7EE7\u627FThread\u7684\u65B9\u5F0F\u521B\u5EFA\u7684\u7EBF\u7A0B\uFF0C\u8981\u6CE8\u610F\u540C\u6B65\u76D1\u89C6\u5668\u8981\u4F7F\u7528\u7C7B\u7684\u5BF9\u8C61\uFF0C\u907F\u514D\u76F4\u63A5\u4F7F\u7528\u7EBF\u7A0B\u5BF9\u8C61\uFF0C\u56E0\u4E3A\u8981\u4FDD\u8BC1\u4F7F\u7528\u7684\u540C\u6B65\u76D1\u89C6\u5668\u662F\u552F\u4E00\u7684\u3002<strong>\u6240\u4EE5\u8FD9\u79CD\u60C5\u51B5\u4E0B\u4E0D\u80FD\u7528this</strong></p></li><li><p><strong>\u4E0D\u8981\u9519\u8BEF\u7406\u89E3\u4E3A\u62E5\u6709\u9501\u7684\u7EBF\u7A0B\u5C31\u80FD\u4E00\u76F4\u6267\u884C\u4E0B\u53BB\uFF0C\u56E0\u4E3A\u8FD9\u4E2A\u7EBF\u7A0B\u53EF\u80FD\u4F1A\u65F6\u95F4\u7247\u7528\u5B8C\uFF0C\u4F46\u662F\u5373\u65F6\u8FD9\u4E2A\u7EBF\u7A0B\u7684\u65F6\u95F4\u7247\u7528\u5B8C\uFF0C\u53EA\u8981\u5B83\u6CA1\u6709\u91CA\u653E\u9501\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u4ECD\u7136\u8FDB\u4E0D\u6765\u8FD9\u5757\u4EE3\u7801\u3002\u53EA\u6709\u7B49\u8FD9\u4E2A\u7EBF\u7A0B\u4E0B\u4E00\u6B21\u5206\u914D\u5230\u65F6\u95F4\u7247\uFF0C\u624D\u4F1A\u7EE7\u7EED\u8FDB\u53BB\u6267\u884C\u3002</strong></p></li><li><p>\u963B\u585E\u7684\u7EBF\u7A0B\u88AB\u5524\u9192\u4E4B\u540E\u4E5F\u4E0D\u662F\u8BF4\u5C31\u53EF\u4EE5\u7ACB\u5373\u6267\u884C\u4E86\uFF0C\u4ECD\u7136\u8981\u7B49CPU\u5206\u914D\u65F6\u95F4\u7247\u7ED9\u8FD9\u4E2A\u7EBF\u7A0B\u3002</p><p>\u603B\u4E4B\u7EBF\u7A0B\u60F3\u8981\u6267\u884C\u67D0\u4E00\u6BB5\u4EE3\u7801\uFF0C\u9664\u4E86CPU\u9700\u8981\u5206\u914D\u7ED9\u8FD9\u4E2A\u7EBF\u7A0B\u65F6\u95F4\u7247\uFF0C\u8FD8\u8981\u8FD9\u6BB5\u4EE3\u7801\u7684\u9501\uFF08\u8FD9\u91CC\u8BA8\u8BBA\u7684\u662F\u540C\u6B65\u76D1\u89C6\u5668\u9501\u7684\u60C5\u51B5\uFF09\uFF0C\u5982\u679C\u83B7\u53D6\u4E0D\u5230\u9501\uFF0C\u5C31\u76F8\u5F53\u4E8E\u83B7\u53D6\u4E0D\u5230\u8D44\u6E90\uFF0C\u90A3\u4E48\u5C31\u4F1A\u88AB\u963B\u585E\u3002</p><p>\u7EBF\u7A0B\u9700\u8981\u83B7\u53D6\u5230\u8D44\u6E90\u624D\u80FD\u6267\u884C\u67D0\u6BB5\u4EE3\u7801\uFF0C\u5982\u679C\u4E00\u76F4\u83B7\u53D6\u4E0D\u5230\u8D44\u6E90\uFF0C\u90A3\u4E48\u5C31\u4F1A\u88AB\u963B\u585E\u3002\u5F53\u7EBF\u7A0B\u6267\u884C\u8FD9\u6BB5\u4EE3\u7801\u9700\u8981\u7684\u8D44\u6E90\u88AB\u91CA\u653E\u540E\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u7EBF\u7A0B\u4ECE\u963B\u585E\u6001\u88AB\u5524\u9192\uFF0C\u4E5F\u4E0D\u80FD\u9A6C\u4E0A\u6267\u884C\uFF0C\u800C\u662F\u8FDB\u5165\u5C31\u7EEA\u72B6\u6001\uFF0C\u7B49\u5F85CPU\u5206\u914D\u65F6\u95F4\u7247\u7ED9\u8FD9\u4E2A\u7EBF\u7A0B\u3002</p></li><li><p>synchronized\u5B9E\u9645\u662F\u7528\u5BF9\u8C61\u9501\u4FDD\u8BC1\u4E86\u4E34\u754C\u533A\u5185\u4EE3\u7801\u7684\u539F\u5B50\u6027\uFF0C\u4E34\u754C\u533A\u5185\u7684\u4EE3\u7801\u6267\u884C<strong>\u4E0D\u4F1A\u88AB\u7EBF\u7A0B\u5207\u6362\u6240\u6253\u65AD\u3002</strong></p><p>\u6BD4\u5982\u8BF4\u67D0\u4E2A\u7EBF\u7A0B\u62E5\u6709\u67D0\u6BB5\u4EE3\u7801\u7684\u9501\uFF0C\u5373\u65F6\u8FD9\u4E2A\u7EBF\u7A0B\u65F6\u95F4\u7247\u7528\u5B8C\uFF0C\u53EA\u8981\u5B83\u6CA1\u6709\u91CA\u653E\u9501\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u4ECD\u7136\u4E0D\u80FD\u8FDB\u6765\u6267\u884C\u8FD9\u6BB5\u4EE3\u7801\uFF0C\u8FD9\u6BB5\u4EE3\u7801\u53EA\u6709\u7B49CPU\u4E0B\u4E00\u6B21\u5206\u914D\u65F6\u95F4\u7247\u7ED9\u8FD9\u4E2A\u7EBF\u7A0B\uFF0C\u624D\u53EF\u4EE5\u7EE7\u7EED\u6267\u884C\u3002</p><p>\u4F46\u5343\u4E07\u4E0D\u8981\u7406\u89E3\u4E3A\u4E00\u4E2A\u7EBF\u7A0B\u62E5\u6709\u67D0\u6BB5\u4EE3\u7801\u7684\u9501\uFF0C\u5C31\u53EF\u4EE5\u4E00\u76F4\u6267\u884C\u4E0B\u53BB\uFF0C\u4E2D\u95F4\u4ECD\u7136\u6709\u65F6\u95F4\u7247\u7528\u5B8C\u7684\u8FC7\u7A0B\uFF0C\u4ECD\u7136\u5B58\u5728\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u4F46\u662F\u88AB\u9501\u4F4F\u7684\u8FD9\u6BB5\u4EE3\u7801\u4FDD\u8BC1\u4E86\u539F\u5B50\u6027\u3002</p><p>**\u5373\u65F6\u53D1\u751F\u4E86\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u8FD9\u6BB5\u4EE3\u7801\u4E5F\u4E0D\u4F1A\u8BA9\u5176\u4ED6\u6CA1\u6709\u62E5\u6709\u9501\u7684\u7EBF\u7A0B\u6765\u6267\u884C\u3002**\u53EA\u6709\u7B49\u8FD9\u4E2A\u62E5\u6709\u9501\u7684\u7EBF\u7A0B\u4E0B\u4E00\u6B21\u5206\u914D\u5230\u65F6\u95F4\u7247</p></li><li><p>\u518D\u4E00\u6B21\u8BF4\u660E\u4E86\u5373\u4F7F\u662F\u5355\u6838CPU\u901A\u8FC7\u65F6\u95F4\u7247\u8F6E\u8F6C\u7684\u65B9\u5F0F\u4EA4\u66FF\u6267\u884C\u7EBF\u7A0B\uFF0C\u4ECD\u7136\u4F1A\u51FA\u73B0\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\uFF0C\u4E0D\u8981\u4EE5\u4E3A\u5728\u5FAE\u89C2\u4E0A\u662F\u4E32\u884C\u7684\uFF0C\u5B9E\u9645\u6CA1\u6709\u7EBF\u7A0B\u540C\u4E00\u65F6\u523B\u53BB\u64CD\u4F5C\u540C\u4E00\u4E2A\u8D44\u6E90\uFF0C\u5C31\u4E0D\u4F1A\u5B58\u5728\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\uFF0C\u5173\u952E\u5728\u4E8E\u65F6\u95F4\u7247\u4F1A\u7528\u5B8C\uFF0C\u7ED3\u679C\u6CA1\u4FDD\u5B58\u7684\u60C5\u51B5\u4E0B\uFF0C\u67D0\u4E2A\u8D44\u6E90\u53C8\u88AB\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u53BB\u6267\u884C\u3002<strong>\u5173\u952E\u5728\u4E8E\u591A\u4E2A\u7EBF\u7A0B\u64CD\u4F5C\u5171\u4EAB\u6570\u636E\uFF0C\u5373\u65F6\u4ED6\u4EEC\u4E0D\u662F\u5728\u540C\u4E00\u65F6\u523B\u64CD\u4F5C\u5171\u4EAB\u6570\u636E\uFF0C\u800C\u662F\u5728\u591A\u4E2A\u65F6\u95F4\u6BB5\u64CD\u4F5C\u5171\u4EAB\u6570\u636E\uFF0C\u4ECD\u7136\u4F1A\u51FA\u73B0\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002</strong>\uFF08<strong>\u56E0\u4E3A\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u53D1\u751F\u6307\u4EE4\u4EA4\u9519</strong>\uFF09</p></li><li><p>\u64CD\u4F5C\u5171\u4EAB\u6570\u636E\u7684\u4EE3\u7801\uFF0C\u5373\u4E3A\u9700\u8981\u88AB\u540C\u6B65\u7684\u4EE3\u7801</p><p>\u5171\u4EAB\u6570\u636E\uFF1A\u591A\u4E2A\u7EBF\u7A0B\u5171\u540C\u64CD\u4F5C\u7684\u53D8\u91CF\u3002</p></li></ol><h3 id="\u53D8\u91CF\u7684\u7EBF\u7A0B\u5B89\u5168\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#\u53D8\u91CF\u7684\u7EBF\u7A0B\u5B89\u5168\u5206\u6790" aria-hidden="true">#</a> \u53D8\u91CF\u7684\u7EBF\u7A0B\u5B89\u5168\u5206\u6790</h3><ol><li><p>\u6210\u5458\u53D8\u91CF\u548C\u9759\u6001\u53D8\u91CF</p><ul><li>\u5982\u679C\u4ED6\u4EEC\u6CA1\u6709\u88AB\u5171\u4EAB\uFF0C\u5219\u7EBF\u7A0B\u5B89\u5168</li><li>\u5982\u679C\u4ED6\u4EEC\u88AB\u5171\u4EAB <ul><li>\u5982\u679C\u53EA\u6709\u8BFB\u64CD\u4F5C\uFF0C\u5219\u7EBF\u7A0B\u5B89\u5168</li><li>\u5982\u679C\u6709\u8BFB\u5199\u64CD\u4F5C\uFF0C\u5219\u8FD9\u6BB5\u4EE3\u7801\u662F\u4E34\u754C\u533A\uFF0C\u9700\u8981\u8003\u8651\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898</li></ul></li></ul></li><li><p>\u5C40\u90E8\u53D8\u91CF\u662F\u7EBF\u7A0B\u5B89\u5168\u7684</p><p>\u5C40\u90E8\u53D8\u91CF\u662F\u5728\u6808\u7684\u6808\u5E27\u91CC\u3002\u6808\u662F\u7EBF\u7A0B\u79C1\u6709\u7684\uFF0C\u6240\u4EE5\u5C40\u90E8\u53D8\u91CF\u662F\u7EBF\u7A0B\u5B89\u5168\u7684</p><p>\u5C40\u90E8\u53D8\u91CF\u5F15\u7528\u7684\u5BF9\u8C61\uFF1A</p><ul><li>\u5982\u679C\u8BE5\u5BF9\u8C61\u6CA1\u6709\u9003\u79BB\u65B9\u6CD5\u7684\u4F5C\u7528\u8303\u56F4\uFF0C\u5B83\u662F\u7EBF\u7A0B\u5B89\u5168\u7684</li><li>\u5982\u679C\u8BE5\u5BF9\u8C61\u9003\u79BB\u65B9\u6CD5\u7684\u4F5C\u7528\u8303\u56F4\uFF0C\u9700\u8981\u8003\u8651\u7EBF\u7A0B\u5B89\u5168</li></ul></li><li><p>i++\u867D\u7136\u5728\u5B57\u8282\u7801\u6307\u4EE4\u5C42\u9762\uFF0C\u5206\u4E3A\u597D\u51E0\u6761\u5B57\u8282\u7801\u6307\u4EE4\uFF0C\u4E0D\u662F\u539F\u5B50\u64CD\u4F5C\uFF0C\u4F46\u662F\u8FD9\u51E0\u6761\u5B57\u8282\u7801\u6307\u4EE4\u4E0D\u88AB\u7EBF\u7A0B\u6240\u5171\u4EAB\u3002</p></li></ol><h3 id="monitor\u6982\u5FF5" tabindex="-1"><a class="header-anchor" href="#monitor\u6982\u5FF5" aria-hidden="true">#</a> Monitor\u6982\u5FF5</h3><ol><li><p>Java\u5BF9\u8C61\u5728\u5806\u7A7A\u95F4\u4E2D\u88AB\u5B9E\u4F8B\u5316\u4EE5\u540E\uFF0C\u4E3B\u8981\u5206\u4E3A\u4E24\u90E8\u5206</p><ul><li><p>\u5BF9\u8C61\u5934</p><ul><li>\u8FD0\u884C\u65F6\u5143\u6570\u636E\uFF08Mark Word\uFF09----hashcode\uFF0C\u5206\u4EE3\u5E74\u9F84\uFF08\u4ECE\u5E78\u5B58\u8005\u533A\u5230\u8001\u5E74\u4EE3\uFF09\uFF0C\u504F\u5411\u9501\uFF0C\u52A0\u9501\u72B6\u6001</li><li><strong>\u7C7B\u578B\u6307\u9488</strong>---\u6307\u5411\u65B9\u6CD5\u533A\u4E2D\u8FD9\u4E2A\u5BF9\u8C61\u7684\u7C7B\u7684\u4FE1\u606F\uFF0C\u901A\u8FC7\u8FD9\u4E2A\u6307\u9488\u53EF\u4EE5\u627E\u5230\u7C7B\u5BF9\u8C61</li><li>\uFF08\u5982\u679C\u662F\u6570\u7EC4\uFF0C\u8FD8\u6709\u6570\u7EC4\u7684\u957F\u5EA6\u7684\u4FE1\u606F\uFF09</li></ul><p><img src="'+r+'" alt="image-20210906143610290"></p><p>\u8FD0\u884C\u65F6\u5143\u6570\u636EMark Word\u683C\u5F0F\uFF1A</p><p><img src="'+t+'" alt="image-20210906171812809"></p></li><li><p>\u5B9E\u4F8B\u6570\u636E\uFF08\u771F\u6B63\u7684\u6709\u6548\u6570\u636E\uFF0C\u6210\u5458\u53D8\u91CF\u7B49\u7B49\uFF09</p></li></ul></li><li><p>\u5305\u88C5\u7C7B\u578B\u6BD4\u57FA\u672C\u7C7B\u578B\u5360\u7528\u7684\u7A7A\u95F4\u5927\u3002\u4ECE\u5BF9\u8C61\u5934\u7684\u89D2\u5EA6\u5C31\u53EF\u4EE5\u770B\u51FA\u6765\u3002</p></li><li><p>Monitor\u662F\u975E\u5E38\u91CD\u8981\u7684\u6982\u5FF5\uFF0C\u4E5F\u662FSynchronized\u9501\u5E95\u5C42\u7684\u539F\u7406\u3002</p><p>Monitor\u88AB\u7FFB\u8BD1\u4E3A\u76D1\u89C6\u5668\u6216\u7BA1\u7A0B</p></li><li><p>\u6BCF\u4E2AJava\u5BF9\u8C61\u90FD\u53EF\u4EE5\u5173\u8054\u4E00\u4E2AMonitor\u5BF9\u8C61\uFF0C\u5982\u679C\u4F7F\u7528synchronized\u7ED9\u5BF9\u8C61\u4E0A\u9501\uFF08\u91CD\u91CF\u7EA7\uFF09\u4E4B\u540E\uFF0C\u8BE5\u5BF9\u8C61\u5934\u7684Mark Word\u4E2D\u5C31\u88AB\u8BBE\u7F6E\u6307\u5411Monitor\u5BF9\u8C61\u7684\u6307\u9488\u3002</p></li><li><p>synchronized\u4E0A\u9501\u7ED9\u4EE3\u7801\u5757\u4E0A\u9501\uFF0C\u6216\u8005\u91C7\u7528\u540C\u6B65\u65B9\u6CD5\u7684\u65B9\u5F0F\uFF0C\u5E95\u5C42\u539F\u7406\u90FD\u662F\u7ED9\u5BF9\u8C61\u4E0A\u9501\u3002</p><p><img src="'+n+'" alt="image-20210906144113619"></p></li><li><p>\u4E00\u4E2A\u5BF9\u8C61\u5728\u5806\u7A7A\u95F4\u4E2D\u5206\u4E3A\u5BF9\u8C61\u5934\u548C\u5B9E\u4F8B\u6570\u636E</p><p>\u5BF9\u8C61\u5934\u91CC\u6709\u8FD0\u884C\u65F6\u5143\u6570\u636E\uFF08Mark Word\uFF09\u548C\u7C7B\u578B\u6307\u9488\uFF0C\u5982\u679C\u662F\u6570\u7EC4\u8FD8\u6709\u6570\u7EC4\u7684\u957F\u5EA6\u4FE1\u606F\uFF0C\u5728\u8FD0\u884C\u65F6\u5143\u6570\u636E\u91CC\u5C31\u6709hashcode\uFF0C\u5206\u4EE3\u5E74\u9F84\uFF0C\u504F\u5411\u9501\u548C\u52A0\u9501\u72B6\u6001\u7684\u4FE1\u606F\u3002</p><p>\u7ED9\u4E00\u4E2A\u5BF9\u8C61\u4E0A\u9501\u4E4B\u540E\uFF0C\u8FD9\u4E2AJava\u5BF9\u8C61\u7684\u5BF9\u8C61\u5934\u7684\u8FD0\u884C\u65F6\u5143\u6570\u636E\uFF08Mark Word\uFF09\u5C31\u6307\u5411\uFF08\u5173\u8054\uFF09\u4E00\u4E2AMonitor\u5BF9\u8C61\u3002\u8FD0\u884C\u65F6\u5143\u6570\u636E\u91CC\u5B58\u50A8\u4E86\u4E00\u4E2A\u6307\u5411Monitor\u7684\u5730\u5740\u6307\u9488</p></li><li><p>Monitor\u91CC\u7684\u5C5E\u6027</p><ul><li><p>Owner\uFF0C\u662F\u9501\u7684\u6240\u6709\u8005</p><p>Monitor\u7684\u8FD9\u4E2AOwner\u53EA\u80FD\u6709\u4E00\u4E2A\u6240\u6709\u8005\u3002</p></li><li><p>EntryList\uFF0C\u662F\u7B49\u5F85\u961F\u5217</p><p>\u6BD4\u5982\u5F53\u524DMonitor\u7684Owner\uFF0C\u5373\u62E5\u6709\u5F53\u524D\u8FD9\u4E2AMonitor\u7684\u7EBF\u7A0B\u662FThread1\uFF0C\u90A3\u4E48\u5F53Thread2\u6765\u5224\u65AD\u662F\u5426\u53EF\u4EE5\u8BBF\u95EE\u8FD9\u6BB5\u4E34\u754C\u4EE3\u7801\u65F6\uFF0C\u9996\u5148\u5224\u65AD\u8FD9\u4E2A\u9501\u5BF9\u8C61obj\u7684\u8FD0\u884C\u65F6\u5143\u6570\u636E\uFF08Mark Word\uFF09\u6709\u6CA1\u6709\u6307\u5411Monitor\u7684\u6307\u9488\uFF0C\u5373\u6709\u6CA1\u6709\u5173\u8054\u4E00\u4E2AMonitor\u5BF9\u8C61\uFF0C\u5982\u679C\u6709\uFF0C\u518D\u5224\u65AD\u8FD9\u4E2AMonitor\u7684Owner\u6709\u6CA1\u6709\u6240\u6709\u8005\uFF0C\u5982\u679C\u6709\u7684\u8BDD\uFF0C\u5C31\u8FDB\u5165EntryList\u7B49\u5F85\u961F\u5217\uFF08\u6216\u8005\u53EB\u963B\u585E\u72B6\u6001\uFF09\uFF0C\u90A3\u4E48\u8FD9\u4E2AThread2\u672C\u8EAB\u8FDB\u5165\u963B\u585E\u72B6\u6001\uFF08BLOCKED\uFF09\uFF0C\u7B49\u5F85\u5176\u4ED6\u7EBF\u7A0B\u91CA\u653E\u5BF9Monitor\u7684\u6240\u6709\u6743\u3002</p><p>\u5982\u679C\u6B64\u65F6\u53C8\u6709\u4E00\u4E2A\u7EBF\u7A0B\u6765\u4E86\uFF0C\u4E5F\u8981\u6765\u6267\u884C\u8FD9\u6BB5\u4E34\u754C\u4EE3\u7801\uFF0C\u9996\u5148\u53D1\u73B0obj\u5173\u8054\u4E86Monitor\u5BF9\u8C61\uFF0C\u7136\u540EOwner\u6709\u4E3B\u4EBA\uFF0C\u4E5F\u8FDB\u5165EntryList\u963B\u585E\u961F\u5217\uFF0C\u90A3\u4E48\u8BE5\u7EBF\u7A0B\uFF0C<strong>\u4ECE\u8FD0\u884C\u72B6\u6001\u4E5F\u8FDB\u5165\u963B\u585E\u72B6\u6001\uFF08BLOCKED\uFF09</strong>\u3002</p><p>\u5F53\u4E00\u4E2A\u7EBF\u7A0B\u9700\u8981\u67D0\u6837\u8D44\u6E90\u7EE7\u7EED\u6267\u884C\u7684\u65F6\u5019\uFF0C\u4F46\u662F\u53C8\u83B7\u53D6\u4E0D\u5230\u8FD9\u6837\u8D44\u6E90\uFF0C\u90A3\u4E48\u4F1A\u8FDB\u5165\u963B\u585E\u72B6\u6001\u3002</p><p>\u4E0A\u9762\u8BF4\u7684\u7EBF\u7A0B\u8FDB\u5165\u963B\u585E\u72B6\u6001\u7684\u60C5\u51B5\uFF0C\u662F\u7B49\u5F85\u540C\u6B65\u9501\uFF0C\u7136\u540E\u8FDB\u5165\u963B\u585E\u72B6\u6001\u3002</p><p>\u4E00\u4E2A\u7EBF\u7A0B\u4ECE\u8FD0\u884C\u72B6\u6001\u8FDB\u5165\u963B\u585E\u72B6\u6001\uFF0C\u6709\u4EE5\u4E0B\u4E94\u79CD\u60C5\u51B5</p><ul><li>join()---\u7531RUNNABLE\u5230WAITING</li><li>sleep()----\u7531RUNNABLE \u5230 TIMED_WAITING</li><li>wait()---\u7531RUNNABLE\u5230WAITING</li><li>suspend() \uFF08\u5DF2\u7ECFdeprecated\uFF09</li><li>\u7B49\u5F85\u540C\u6B65\u9501---\u7531RUNNABLE\u5230BLOCKED</li></ul><p>BLOCKED, WAITING, TIMED_WATING\u4E09\u79CD\u72B6\u6001\u5728Java\u7684\u7EBF\u7A0B\u72B6\u6001\u8FD9\u4E2A\u89D2\u5EA6\u6765\u8BF4\uFF0C\u90FD\u53EB\u963B\u585E\u72B6\u6001</p><p><img src="'+o+'" alt="image-20210906145616412"></p></li></ul></li><li><p>\u5BF9synchronized\u5BF9\u4EE3\u7801\u5757\u6216\u65B9\u6CD5\u4E0A\u9501\u7684\u539F\u7406\u63CF\u8FF0</p><ul><li>\u521A\u5F00\u59CBMonitor\u4E2DOwner\u4E3Anull</li><li>\u5F53Thread-2\u6267\u884Csynchronized(obj)\u5C31\u4F1A\u5C06Monitor\u7684\u6240\u6709\u8005Owner\u7F6E\u4E3AThread-2\uFF0CMonitor\u4E2D\u53EA\u80FD\u6709\u4E00\u4E2AOwner</li><li>\u5728Thread-2\u4E0A\u9501\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u5982\u679CThread-3\uFF0CThread-4\uFF0CThread-5\u4E5F\u6765\u6267\u884Csynchronized(obj)\uFF0C\u5C31\u4F1A\u8FDB\u5165EntryList \u7531\u8FD0\u884C\u6001\u5230BLOCKED</li><li>Thread-2\u6267\u884C\u5B8C\u540C\u6B65\u4EE3\u7801\u5757\u7684\u5185\u5BB9\uFF0C\u5373\u4E34\u754C\u533A\u7684\u4EE3\u7801\uFF0C\u7136\u540E\u5524\u9192EntryList\u4E2D\u7B49\u5F85\u7684\u7EBF\u7A0B\u6765\u7ADE\u4E89\u9501\uFF0C\u7ADE\u4E89\u7684\u65F6\u5019\u662F\u975E\u516C\u5E73\u7684\u3002</li></ul></li><li><p>JVM\u57FA\u4E8E\u8FDB\u5165\u548C\u9000\u51FAMonitor\u5BF9\u8C61\u6765\u5B9E\u73B0\u540C\u6B65\u65B9\u6CD5\u548C\u540C\u6B65\u4EE3\u7801\u5757</p><p>\u4F46\u4E24\u8005\u7684\u5B9E\u73B0\u7EC6\u8282\u4E0D\u4E00\u6837\uFF0C\u4EE3\u7801\u5757\u540C\u6B65\u662F\u4F7F\u7528monitorenter\u548Cmonitorexit\u5B57\u8282\u7801\u6307\u4EE4\u5B9E\u73B0\u7684\uFF0C\u800C\u65B9\u6CD5\u540C\u6B65\u662F\u4F7F\u7528\u53E6\u5916\u4E00\u79CD\u65B9\u5F0F\u5B9E\u73B0\u7684\uFF0C\u7EC6\u8282\u5728JVM\u89C4\u8303\u91CC\u5E76\u6CA1\u6709\u8BE6\u7EC6\u8BF4\u660E\uFF0C\u4F46\u662F\uFF0C\u65B9\u6CD5\u7684\u540C\u6B65\u540C\u6837\u53EF\u4EE5\u4F7F\u7528\u8FD9\u4E24\u4E2A\u6307\u4EE4\u6765\u5B9E\u73B0\u3002</p><p>monitorenter\u6307\u4EE4\u662F\u5728\u7F16\u8BD1\u540E\u63D2\u5165\u5230\u540C\u6B65\u4EE3\u7801\u5757\u7684\u5F00\u59CB\u4F4D\u7F6E\uFF0C\u800Cmonitorexit\u662F\u63D2\u5165\u5230\u65B9\u6CD5<strong>\u7ED3\u675F\u5904\u548C\u5F02\u5E38\u5904</strong>\u3002</p><p>JVM\u8981\u4FDD\u8BC1\u6BCF\u4E2Amonitorenter\u5FC5\u987B\u6709\u5BF9\u5E94\u7684monitorexit\u4E0E\u4E4B\u914D\u5BF9\u3002</p><p>\u4EFB\u4F55\u5BF9\u8C61\u90FD\u6709\u4E00\u4E2Amonitor\u4E0E\u4E4B\u5173\u8054\uFF0C\u5F53\u4E14\u4E00\u4E2Amonitor\u88AB\u6301\u6709\u540E\uFF0C\u5B83\u5C06\u5904\u4E8E\u9501\u5B9A\u72B6\u6001\uFF0C<strong>\u7EBF\u7A0B\u6267\u884C\u5230monitorenter\u5B57\u8282\u7801\u6307\u4EE4\u65F6\uFF0C\u5C06\u4F1A\u5C1D\u8BD5\u83B7\u53D6\u4E0A\u9501\u5BF9\u8C61\u6240\u5BF9\u5E94\u7684monitor\u7684\u6240\u6709\u6743\uFF0C\u5373\u5C1D\u8BD5\u83B7\u5F97\u5BF9\u8C61\u7684\u9501</strong></p></li><li><p>synchronized\u5FC5\u987B\u662F\u8FDB\u5165\u540C\u4E00\u4E2A\u5BF9\u8C61\u7684monitor\u624D\u6709\u6548\u679C\uFF0C\u6240\u4EE5\u4E00\u5B9A\u8981\u4FDD\u8BC1\u540C\u6B65\u76D1\u89C6\u5668\u53EA\u6709\u4E00\u4E2A\u3002</p></li></ol><h2 id="synchronized\u8FDB\u9636\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#synchronized\u8FDB\u9636\u539F\u7406" aria-hidden="true">#</a> synchronized\u8FDB\u9636\u539F\u7406</h2><ol><li><p>synchronized\u5DE5\u4F5C\u65B9\u5F0F\u662F\u8BA9\u5BF9\u8C61\u5173\u8054monitor\u5BF9\u8C61\uFF0C\u4F46\u662Fmonitor\u8FD9\u4E2A\u9501\u662F\u7531\u64CD\u4F5C\u7CFB\u7EDF\u63D0\u4F9B\u7684\uFF0C\u4F7F\u7528Monitor\u6210\u672C\u6BD4\u8F83\u9AD8\uFF0C\u5982\u679C\u6BCF\u6B21\u8FDB\u5165synchronized(xxx)\u90FD\u8981\u83B7\u53D6Monitor\u9501\uFF0C\u5BF9\u7A0B\u5E8F\u8FD0\u884C\u7684\u6027\u80FD\u662F\u6709\u5F71\u54CD\u7684\u3002</p></li><li><p>\u4ECEJava6\u5BF9synchronized\u5173\u952E\u5B57\u83B7\u53D6\u9501\u7684\u65B9\u5F0F\u8FDB\u884C\u4E86\u6539\u8FDB\u548C\u4F18\u5316\u3002</p><p><strong>\u4ECE\u76F4\u63A5\u4F7F\u7528Monitor\u9501\u6539\u6210\u4E86\u53EF\u4EE5\u4F7F\u7528\u8F7B\u91CF\u7EA7\u9501\u548C\u504F\u5411\u9501</strong></p></li><li><p>Monitor\u662F\u5C5E\u4E8E\u91CD\u91CF\u7EA7\u9501</p></li><li><p><strong>\u6CA1\u6709\u7ADE\u4E89\u7684\u65F6\u5019\uFF0C\u5C31\u662F\u8BF4\u5982\u679C\u4F7F\u7528\u5171\u4EAB\u8D44\u6E90\u7684\u65F6\u95F4\u662F\u9519\u5F00\u7684\u65F6\u5019\uFF0C\u53EF\u4EE5\u4F7F\u7528\u8F7B\u91CF\u7EA7\u9501\uFF0C\u5982\u679C\u4F7F\u7528\u5171\u4EAB\u6570\u636E\u7684\u65F6\u95F4\u6CA1\u6709\u9519\u5F00\uFF0C\u90A3\u4E48\u8F7B\u91CF\u7EA7\u9501\u4E5F\u4F1A\u5347\u7EA7\u4E3A\u91CD\u91CF\u7EA7\u9501\u3002</strong></p></li><li><p>jdk1.6\u7248\u672C\uFF0C\u4E3A\u4E86\u51CF\u5C11\u83B7\u5F97\u9501\u548C\u91CA\u653E\u9501\u5E26\u6765\u7684\u6027\u80FD\u6D88\u8017\uFF0C\u5F15\u5165\u4E86\u504F\u5411\u9501\u548C\u8F7B\u91CF\u7EA7\u9501\uFF0C\u5728jdk1.6\u4E2D\uFF0C\u9501\u4E00\u5171\u67094\u79CD\u72B6\u6001\uFF0C\u7EA7\u522B\u4ECE\u4F4E\u5230\u9AD8\u4F9D\u6B21\u662F\uFF1A\u65E0\u9501\u72B6\u6001\u3001\u504F\u5411\u9501\u72B6\u6001\u3001\u8F7B\u91CF\u7EA7\u9501\u72B6\u6001\u548C\u91CD\u91CF\u7EA7\u9501\u72B6\u6001\u3002\u8FD9\u51E0\u4E2A\u72B6\u6001\u4F1A\u968F\u7740\u7ADE\u4E89\u60C5\u51B5\u9010\u6E10\u5347\u7EA7\uFF0C\u9501\u53EF\u4EE5\u5347\u7EA7\u4F46\u662F\u4E0D\u80FD\u964D\u7EA7\uFF0C\u610F\u5473\u7740\u504F\u5411\u9501\u5347\u7EA7\u4E3A\u8F7B\u91CF\u7EA7\u9501\u4E4B\u540E\u4E0D\u80FD\u964D\u7EA7\u6210\u504F\u5411\u9501\u3002</p></li></ol><h3 id="\u8F7B\u91CF\u7EA7\u9501" tabindex="-1"><a class="header-anchor" href="#\u8F7B\u91CF\u7EA7\u9501" aria-hidden="true">#</a> \u8F7B\u91CF\u7EA7\u9501</h3><ol><li><p>\u8F7B\u91CF\u7EA7\u9501\u7684\u4F7F\u7528\u573A\u666F\uFF1A\u5982\u679C\u4E00\u4E2A\u5BF9\u8C61\u867D\u7136\u6709\u591A\u7EBF\u7A0B\u8BBF\u95EE\uFF0C\u4F46\u591A\u7EBF\u7A0B\u8BBF\u95EE\u7684\u65F6\u95F4\u662F\u9519\u5F00\u7684\uFF08\u4E5F\u5C31\u662F\u6CA1\u6709\u7ADE\u4E89\uFF09\uFF0C\u90A3\u4E48\u53EF\u4EE5\u4F7F\u7528\u8F7B\u91CF\u7EA7\u9501\u6765\u4F18\u5316\u3002</p><p>\u5982\u679C\u6709\u7ADE\u4E89\uFF0C\u8F7B\u91CF\u7EA7\u9501\u4F1A\u5347\u7EA7\u4E3A\u91CD\u91CF\u7EA7\u9501</p><p><strong>\u8F7B\u91CF\u7EA7\u9501\u7684\u8BED\u6CD5\u4ECD\u7136\u662Fsynchronized</strong></p></li><li><p>\u8F7B\u91CF\u7EA7\u9501\u5DE5\u4F5C\u539F\u7406</p><ol><li><p>\u5728\u7EBF\u7A0B\u7684\u865A\u62DF\u673A\u6808\u7684\u6808\u5E27\u521B\u5EFA\u9501\u8BB0\u5F55\uFF08Lock Record\uFF09\u5BF9\u8C61</p><p>\u6BCF\u4E2A\u7EBF\u7A0B\u7684\u6808\u5E27\u90FD\u4F1A\u5305\u542B\u4E00\u4E2A\u9501\u8BB0\u5F55\u7684\u7ED3\u6784\u3002</p><p>\u5185\u90E8\u53EF\u4EE5\u5B58\u50A8\u9501\u5B9A\u5BF9\u8C61\u7684Mark Word\uFF08\u8FD0\u884C\u65F6\u5143\u6570\u636E\uFF09</p><p><img src="'+s+'" alt="image-20210906162329611"></p><p>\u8FD9\u4E2ALock Record\u5305\u542B\u4E86\u4E24\u90E8\u5206</p><ul><li>\u4E00\u90E8\u5206\u662F\u5BF9\u8C61\u6307\u9488\uFF0C\u9501\u4F4F\u54EA\u4E2A\u5BF9\u8C61\uFF0C\u5F97\u77E5\u9053\u5BF9\u8C61\u5730\u5740\uFF0C\u8FD9\u4E00\u90E8\u5206\u5C31\u662F\u6307\u5411\u52A0\u9501\u5BF9\u8C61\u7684\u5BF9\u8C61\u5F15\u7528</li><li>\u53E6\u4E00\u90E8\u5206\u662F<strong>\u9501\u8BB0\u5F55\u5730\u5740\u548C\u540E\u4E24\u4F4D\u6807\u8BC600</strong>\uFF0800\u4EE3\u8868\u8F7B\u91CF\u7EA7\u9501\uFF09\uFF0C\u8FD9\u4E00\u90E8\u5206\u5C06\u6765<strong>\u7528\u6765\u5B58\u50A8\u52A0\u9501\u5BF9\u8C61\u7684Mark Word</strong></li></ul></li><li><p>\u8BA9\u9501\u8BB0\u5F55\u4E2DObject reference\u6307\u5411\u9501\u5BF9\u8C61\uFF0C<strong>\u5E76\u5C1D\u8BD5\u7528cas\u66FF\u6362Object\u7684Mark Word\uFF0C\u5C06Mark Word\u7684\u503C\u5B58\u5165\u9501\u8BB0\u5F55</strong>\uFF08\u5173\u952E\uFF09\u3002</p><p><strong>\u505A\u8FD9\u4E00\u6B65\u4EA4\u6362\u7684\u64CD\u4F5C\u5C31\u8868\u793A\u52A0\u9501</strong></p><p><img src="'+d+'" alt="image-20210906162952714"></p></li><li><p>\u5982\u679CCAS\u66FF\u6362\u6210\u529F\uFF0C<strong>\u5BF9\u8C61\u5934\u4E2D\u5B58\u50A8\u4E86\u9501\u8BB0\u5F55\u5730\u5740\u548C\u72B6\u600100</strong>\uFF0C<strong>\u8868\u793A\u8FD9\u4E2A\u5BF9\u8C61\u5DF2\u7ECF\u52A0\u4E86\u8F7B\u91CF\u7EA7\u9501</strong></p><p><strong>\u9501\u8BB0\u5F55\u91CC\u9762\u5B58\u653E\u4E86\u5BF9\u8C61\u7684\u5BF9\u8C61\u5934\u7684Mark Word\uFF08\u8FD0\u884C\u65F6\u5143\u6570\u636E--hashcode\uFF0C\u5206\u4EE3\u5E74\u9F84\u7B49\uFF09</strong></p><p>\u5C06\u6765\u89E3\u9501\u7684\u65F6\u5019\uFF0C\u518D\u6062\u590D\u56DE\u53BB</p><p><img src="'+h+'" alt="image-20210906163537132"></p><p>\u4E0A\u9762\u8BF4\u7684\u662F\u6210\u529F\u7684\u60C5\u51B5\uFF0C\u5982\u679C\u5BF9\u8C61\u7684\u5BF9\u8C61\u5934\u7684Mark Word\u6807\u8BB0\u4F4D\u662F01\uFF0C\u4EE3\u8868\u662F\u6B63\u5E38\u60C5\u51B5\uFF0C\u6CA1\u6709\u52A0\u9501\uFF0C\u90A3\u4E48\u8FD9\u79CD\u60C5\u51B5\uFF0C\u4EA4\u6362\u53EF\u4EE5\u6210\u529F\uFF0C\u5373\u52A0\u9501\u53EF\u4EE5\u6210\u529F</p></li><li><p>\u5982\u679CCAS\u66FF\u6362\u5931\u8D25\uFF0C\u6709\u4E24\u79CD\u60C5\u51B5</p><ul><li><p>\u5982\u679C\u662F\u5176\u4ED6\u7EBF\u7A0B\u5DF2\u7ECF\u6301\u6709\u4E86\u8BE5Object\u5BF9\u8C61\u7684\u8F7B\u91CF\u7EA7\u9501\uFF08Object\u5BF9\u8C61\u5BF9\u8C61\u5934\u91CC\u6807\u8BB0\u662F00\uFF09\uFF0C\u8FD9\u65F6\u8868\u660E\u6709\u7ADE\u4E89\uFF0C\u8FDB\u5165\u9501\u81A8\u80C0\u8FC7\u7A0B</p></li><li><p>\u5982\u679C\u662F\u81EA\u5DF1\u6267\u884C\u4E86synchronized\u9501\u91CD\u5165\uFF0C\u90A3\u4E48\u518D\u6DFB\u52A0\u4E00\u6761Lock Record\u4F5C\u4E3A\u91CD\u5165\u7684\u8BA1\u6570\u3002</p><p>\u4F46\u662F\u8FD9\u79CD\u5931\u8D25\u6CA1\u5173\u7CFB\uFF0C\u56E0\u4E3A\u662F<strong>\u540C\u4E00\u4E2A\u7EBF\u7A0B\u53C8\u5BF9\u540C\u4E00\u4E2A\u5BF9\u8C61\u52A0\u9501</strong>\uFF0C\u4E5F\u4F1A\u5728\u65B0\u7684\u6808\u5E27\uFF08\u865A\u62DF\u673A\u6808\u7684\u5B58\u50A8\u5355\u4F4D\uFF09\u91CC\u521B\u5EFA\u9501\u8BB0\u5F55\uFF0C\u9501\u8BB0\u5F55\u5730\u5740\u90E8\u5206\u5B58\u4E3Anull\uFF0C\u8FD9\u79CD\u60C5\u51B5\u53EB\u505Asynchronized\u9501\u91CD\u5165</p><p><img src="'+g+'" alt="image-20210906164102507"></p></li></ul><p><strong>CAS\u64CD\u4F5C\u662F\u539F\u5B50\u6027\u7684\uFF0C\u4E0D\u4F1A\u88AB\u6253\u65AD</strong></p><p>\u603B\u7ED3\uFF1A<strong>\u540C\u4E00\u4E2A\u7EBF\u7A0B</strong>\u5BF9\u540C\u4E00\u4E2A\u5BF9\u8C61\u518D\u52A0\u9501\uFF0C\u8FD9\u79CD\u60C5\u51B5\u53EBsynchronized\u9501\u91CD\u5165</p></li><li><p>\u89E3\u9501\uFF1A</p><ul><li><p>\u5982\u679C\u6709\u53D6\u503C\u4E3Anull\u7684\u9501\u8BB0\u5F55\uFF0C\u8868\u793A\u6709\u91CD\u5165\uFF0C\u8FD9\u65F6\u91CD\u7F6E\u9501\u8BB0\u5F55\uFF0C\u8868\u793A\u91CD\u5165\u8BA1\u6570\u51CF\u4E00</p><p><img src="'+c+'" alt="image-20210906164652141"></p></li><li><p>\u5F53\u9000\u51FAsynchronized\u4EE3\u7801\u5757\u65F6\uFF0C\u9501\u8BB0\u5F55\u7684\u503C\u4E0D\u4E3Anull\uFF0C\u8FD9\u65F6\u4F7F\u7528cas\u5C06 Mark Word\u7684\u503C\u6062\u590D\u7ED9\u5BF9\u8C61\u5934</p><ul><li>\u6210\u529F\uFF0C\u5219\u89E3\u9501\u6210\u529F</li><li>\u5931\u8D25\uFF0C\u8BF4\u660E\u8F7B\u91CF\u7EA7\u9501\u8FDB\u884C\u4E86\u9501\u81A8\u80C0\u6216\u5DF2\u7ECF\u5347\u7EA7\u4E3A\u91CD\u91CF\u7EA7\u9501\uFF0C\u8FDB\u5165\u91CD\u91CF\u7EA7\u9501\u89E3\u9501\u6D41\u7A0B</li></ul></li></ul></li></ol></li></ol><h3 id="\u9501\u81A8\u80C0" tabindex="-1"><a class="header-anchor" href="#\u9501\u81A8\u80C0" aria-hidden="true">#</a> \u9501\u81A8\u80C0</h3><ol><li><p>\u5982\u679C\u5728\u5C1D\u8BD5\u52A0\u8F7B\u91CF\u7EA7\u9501\u7684\u8FC7\u7A0B\u4E2D\uFF0CCAS\u64CD\u4F5C\u65E0\u6CD5\u6210\u529F\uFF0C\u8FD9\u65F6\u4E00\u79CD\u60C5\u51B5\u5C31\u662F\u6709\u5176\u4ED6\u7EBF\u7A0B\u4E3A\u6B64\u5BF9\u8C61\u52A0\u4E0A\u4E86\u8F7B\u91CF\u7EA7\u9501\uFF08\u6709\u7ADE\u4E89\uFF09\uFF0C\u8FD9\u65F6\u9700\u8981\u8FDB\u884C\u9501\u81A8\u80C0\uFF0C\u5C06\u8F7B\u91CF\u7EA7\u9501\u53D8\u4E3A\u91CD\u91CF\u7EA7\u9501\u3002</p></li><li><p>\u9501\u81A8\u80C0\u8FC7\u7A0B</p><ul><li><p>\u5F53Thread-1\u8FDB\u884C\u8F7B\u91CF\u7EA7\u52A0\u9501\u65F6\uFF0CThread-0\u5DF2\u7ECF\u5BF9\u8BE5\u5BF9\u8C61\u52A0\u4E86\u8F7B\u91CF\u7EA7\u9501</p><p><img src="'+u+'" alt="image-20210906165418735"></p></li><li><p>\u8FD9\u65F6Thread-1\u52A0\u8F7B\u91CF\u7EA7\u9501\u5931\u8D25\uFF0C\u8FDB\u5165\u9501\u81A8\u80C0\u6D41\u7A0B</p><ul><li>\u5373\u4E3AObject\u5BF9\u8C61\u7533\u8BF7Monitor\u9501\uFF0C\u8BA9Object\u5BF9\u8C61\u6307\u5411\u91CD\u91CF\u7EA7\u9501\u5730\u5740\u3002\u5E76\u4E14Mark Word\u540E\u4E24\u4F4D\u4F1A\u53D8\u4E3A10\uFF0C\u8868\u793A\u91CD\u91CF\u7EA7\u9501\u3002</li><li>\u7136\u540E\u81EA\u5DF1\u8FDB\u5165Monitor\u7684EntryList \u8FDB\u5165\u963B\u585E\u72B6\u6001BLOCKED</li></ul><p><img src="'+m+'" alt="image-20210906165650753"></p></li><li><p>\u5F53Thread-0\u9000\u51FA\u540C\u6B65\u5757\u89E3\u9501\u65F6\uFF0C\u4F7F\u7528cas\u5C06Lock Record\u4E2DMark Word\u7684\u503C\u6062\u590D\u7ED9\u5BF9\u8C61\u5934\uFF0C\u5931\u8D25</p><p>\u8FDB\u5165\u91CD\u91CF\u7EA7\u9501\u89E3\u9501\u6D41\u7A0B\u3002\u5373\u6309\u7167Monitor\u5730\u5740\u627E\u5230Monitor\u5BF9\u8C61\uFF0C\u8BBE\u7F6EOwner\u4E3Anull\uFF0C\u5524\u9192EntryList\u4E2DBLOCKED\u7EBF\u7A0B</p></li></ul></li></ol><h3 id="\u81EA\u65CB\u4F18\u5316" tabindex="-1"><a class="header-anchor" href="#\u81EA\u65CB\u4F18\u5316" aria-hidden="true">#</a> \u81EA\u65CB\u4F18\u5316</h3><ol><li><p>\u7EBF\u7A0B\u963B\u585E\uFF0C\u90A3\u4E48\u5C31\u8981\u53D1\u751F\u4E00\u6B21\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u8FD9\u662F\u6BD4\u8F83\u8017\u8D39\u6027\u80FD\u7684\u3002</p><p>\u91CD\u91CF\u7EA7\u9501\u7ADE\u4E89\u7684\u65F6\u5019\uFF0C\u8FD8\u53EF\u4EE5\u4F7F\u7528\u81EA\u65CB\u6765\u8FDB\u884C\u4F18\u5316\uFF0C\u5982\u679C\u5F53\u524D\u7EBF\u7A0B\u81EA\u65CB\u6210\u529F\uFF08<strong>\u5373\u8FD9\u65F6\u5019\u6301\u9501\u7EBF\u7A0B\u5DF2\u7ECF\u9000\u51FA\u4E86\u540C\u6B65\u5757\uFF0C\u91CA\u653E\u4E86\u9501</strong>\uFF09\uFF0C\u8FD9\u65F6\u5F53\u524D\u7EBF\u7A0B\u5C31\u53EF\u4EE5\u907F\u514D\u963B\u585E\u3002</p><p>\u610F\u601D\u5C31\u662F\u4E0D\u7ACB\u523B\u53BBEntryList\uFF0C\u8FDB\u5165\u963B\u585E\u72B6\u6001\uFF0C\u800C\u662F\u5FAA\u73AF\u51E0\u6B21\uFF0C\u5C31\u662F\u81EA\u65CB</p></li><li><p><strong>\u81EA\u65CB\u8981\u4F7F\u7528CPU\uFF0C\u6240\u4EE5\u81EA\u65CB\u4F18\u5316\u9002\u5408\u591A\u6838CPU\uFF0C\u8FD9\u6837\u624D\u6709\u610F\u4E49\uFF0C\u5426\u5219\u5355\u6838CPU\uFF0C\u6B63\u5728\u88AB\u6301\u9501\u7EBF\u7A0B\u6240\u5360\u6709\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u7EBF\u7A0B\u81EA\u65CB\uFF0C\u5C31\u6CA1\u6709\u610F\u4E49\u3002</strong></p></li><li><p>\u5982\u679C\u6301\u9501\u7EBF\u7A0B1\u8FDF\u8FDF\u6CA1\u6709\u91CA\u653E\u9501\uFF0C\u90A3\u4E48\u7EBF\u7A0B2\u81EA\u65CB\u91CD\u8BD5\u5931\u8D25\uFF0C\u4ECD\u7136\u8FDB\u5165EntryList\uFF0C\u8FDB\u5165\u963B\u585E\u6001\u3002</p></li><li><p>\u81EA\u65CB\u4F1A\u5360\u7528CPU\u65F6\u95F4\uFF0C\u5355\u6838CPU\u81EA\u65CB\u5C31\u662F\u6D6A\u8D39\uFF0C\u591A\u6838CPU\u81EA\u65CB\u624D\u80FD\u53D1\u6325\u4F18\u52BF\u3002</p></li></ol><h3 id="\u504F\u5411\u9501" tabindex="-1"><a class="header-anchor" href="#\u504F\u5411\u9501" aria-hidden="true">#</a> \u504F\u5411\u9501</h3><ol><li><p><img src="'+y+'" alt="image-20210906171021229"></p></li><li><p><img src="'+b+'" alt="image-20210906172322150"></p></li><li><p><strong>\u504F\u5411\u9501\u7684\u8BED\u6CD5\u4ECD\u7136\u662Fsynchronized</strong></p><p>\u9ED8\u8BA4\u5F00\u542F\u504F\u5411\u9501\uFF0C\u521D\u59CB\u7EBF\u7A0BID\u662F0\uFF0C<strong>\u4E0A\u9501\u4E4B\u540E\uFF08\u52A0\u4E86synchronized\uFF09\uFF0C\u624D\u6709\u7EBF\u7A0BID</strong></p><p>\u91CA\u653E\u4E86\u9501\u4E4B\u540E\uFF0C\u5BF9\u8C61\u7684\u5BF9\u8C61\u5934\u7684Mark Word\u91CC\u7684\u7EBF\u7A0BID\u4ECD\u7136\u662F\u4E4B\u524D\u7684\u7EBF\u7A0BID\uFF0C\u8FD9\u5C31\u662F\u504F\u5411\uFF01</p></li><li><p>\u52A0\u9501\u7684\u4F18\u5148\u987A\u5E8F\u662F</p><ul><li>\u504F\u5411\u9501</li><li>\u8F7B\u91CF\u7EA7\u9501</li><li>\u91CD\u91CF\u7EA7\u9501\uFF08\u7EBF\u7A0B2\u60F3\u8FDB\u5165\u4E34\u754C\u4EE3\u7801\uFF0C\u53D1\u73B0\u9501\u5BF9\u8C61\u5DF2\u7ECF\u88AB\u7EBF\u7A0B1\u52A0\u8F7B\u91CF\u7EA7\u9501\uFF0C\u8FD9\u65F6\u5C31\u901A\u8FC7\u9501\u81A8\u80C0\uFF0C\u7ED9Object\u5BF9\u8C61\u52A0\u91CD\u91CF\u7EA7\u9501\uFF09</li></ul></li><li><p>\u504F\u5411\u9501\u7684\u64A4\u9500</p><ul><li><p><strong>\u5F53\u4E00\u4E2A\u9ED8\u8BA4\u6253\u5F00\u504F\u5411\u9501\u7684\u5BF9\u8C61\uFF0C\u8C03\u7528\u4E86hashcode()\u4E4B\u540E\uFF0C\u4F1A\u64A4\u9500\u8FD9\u4E2A\u5BF9\u8C61\u7684\u504F\u5411\u9501\u72B6\u6001\uFF0C\u56E0\u4E3A\u5982\u679C\u5F00\u4E86\u504F\u5411\u9501\uFF0C\u8981\u5B58\u7EBF\u7A0BID\u90A3\u4E9B\u6570\u636E\uFF0C\u5BF9\u8C61\u5934\u91CC\u4FBF\u5B58\u4E0D\u4E0Bhashcode\uFF0C\u6240\u4EE5\u5C31\u628A\u504F\u5411\u9501\u72B6\u6001\u5173\u95ED\u3002</strong></p><p><strong>\u8F7B\u91CF\u7EA7\u9501\u7684\u5BF9\u8C61\u7684hashcode\u4F1A\u5B58\u5728\u7EBF\u7A0B\u7684\u6808\u7684\u6808\u5E27\u91CC\u7684lock record\u7684\u9501\u8BB0\u5F55\u5730\u5740\u90E8\u5206\uFF0C\u89E3\u9501\u7684\u65F6\u5019\u4F1A\u6062\u590D\u7ED9\u5BF9\u8C61\u3002</strong></p><p><strong>\u91CD\u91CF\u7EA7\u9501\u7684\u5BF9\u8C61\u7684hashcode\u4F1A\u5B58\u5728monitor\u5BF9\u8C61\u91CC\uFF0C\u6240\u4EE5\u4E0D\u4F1A\u5F71\u54CD\u3002</strong></p></li><li><p>\u504F\u5411\u9501\u672C\u8D28\u5C31\u662F\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u5728\u4F7F\u7528\uFF0C\u7EBF\u7A0B\u591A\u4E86\u4E4B\u540E\uFF0C\u4EA7\u751F\u7ADE\u4E89\uFF0C\u9501\u81EA\u7136\u4F1A\u5347\u7EA7\u3002</p><p>\u5F53\u6709\u5176\u4ED6\u7EBF\u7A0B\u4F7F\u7528\u504F\u5411\u9501\u5BF9\u8C61\uFF08synchronized\u62EC\u53F7\u5185\u7684\u5BF9\u8C61\uFF09\u65F6\uFF0C\u4F1A\u5C06\u504F\u5411\u9501\u5347\u7EA7\u4E3A\u8F7B\u91CF\u7EA7\u9501\u3002</p><p>\u89E3\u9501\u4E4B\u540E\uFF0C\u8FD9\u4E2A\u5BF9\u8C61\u5C31\u662F\u4E0D\u5F00\u542F\u504F\u5411\u9501\u7684\u72B6\u6001</p><p>\u8FD9\u4E5F\u662F\u504F\u5411\u9501\u7684\u64A4\u9500\u3002</p></li></ul></li><li><p>\u504F\u5411\u9501\u5728jdk6\u548C7\u91CC\u662F\u9ED8\u8BA4\u542F\u7528\u7684\uFF0C\u4F46\u662F\u5B83\u5728\u5E94\u7528\u7A0B\u5E8F\u542F\u7528\u51E0\u79D2\u949F\u540E\u624D\u80FD\u751F\u6548\uFF0C\u5982\u6709\u5FC5\u8981\u53EF\u4EE5\u4F7F\u7528JVM\u53C2\u6570\u6765\u5173\u95ED\u5EF6\u8FDF\uFF1A<code>-XX:BiasedLockingStartupDelay = 0</code>\uFF0C\u5982\u679C\u786E\u5B9A\u5E94\u7528\u7A0B\u5E8F\u91CC\u6240\u6709\u7684\u9501\u901A\u5E38\u60C5\u51B5\u4E0B\u5904\u4E8E\u7ADE\u4E89\u72B6\u6001\uFF0C\u53EF\u4EE5\u901A\u8FC7JVM\u53C2\u6570\u5173\u95ED\u504F\u5411\u9501\uFF0C\u90A3\u4E48\u7A0B\u5E8F\u9ED8\u8BA4\u4F1A\u8FDB\u5165\u8F7B\u91CF\u7EA7\u9501\u72B6\u6001\u3002</p></li><li><p>\u6279\u91CF\u91CD\u504F\u5411</p><p>\u8FC7\u7A0B\uFF1A</p><p>\u5047\u5982\u9501\u5BF9\u8C61\u88AB\u4E24\u4E2A\u7EBF\u7A0B\u8BBF\u95EE\uFF0C\u4F46\u662F\u6CA1\u6709\u7ADE\u4E89\uFF0C\u8FD9\u65F6\u504F\u5411\u4E86\u7EBF\u7A0BT1\u7684\u5BF9\u8C61\u4ECD\u7136\u6709\u673A\u4F1A\u91CD\u65B0\u504F\u5411T2</p><p>\u91CD\u504F\u5411\u4F1A\u91CD\u7F6E\u5BF9\u8C61\u7684\u5BF9\u8C61\u5934\u91CC\u7684Mark Word\u7684\u7EBF\u7A0BID</p><ul><li>\u7EBF\u7A0BT1\uFF0C\u7ED9\u4E00\u4E2A\u5BF9\u8C61\u91CD\u590D\u4E0A\u9501\uFF0C\u7EBF\u7A0BT2\u8C03\u7528wait()\uFF0C\u8FDB\u5165\u963B\u585E\u6001\uFF0C\u6240\u4EE5\u6B64\u65F6\u53EA\u6709T1\u6765\u7ED9\u5BF9\u8C61\u4E0A\u9501\uFF0C\u5E76\u4E14\u5728\u4E00\u4E2A\u5FAA\u73AF\u5185\u591A\u6B21\u4E0A\u9501\uFF0C\u90A3\u4E48\u4E0A\u7684\u662F\u504F\u5411\u9501\uFF0C\u56E0\u4E3A\u6CA1\u6709\u7ADE\u4E89\uFF08\u5FAA\u73AF30\u6B21\uFF09</li><li>\u5FAA\u73AF\u5B8C\u4E4B\u540E\uFF0C\u5524\u9192T2\u7EBF\u7A0B\uFF0CT2\u7EBF\u7A0B\u8BBF\u95EE\u5BF9\u8C61\uFF0C\u6B64\u65F6\u53D1\u73B0\u5BF9\u8C61\u5DF2\u7ECF\u88AB\u4E0A\u4E86\u504F\u5411\u9501\uFF0C\u90A3\u4E48\u5C31\u5982\u4E0A\u9762\u8BF4\u7684\uFF0C\u4F1A\u8FDB\u884C\u504F\u5411\u9501\u7684\u64A4\u9500\uFF0C\u9996\u5148\u4F1A\u5C06\u504F\u5411\u9501\u5347\u7EA7\u4E3A\u8F7B\u91CF\u7EA7\u9501\uFF0C\u89E3\u9501\u4E4B\u540E\uFF0C\u8FD9\u4E2A\u5BF9\u8C61\u5C31\u662F\u4E0D\u5F00\u542F\u504F\u5411\u9501\u7684\u72B6\u6001\u5373\u64A4\u9500\u4E86\u504F\u5411\u9501</li><li>\u4E0A\u9762\u8FD9\u4E00\u6B65\u8981\u8FDB\u884C19\u6B21\uFF08\u524D19\u6B21\u7684\u5BF9\u8C61\u90FD\u5DF2\u7ECF\u53D8\u6210\u4E86\u4E0D\u53EF\u504F\u5411\u7684\u72B6\u6001\uFF09\uFF0C\u5230\u7B2C20\u6B21\u7684\u65F6\u5019\uFF0CJVM\u4F1A\u89C9\u5F97\u4E4B\u524D\u504F\u5411T1\u504F\u5411\u9519\u4E86\uFF0C\u4E8E\u662F\u5728\u7ED9\u8FD9\u4E9B\u5BF9\u8C61\u52A0\u9501\u65F6\uFF0C<strong>\u91CD\u65B0\u504F\u5411T2\u7EBF\u7A0B\u3002</strong></li></ul></li><li><p>\u6279\u91CF\u64A4\u9500</p><p>\u5F53\u64A4\u9500\u504F\u5411\u9501\u9608\u503C\u8D85\u8FC740\u6B21\u540E\uFF0CJVM\u4F1A\u89C9\u5F97\u504F\u5411\u9519\u4E86\uFF0C\u4E0D\u5E94\u8BE5\u91C7\u53D6\u504F\u5411\u9501\uFF0C<strong>\u4E8E\u662F\u6574\u4E2A\u7C7B\u7684\u6240\u6709\u5BF9\u8C61\u90FD\u4F1A\u53D8\u4E3A\u4E0D\u53EF\u504F\u5411\u7684\uFF0C\u65B0\u5EFA\u7684\u5BF9\u8C61\u4E5F\u662F\u4E0D\u53EF\u504F\u5411\u7684\u3002</strong></p></li><li><p>\u6279\u91CF\u91CD\u504F\u5411\u548C\u6279\u91CF\u64A4\u9500\uFF0C\u90FD\u662F\u5C5E\u4E8E\u4F18\u5316\u3002</p></li></ol><h3 id="\u9501\u6D88\u9664" tabindex="-1"><a class="header-anchor" href="#\u9501\u6D88\u9664" aria-hidden="true">#</a> \u9501\u6D88\u9664</h3><ol><li>\u9501\u6D88\u9664\u5F00\u5173\u662F\u9ED8\u8BA4\u6253\u5F00\u7684\uFF0CJVM\u4F1A\u81EA\u52A8\u6D88\u9664\u6389\u6CA1\u6709\u610F\u4E49\u7684\u9501</li><li>\u56E0\u4E3A\u4E0A\u9501\u548C\u89E3\u9501\u90FD\u662F\u6709\u6210\u672C\u7684\uFF0C\u800C\u4E14\u4E0A\u9501\u4F1A\u5BFC\u81F4\u6709\u7684\u7EBF\u7A0B\u83B7\u53D6\u4E0D\u5230\u9501\u8FDB\u800C\u4F1A\u5230\u963B\u585E\u72B6\u6001\uFF0C\u8FD9\u4E2A\u8FC7\u7A0B\u4F1A\u5F15\u8D77\u7EBF\u7A0B\u7684\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u4E5F\u8981\u6D88\u8017\u6210\u672C</li></ol><h2 id="wait-notify" tabindex="-1"><a class="header-anchor" href="#wait-notify" aria-hidden="true">#</a> wait-notify</h2><ol><li><p>\u88AB\u5524\u9192\u540E\u7684\u7EBF\u7A0B\uFF0C\u662F\u8FDB\u5165\u5C31\u7EEA\u72B6\u6001\uFF0C\u4E0E\u5176\u4ED6\u7EBF\u7A0B\u4E00\u8D77\u7B49\u5F85CPU\u5206\u914D\u65F6\u95F4\u7247\uFF0C\u518D\u6267\u884C\uFF0C\u800C\u4E0D\u662F\u88AB\u5524\u9192\u540E\u9A6C\u4E0A\u6267\u884C</p><p>\u88AB\u5524\u9192\u540E\u7684\u7EBF\u7A0B\u91CD\u65B0\u8FDB\u5165\u7ADE\u4E89\u9501\u7684\u961F\u5217</p></li><li><p>wait()\u3001notify()\u3001notifyAll()</p><ul><li><p>\u8FD9\u4E09\u4E2A\u65B9\u6CD5\u53EA\u80FD\u51FA\u73B0\u5728\u540C\u6B65\u4EE3\u7801\u5757\u548C\u540C\u6B65\u65B9\u6CD5\u4E2D</p></li><li><p><strong>\u4EE5\u4E0A\u8FD9\u4E09\u4E2A\u65B9\u6CD5\u7684\u8C03\u7528\u8005\u5FC5\u987B\u662F\u540C\u6B65\u4EE3\u7801\u5757\u6216\u540C\u6B65\u65B9\u6CD5\u4E2D\u7684\u540C\u6B65\u76D1\u89C6\u5668\u3002</strong></p></li><li><p>\u4EE5\u4E0A\u8FD9\u4E09\u4E2A\u65B9\u6CD5\u662F\u5B9A\u4E49\u5728<code>java.lang.Object</code>\u4E2D\u7684\u3002\u56E0\u4E3A\u540C\u6B65\u76D1\u89C6\u5668\u4EFB\u4F55\u4E00\u4E2A\u5BF9\u8C61\u90FD\u53EF\u4EE5\u5145\u5F53\uFF0C\u7ED3\u5408\u7B2C\u4E8C\u70B9\uFF0C\u4EFB\u4F55\u4E00\u4E2A\u5BF9\u8C61\u90FD\u5FC5\u987B\u80FD\u591F\u8C03\u7528\u4EE5\u4E0A\u4E09\u4E2A\u65B9\u6CD5\uFF0C\u8BF4\u660E\uFF0C\u4EFB\u4F55\u4E00\u4E2A\u5BF9\u8C61\u90FD\u6709\u8FD9\u4E09\u4E2A\u65B9\u6CD5\uFF0C\u6240\u4EE5\u8FD9\u4E09\u4E2A\u65B9\u6CD5\u662F\u58F0\u660E\u5728Object\u7C7B\u4E2D\u3002</p></li></ul></li><li><p>\u539F\u7406</p><p><img src="'+k+'" alt="image-20210906200431146"></p><ul><li><p>Owner\u7EBF\u7A0B\u53D1\u73B0\u6761\u4EF6\u4E0D\u6EE1\u8DB3\uFF0C\u8C03\u7528wait()\u65B9\u6CD5\uFF0C\u5373\u53EF\u8FDB\u5165WaitSet\u53D8\u4E3AWAITING\u72B6\u6001</p></li><li><p>BLOCKED\u548CWAITING\u7684\u7EBF\u7A0B\u90FD\u5904\u4E8E\u963B\u585E\u72B6\u6001\uFF0C\u4E0D\u5360\u7528CPU\u65F6\u95F4\u7247</p></li><li><p><strong>BLOCKED\u7EBF\u7A0B\u4F1A\u5728Owner\u7EBF\u7A0B\u91CA\u653E\u9501\u65F6\u5524\u9192</strong></p></li><li><p><strong>WAITING\u7EBF\u7A0B\u4F1A\u5728Owner\u7EBF\u7A0B\uFF08\u540C\u6B65\u76D1\u89C6\u5668\u9501\u5BF9\u8C61\uFF09\u8C03\u7528notify\u6216notifyAll\u65F6\u5524\u9192\u3002</strong></p><p>\u4F46\u662F\u5524\u9192\u540E\u5E76\u4E0D\u610F\u5473\u7740\u7ACB\u523B\u83B7\u5F97\u9501\uFF0C\u4ECD\u9700\u8FDB\u5165EntryList\uFF08BLOCKED\u7684\u5BF9\u8C61\u5728\u8FD9\u91CC\uFF09\u91CD\u65B0\u7ADE\u4E89\u3002</p></li></ul></li><li><ul><li><p>wait()\u3001join()\u662F\u8FDB\u5165waiting\u72B6\u6001</p></li><li><p>yield()\u662F\u4ECErunning\u5230runnable\u5C31\u7EEA\u72B6\u6001\uFF0C\u8BA9\u51FA\u65F6\u95F4\u7247\u4F46\u662F\u4E0D\u963B\u585E</p></li><li><p>\u65F6\u95F4\u7247\u7528\u5B8C\u4E5F\u662F\u4ECErunning\u5230runnable\u5C31\u7EEA\u72B6\u6001\uFF0C\u4E0D\u963B\u585E\uFF0C\u56DE\u5230\u5C31\u7EEA\u72B6\u6001\u7B49\u5F85\u4E0B\u4E00\u6B21\u65F6\u95F4\u7247\u5206\u914D</p></li><li><p>sleep\u662F\u5230timed_waiting\u72B6\u6001</p></li><li><p>\u7B49\u5F85\u540C\u6B65\u9501\u662F\u5230BLOCKED\u72B6\u6001\u3002</p><p><strong>\u8981\u533A\u5206WAITING\u72B6\u6001\u548CBLOCKED\u72B6\u6001\u3002</strong></p></li></ul></li><li><ul><li>WAITING\u72B6\u6001\u7684\u7EBF\u7A0B\u901A\u8FC7notify()\u6216notifyAll()\u5524\u9192\uFF0C\u5524\u9192\u540E\u7684\u7EBF\u7A0B\u4ECD\u7136\u8981\u8FDB\u5165EntryList\u961F\u5217\uFF0C\u7B49\u5F85CPU\u8D44\u6E90\u5206\u914D</li><li>BLOCKED\u72B6\u6001\u901A\u8FC7\u7EBF\u7A0B\u91CA\u653E\u9501\u5524\u9192</li></ul></li><li><p>\u9501\u548C\u65F6\u95F4\u7247\u90FD\u53EF\u4EE5\u7406\u89E3\u4E3ACPU\u7684\u8D44\u6E90</p></li><li><p>obj\u662F\u540C\u6B65\u76D1\u89C6\u5668\u9501\u5BF9\u8C61</p><ul><li>obj.wait()\u8BA9\u8FDB\u5165object\u76D1\u89C6\u5668\uFF08monitor\uFF09\u7684\u7EBF\u7A0B\u5230waitSet\u7B49\u5F85</li><li>obj.notify()\u5728object\u4E0A\u6B63\u5728waitSet\u7B49\u5F85\u7684\u7EBF\u7A0B\u4E2D\u6311\u4E00\u4E2A\u5524\u9192</li><li>obj.notifyAll()\u5728object\u4E0A\u6B63\u5728waitSet\u7B49\u5F85\u7684\u7EBF\u7A0B\u5168\u90E8\u5524\u9192</li></ul><p>\u4EE5\u4E0A\u4E09\u4E2A\u65B9\u6CD5\u90FD\u5C5E\u4E8EObject\u5BF9\u8C61\u7684\u65B9\u6CD5</p><p><strong>\u8981\u6CE8\u610F\u53EA\u6709\u5F53\u67D0\u4E2A\u7EBF\u7A0B\u83B7\u53D6\u5230\u9501\u4E4B\u540E\uFF0C\u624D\u80FD\u8C03\u7528\u4EE5\u4E0A\u8FD9\u4E09\u4E2A\u65B9\u6CD5</strong></p><p>\u6CE8\u610F\uFF0C\u8C03\u7528wait()\uFF0C\u662F\u4F7F\u672C\u7EBF\u7A0B\u8FDB\u5165\u5230WAITING\u72B6\u6001\uFF08\u963B\u585E\u72B6\u6001\uFF09</p><p>\u800C\u8C03\u7528notify\u548CnotifyAll\u662F\u5524\u9192\u522B\u7684\u7EBF\u7A0B</p></li><li><p><img src="'+C+'" alt="image-20210906204102015"></p></li></ol><h2 id="\u540C\u6B65\u6A21\u5F0F\u4E4B\u4FDD\u62A4\u6027\u6682\u505C" tabindex="-1"><a class="header-anchor" href="#\u540C\u6B65\u6A21\u5F0F\u4E4B\u4FDD\u62A4\u6027\u6682\u505C" aria-hidden="true">#</a> \u540C\u6B65\u6A21\u5F0F\u4E4B\u4FDD\u62A4\u6027\u6682\u505C</h2><ol><li>join()\u7684\u5B9E\u73B0\u91C7\u7528\u7684\u5C31\u662F\u6B64\u6A21\u5F0F\uFF0C\u4E00\u4E2A\u7EBF\u7A0B\u7B49\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u6267\u884C\u5B8C\u4E4B\u540E\u518D\u6267\u884C\u3002</li><li>join()\u4F7F\u7EBF\u7A0B\u8FDB\u5165WAITING\u72B6\u6001</li><li>\u8FD9\u79CD\u6A21\u5F0F\u662F\u5728\u4E24\u4E2A\u7EBF\u7A0B\u95F4\u4EA4\u4E92\u7ED3\u679C\u7684\u6A21\u5F0F</li><li><img src="'+_+'" alt="image-20210906211624798"></li></ol><h3 id="join\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#join\u539F\u7406" aria-hidden="true">#</a> join\u539F\u7406</h3><ol><li><p>\u4FDD\u62A4\u6027\u6682\u505C\u662F\u4E00\u4E2A\u7EBF\u7A0B\u7B49\u5F85\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u7684\u7ED3\u679C</p></li><li><p>join()\u662F\u4E00\u4E2A\u7EBF\u7A0B\u7B49\u5F85\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u7684\u7ED3\u675F</p></li><li><p>\u8BBE\u7F6E\u4E86\u6700\u5927\u7B49\u5F85\u65F6\u95F4</p><p><img src="'+f+'" alt="image-20210906221104293"></p></li></ol><h2 id="\u5F02\u6B65\u6A21\u5F0F\u4E4B\u751F\u4EA7\u8005\u6D88\u8D39\u8005\u6A21\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u5F02\u6B65\u6A21\u5F0F\u4E4B\u751F\u4EA7\u8005\u6D88\u8D39\u8005\u6A21\u5F0F" aria-hidden="true">#</a> \u5F02\u6B65\u6A21\u5F0F\u4E4B\u751F\u4EA7\u8005\u6D88\u8D39\u8005\u6A21\u5F0F</h2><ol><li>\u4E0E\u4FDD\u62A4\u6027\u6682\u505C\u6A21\u5F0F\u4E0D\u540C\uFF0C\u4E0D\u9700\u8981\u4EA7\u751F\u7ED3\u679C\u548C\u6D88\u8D39\u7ED3\u679C\u7684\u7EBF\u7A0B\u4E00\u4E00\u5BF9\u5E94\u3002</li><li>\u751F\u4EA7\u8005\u4EC5\u8D1F\u8D23\u4EA7\u751F\u7ED3\u679C\u6570\u636E\uFF0C\u4E0D\u5173\u5FC3\u6570\u636E\u8BE5\u5982\u4F55\u5904\u7406\uFF0C\u800C\u6D88\u8D39\u8005\u4E13\u5FC3\u5904\u7406\u7ED3\u679C\u6570\u636E</li><li>\u6D88\u606F\u961F\u5217\u662F\u6709\u5BB9\u91CF\u9650\u5236\u7684\uFF0C\u6EE1\u65F6\u4E0D\u4F1A\u518D\u52A0\u5165\u6570\u636E\uFF0C\u7A7A\u65F6\u4E0D\u4F1A\u518D\u6D88\u8017\u6570\u636E</li><li>\u548C\u4FDD\u62A4\u6027\u6682\u505C\u7684\u5171\u540C\u70B9\u90FD\u662F\u5904\u7406\u591A\u4E2A\u7EBF\u7A0B\u95F4\u7684\u7ED3\u679C\u7684\u4EA4\u4E92</li></ol><h2 id="park\u548Cunpark" tabindex="-1"><a class="header-anchor" href="#park\u548Cunpark" aria-hidden="true">#</a> park\u548Cunpark</h2><ol><li><p><img src="'+A+'" alt="image-20210907152327885"></p></li><li><p>\u539F\u7406\uFF1A</p><p>\u5148\u8C03\u7528park\uFF0C\u518D\u8C03\u7528unpark</p><p><img src="'+v+'" alt="image-20210907153022187"></p><p><img src="'+M+'" alt="image-20210907153037877"></p><p>\u5148\u8C03\u7528unpark\uFF0C\u518D\u8C03\u7528park</p><p><img src="'+S+'" alt="image-20210907153118988"></p></li></ol><h2 id="\u7EBF\u7A0B\u72B6\u6001\u8F6C\u6362" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u72B6\u6001\u8F6C\u6362" aria-hidden="true">#</a> \u7EBF\u7A0B\u72B6\u6001\u8F6C\u6362</h2><ol><li><p>\u60C5\u51B51 NEW---&gt; RUNNABLE</p><p>\u5F53\u8C03\u7528t.start() \u65B9\u6CD5\u65F6\uFF0C\u7531NEW ---&gt; RUNNABLE</p></li><li><p>\u60C5\u51B52 RUNNABLE ---&gt; WAITING</p><p>t\u7EBF\u7A0B\u7528synchronized(obj)\u83B7\u53D6\u4E86\u5BF9\u8C61\u9501\u540E</p><ul><li>\u8C03\u7528obj.wait() \u65B9\u6CD5\u65F6\uFF0Ct\u7EBF\u7A0B\u4ECERUNNABLE ---&gt; WAITING</li><li>\u8C03\u7528obj.notify() , obj.notifyAll(), t.interrupt() \u65F6 <ul><li>\u7ADE\u4E89\u9501\u6210\u529F\uFF0Ct\u7EBF\u7A0B\u4ECEWAITING --&gt; RUNNABLE</li><li>\u7ADE\u4E89\u9501\u5931\u8D25\uFF0C t\u7EBF\u7A0B\u4ECEWAITING ---&gt; BLOCKED</li></ul></li></ul></li><li><p>\u60C5\u51B53 RUNNABLE ---&gt; WAITING</p><ul><li><p>\u8C03\u7528t\u7EBF\u7A0B.join()\u65B9\u6CD5\uFF0C\u8981\u6CE8\u610F<strong>\u4E00\u5B9A\u4E0D\u662Ft\u7EBF\u7A0B\u4ECERUNNABLE ---&gt; WAITING</strong></p><p>\u662F\u5F53\u524D\u7EBF\u7A0B\u8FDB\u5165WAITING\u800C\u4E0D\u662Ft\u7EBF\u7A0B\uFF0C\u662F\u5F53\u524D\u7EBF\u7A0B\u7B49\u5F85t\u7EBF\u7A0B\u8FD0\u884C\u5B8C\uFF01</p><p>\u6CE8\u610F\u5F53\u524D\u7EBF\u7A0B\u662F\u5728t\u7EBF\u7A0B\u5BF9\u8C61\u7684\u76D1\u89C6\u5668\u4E0A\u7B49\u5F85\u3002</p></li><li><p>t\u7EBF\u7A0B\u8FD0\u884C\u7ED3\u675F\uFF0C\u6216\u8C03\u7528\u4E86\u5F53\u524D\u7EBF\u7A0B\u7684interrupt()\uFF0C\u4F1A\u8BA9\u5F53\u524D\u7EBF\u7A0B\u4ECEWAITING -- RUNNABLE</p></li></ul></li><li><p>\u60C5\u51B54 RUNNABLE ---&gt; WAITING</p><ul><li>\u5F53\u524D\u7EBF\u7A0B\u8C03\u7528LockSuppor.park()\u65B9\u6CD5\u4F1A\u8BA9<strong>\u5F53\u524D\u7EBF\u7A0B</strong>\u4ECERUNNABLE -- WAITING \uFF08\u4ECE\u539F\u7406\u4E0A\u5206\u6790\u8FC7\u4E86\uFF0C\u4E5F\u4E0D\u4E00\u5B9A\uFF0C\u8981\u770Bcounter\u7684\u72B6\u6001\u3002\uFF09</li><li>\u8C03\u7528LockSupport.unpark(\u76EE\u6807\u7EBF\u7A0B)\u6216\u8C03\u7528\u4E86\u7EBF\u7A0B\u7684interrupt()\uFF0C\u4F1A\u8BA9\u76EE\u6807\u7EBF\u7A0B\u4ECEWAITING -- RUNNABLE</li></ul></li><li><p>\u60C5\u51B55 RUNNABLE -- &gt; TIMED_WAITING</p><ul><li><p>Thread.sleep(long time)</p></li><li><p>obj.wait(long time)</p></li><li><p>\u5F53\u524D\u7EBF\u7A0B\u8C03\u7528t.join(long n)\u65B9\u6CD5\u65F6\uFF0C\u5F53\u524D\u7EBF\u7A0B\u4ECERUNNABLE---TIMED_WAITING,\u5F53\u524D\u7EBF\u7A0B\u7B49\u5F85t\u7EBF\u7A0B\u8FD0\u884C\u3002</p><p>\u5F53\u524D\u7EBF\u7A0B\u7B49\u5F85\u65F6\u95F4\u8D85\u8FC7\u4E86n\u6BEB\u79D2\uFF0C\u6216t\u7EBF\u7A0B\u8FD0\u884C\u7ED3\u675F\uFF0C\u6216\u8C03\u7528\u4E86\u5F53\u524D\u7EBF\u7A0B\u7684interrupt\u65F6\uFF0C\u5F53\u524D\u7EBF\u7A0B\u4ECETIMED_WAITING --- &gt; RUNNABLE</p></li></ul></li><li><p>\u60C5\u51B56 RUNNBALE -- &gt; BLOCKED</p><ul><li>t\u7EBF\u7A0B\u7528synchronized(obj)\u83B7\u53D6\u5BF9\u8C61\u9501\u65F6\uFF0C\u5982\u679C\u7ADE\u4E89\u5931\u8D25\uFF0C\u4ECERUNNABLE -- &gt; BLOCKED</li></ul></li></ol><h2 id="reentrantlock" tabindex="-1"><a class="header-anchor" href="#reentrantlock" aria-hidden="true">#</a> ReentrantLock</h2><ol><li><p>\u4F7F\u7528jconsole\u53EF\u4EE5\u68C0\u6D4B\u6B7B\u9501</p></li><li><p>\u9965\u997F\uFF0C\u4E00\u4E2A\u7EBF\u7A0B\u7531\u4E8E\u4F18\u5148\u7EA7\u592A\u4F4E\uFF0C\u59CB\u7EC8\u5F97\u4E0D\u5230CPU\u8C03\u5EA6\u6267\u884C\uFF0C\u4E5F\u4E0D\u80FD\u591F\u7ED3\u675F</p></li><li><p>\u7528ReentrantLock\u53EF\u4EE5\u89E3\u51B3\u6B7B\u9501\u548C\u9965\u997F\u73B0\u8C61\u3002</p></li><li><p>ReentrantLock\u662F\u53EF\u91CD\u5165\u9501\uFF0C\u662FJUC\u5E76\u53D1\u5DE5\u5177\u5305\u4E0B\u7684\u4E00\u4E2A\u91CD\u8981\u7684\u7C7B</p></li><li><p>\u76F8\u5BF9\u4E8Esynchronized\uFF0C\u5B83\u5177\u5907\u5982\u4E0B\u7279\u70B9\uFF1A</p><ul><li><p>\u53EF\u4E2D\u65AD\uFF08synchronized\u52A0\u4E0A\u9501\u4E4B\u540E\uFF0C\u662F\u4E0D\u53EF\u4EE5\u4E2D\u65AD\u7684\u3002\uFF09\uFF0C\u52A0\u5165\u6253\u65AD\u673A\u5236\u53EF\u4EE5\u9632\u6B62\u7EBF\u7A0B\u7B49\u5F85\u9501\u65F6\u65E0\u9650\u5236\u5730\u7B49\u5F85\u4E0B\u53BB\u3002\u4E3A\u4E86\u907F\u514D\u6B7B\u7B49\u3002</p><p><code>lock.lockInterruptibly()</code></p></li><li><p>\u53EF\u4EE5\u8BBE\u7F6E\u8D85\u65F6\u65F6\u95F4\uFF08\u89C4\u5B9A\u65F6\u95F4\u5185\uFF0C\u5982\u679C\u83B7\u53D6\u4E0D\u5230\u9501\uFF0C\u5C31\u653E\u5F03\u4E89\u8FD9\u4E2A\u9501\u4E86\uFF0C\u53BB\u6267\u884C\u4E00\u4E9B\u5176\u4ED6\u7684\u903B\u8F91\uFF09\uFF0C\u4E5F\u662F\u9632\u6B62\u7EBF\u7A0B\u56E0\u4E3A\u7B49\u5F85\u9501\u8FDB\u5165\u963B\u585E\u72B6\u6001\u65F6\uFF0C\u9632\u6B62\u7EBF\u7A0B\u65E0\u9650\u5236\u5730\u7B49\u5F85\u4E0B\u53BB\u3002\u4E00\u5B9A\u65F6\u95F4\u4E4B\u540E\uFF0C\u5C31\u4E0D\u518D\u963B\u585E\u4E86\uFF0C\u4E0D\u518D\u65E0\u9650\u5236\u5730\u7B49\u5F85\u4E0B\u53BB\u3002</p><p><code>lock.tryLock()</code></p><p>\u8FD9\u79CD\u65B9\u5F0F\u540C\u6837\u652F\u6301\u6253\u65AD\u3002\u62EC\u53F7\u91CC\u53EF\u4EE5\u586B\u5165\u65F6\u95F4\u53C2\u6570\uFF0C\u8868\u793A\u7B49\u5F85\u591A\u957F\u65F6\u95F4\uFF0C\u5982\u679C\u8FD9\u6BB5\u65F6\u95F4\u6CA1\u6709\u83B7\u53D6\u5230\u9501\uFF0C\u90A3\u4E48\u5C31\u4E0D\u4F1A\u518D\u7EE7\u7EED\u7B49\u5F85\u3002</p><p>\u7528tryLock()\u53EF\u4EE5\u89E3\u51B3\u54F2\u5B66\u5BB6\u5C31\u9910\u95EE\u9898</p></li><li><p>\u53EF\u4EE5\u8BBE\u7F6E\u4E3A\u516C\u5E73\u9501\uFF08\u9632\u6B62\u7EBF\u7A0B\u9965\u997F\u7684\u60C5\u51B5\uFF09</p><p>ReentrantLock\u9ED8\u8BA4\u662F\u4E0D\u516C\u5E73\u7684</p></li><li><p><strong>\u652F\u6301\u591A\u4E2A\u6761\u4EF6\u53D8\u91CF</strong>\u3002\uFF08\u4E0D\u50CFsynchronized\u53EA\u6709\u4E00\u4E2AwaitSet\uFF0C\u6BD4\u5982\u8981\u7528notifyAll\u53EB\u9192\u7EBF\u7A0B\uFF0C\u4F1A\u628A\u7B49\u5F85\u7684\u7EBF\u7A0B\u90FD\u53EB\u9192\uFF0C\u800CReentrantLock\u53EF\u4EE5\u5BF9waitSet\u8FDB\u884C\u7EC6\u5206\uFF0C\u76F8\u5F53\u4E8E\u8FD9\u4E2A\u610F\u601D\uFF09</p></li><li><p>\u4E0Esynchronized\u4E00\u6837\uFF0C\u90FD\u652F\u6301\u53EF\u91CD\u5165\u3002</p></li></ul></li><li><p>\u53EF\u91CD\u5165---\u540C\u4E00\u4E2A\u7EBF\u7A0B\u5BF9\u540C\u4E00\u4E2A\u9501\u7684\u91CD\u590D\u83B7\u53D6</p><p>\u662F\u6307\u540C\u4E00\u4E2A\u7EBF\u7A0B\u5982\u679C\u9996\u6B21\u83B7\u5F97\u4E86\u8FD9\u628A\u9501\uFF0C\u90A3\u4E48\u56E0\u4E3A\u5B83\u662F\u8FD9\u628A\u9501\u7684\u62E5\u6709\u8005\uFF0C\u56E0\u6B64\u6709\u6743\u5229\u518D\u6B21\u83B7\u5F97\u8FD9\u628A\u9501\u3002</p><p>\u5982\u679C\u662F\u4E0D\u53EF\u91CD\u5165\u9501\uFF0C\u90A3\u4E48\u7B2C\u4E8C\u6B21\u83B7\u5F97\u9501\u65F6\uFF0C\u81EA\u5DF1\u4E5F\u4F1A\u88AB\u9501\u6321\u4F4F\u3002</p></li><li><p>Synchronized\u7684monitor\u9501\u662F\u4E0D\u516C\u5E73\u9501</p><p>\u8C01\u5148\u62A2\u5230\u8C01\u5C31\u62E5\u6709\u9501\uFF0C\u800C\u4E0D\u4F1A\u6309\u7167\u963B\u585E\u961F\u5217\u7684\u987A\u5E8F\u5148\u6765\u5148\u5F97\u3002\u6240\u4EE5\u662F\u4E0D\u516C\u5E73\u7684\u3002</p><p>**ReentrantLock\u9ED8\u8BA4\u662F\u4E0D\u516C\u5E73\u7684\uFF0C**\u4F46\u662F\u53EF\u4EE5\u901A\u8FC7\u6784\u9020\u65B9\u6CD5\u8BBE\u7F6E\u662F\u516C\u5E73\u8FD8\u662F\u4E0D\u516C\u5E73\u3002</p><p>\u516C\u5E73\u9501\u4E00\u822C\u6CA1\u6709\u5FC5\u8981\uFF0C\u4F1A\u964D\u4F4E\u5E76\u53D1\u5EA6</p><p>\u516C\u5E73\u9501\u662F\u6309\u7167\u7B49\u5F85\u961F\u5217\uFF0C\u5148\u5165\u5148\u5F97\u7684\u65B9\u5F0F\u5B9E\u73B0\u7684\u3002</p></li><li><p>\u516C\u5E73\u9501\u672C\u610F\u662F\u89E3\u51B3\u9965\u997F\u95EE\u9898\u7684\uFF0C\u4F46\u662F\u5B9E\u9645\u4E0A\u6CA1\u6709\u5FC5\u8981\uFF0C\u7528tryLock\u53EF\u4EE5\u89E3\u51B3\u3002</p><p>\u4E00\u822C\u90FD\u4E0D\u4F1A\u8BBE\u7F6E\u4E3A\u516C\u5E73\u9501\u3002</p></li><li><p>ReentrantLock\u9ED8\u8BA4\u662F\u4E0D\u53EF\u6253\u65AD\u7684\u3002</p></li><li><p><img src="'+T+'" alt="image-20210907164801520"></p></li></ol><p>\u548C\u4E4B\u524D\u7684wait-notify-notifyAll\u76F8\u6BD4\uFF0C\u662F\u6839\u636E\u6761\u4EF6\u53D8\u91CF\u6765\u53EB\u9192\u3002</p><p><strong>\u8C03\u7528await()\u4E4B\u524D\uFF0C\u5FC5\u987B\u83B7\u5F97\u9501\u624D\u6709\u8D44\u683C\u3002</strong>\uFF08\u548Cwait\uFF0Cnotify\uFF0CnotifyAll\u4E00\u6837\uFF09</p><p>\u6CE8\u610F\u8C03\u7528await()\u548Csignal()\u65B9\u6CD5\u7684\u5BF9\u8C61\u662FCondition\u5BF9\u8C61\u3002</p><ol start="11"><li>ReentrantLock\u7684lock()\u3001unlock()\u5FC5\u987B\u6210\u5BF9\u51FA\u73B0\uFF0C\u624B\u52A8\u89E3\u9501\uFF0C\u800Csynchronized\u5173\u952E\u5B57\u4E0D\u9700\u8981</li><li></li></ol><h3 id="\u672C\u7AE0\u5C0F\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u672C\u7AE0\u5C0F\u7ED3" aria-hidden="true">#</a> \u672C\u7AE0\u5C0F\u7ED3</h3><ol><li><p>\u540C\u6B65\u89E3\u51B3\u7684\u95EE\u9898\u548C\u4E92\u65A5\u89E3\u51B3\u7684\u95EE\u9898\u4E0D\u4E00\u6837</p><p>\u4E92\u65A5\u4E3B\u8981\u4FDD\u8BC1\u5171\u4EAB\u8D44\u6E90\u7684\u4E92\u65A5\u6548\u679C\uFF0C\u4E00\u6BB5\u4E34\u754C\u533A\u4EE3\u7801\u5728\u5728\u67D0\u4E00\u6BB5\u65F6\u95F4\u5185\u53EA\u80FD\u7531\u4E00\u4E2A\u7EBF\u7A0B\u53BB\u6267\u884C</p><p>\u800C\u540C\u6B65\u6307\u7684\u662F\u67D0\u4E2A\u7EBF\u7A0B\u62FF\u5230\u5176\u4ED6\u7EBF\u7A0B\u6267\u884C\u4EE3\u7801\u7684\u7ED3\u679C\u4E4B\u540E\u624D\u53EF\u4EE5\u88AB\u5524\u9192\u7EE7\u7EED\u8FDB\u5165\u963B\u585E\u961F\u5217\u53BB\u7ADE\u4E89\u9501\u3002\u4E5F\u5C31\u662F\u67D0\u4E2A\u7EBF\u7A0B\u9700\u8981\u8D44\u6E90\uFF0C\u4F46\u662F\u5F97\u4E0D\u5230\u8D44\u6E90\uFF0C\u4E8E\u662F\u8FDB\u5165\u963B\u585E\u961F\u5217\uFF0C\u4F46\u662F\u83B7\u5F97\u8D44\u6E90\u540E\uFF0C\u4FBF\u88AB\u5524\u9192\u8FDB\u5165\u5C31\u7EEA\u72B6\u6001\uFF0C\u4E00\u5B9A\u8981\u6CE8\u610F\uFF0C\u8FD9\u91CC\u88AB\u5524\u9192\u662F\u8FDB\u5165\u5C31\u7EEA\u72B6\u6001\u800C\u4E0D\u662F\u76F4\u63A5\u6267\u884C\uFF0C\u4ECD\u7136\u8981\u7B49\u5F85CPU\u5206\u914D\u65F6\u95F4\u7247\u3002</p></li><li><p>\u7EBF\u7A0B\u83B7\u53D6\u4E0D\u5230\u9501\uFF0C\u662F\u8FDB\u5165EntryList\u963B\u585E\u961F\u5217</p><p>\u800C\u7EBF\u7A0B\u67D0\u6837\u6761\u4EF6\u4E0D\u6EE1\u8DB3\uFF0C\u662F\u8FDB\u5165WaitSet\u4F11\u606F\u5BA4\uFF0C\u53EF\u4EE5\u8FD9\u4E48\u7406\u89E3\u3002</p><p>\u5E73\u65F6\u90FD\u628A\u9501\u548C\u7EBF\u7A0B\u9700\u8981\u83B7\u5F97\u7684\u5176\u4ED6\u8D44\u6E90\u90FD\u770B\u4F5C\u7EBF\u7A0B\u9700\u8981\u7684\u8D44\u6E90\uFF0C\u4F46\u662F\u4ECE\u7EBF\u7A0B\u5DEE\u54EA\u6837\u4E1C\u897F\u800C\u8FDB\u5165\u54EA\u79CD\u72B6\u6001\u6765\u770B\uFF0C\u9700\u8981\u628A\u9501\u548C\u7EBF\u7A0B\u9700\u8981\u7684\u67D0\u4E9B\u6761\u4EF6\u5206\u5F00</p><p>\u7EBF\u7A0B\u9700\u8981\u9501\u4F46\u662F\u6CA1\u6709\u83B7\u5F97\uFF0C\u4E8E\u662F\u8FDB\u5165BLOCKED\u72B6\u6001</p><p>\u7EBF\u7A0B\u9700\u8981\u8D44\u6E90\u4F46\u662F\u6CA1\u6709\u83B7\u5F97\uFF0C\u8FDB\u5165WAITING\u72B6\u6001\u3002</p></li><li><p>Synchronized\u548CLock\u9ED8\u8BA4\u90FD\u662F\u975E\u516C\u5E73\u7684\uFF0C\u4E0D\u8FC7ReentrantLock\u53EF\u4EE5\u8BBE\u7F6E\u516C\u5E73\u9501\u3002</p></li><li><p>Synchronized</p><ul><li>monitor\uFF0CJVM\u5C42\u9762\u7684\u91CD\u91CF\u7EA7\u9501</li><li>\u8F7B\u91CF\u7EA7\u9501</li><li>\u504F\u5411\u9501</li></ul></li><li><p>\u4E92\u65A5\u662F\u6307\u5171\u4EAB\u8D44\u6E90\u7684\u4E92\u65A5\u6548\u679C</p><p>\u540C\u6B65\u662F\u6307\u4F7F\u7528\u6761\u4EF6\u53D8\u91CFwaitSet\u6765\u8FBE\u5230\u7EBF\u7A0B\u95F4\u7684\u901A\u4FE1\u6548\u679C\u3002</p></li></ol><h2 id="\u5E76\u53D1\u4E4B\u5171\u4EAB\u6A21\u578B" tabindex="-1"><a class="header-anchor" href="#\u5E76\u53D1\u4E4B\u5171\u4EAB\u6A21\u578B" aria-hidden="true">#</a> \u5E76\u53D1\u4E4B\u5171\u4EAB\u6A21\u578B</h2><ol><li><p>JMM---Java\u5185\u5B58\u6A21\u578B</p><ul><li>\u539F\u5B50\u6027--\u4FDD\u8BC1\u6307\u4EE4\u4E0D\u4F1A\u6536\u5230\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u7684\u5207\u6362</li><li>\u53EF\u89C1\u6027--- \u4FDD\u8BC1\u6307\u4EE4\u4E0D\u4F1A\u53D7CPU\u7F13\u5B58\u7684\u5F71\u54CD</li><li>\u6709\u5E8F\u6027---\u4FDD\u8BC1\u6307\u4EE4\u4E0D\u4F1A\u53D7CPU\u6307\u4EE4\u5E76\u884C\u4F18\u5316\u7684\u5F71\u54CD</li></ul></li><li><p>JMM\u5B9A\u4E49\u4E86</p><ul><li>\u4E3B\u5B58---\u6210\u5458\u53D8\u91CF\u7B49\uFF0C\u5171\u4EAB\u6570\u636E</li><li>\u5DE5\u4F5C\u5185\u5B58----\u7EBF\u7A0B\u7684\u79C1\u6709\u6570\u636E\uFF0C\u6BD4\u5982\u5C40\u90E8\u53D8\u91CF\u7B49</li></ul></li><li><p>\u52A0\u4E86volatile\u7684\u610F\u601D\u5C31\u662F\u8BF4\u5C31\u4E0D\u80FD\u4ECE\u7F13\u5B58\u5373\u7EBF\u7A0B\u7684\u5DE5\u4F5C\u5185\u5B58\u4E2D\u8BFB\u53D6\u4E86\uFF0C\u6BCF\u6B21\u90FD\u5FC5\u987B\u4ECE\u4E3B\u5B58\u4E2D\u8BFB\u53D6\u53D8\u91CF\u7684\u6700\u65B0\u503C\u3002</p></li><li><p>volatile\u53EF\u4EE5\u7528\u6765\u4FEE\u9970\u6210\u5458\u53D8\u91CF\u548C\u9759\u6001\u6210\u5458\u53D8\u91CF</p><p>\u4E0D\u80FD\u4FEE\u9970\u5C40\u90E8\u53D8\u91CF\uFF0C\u56E0\u4E3A\u5C40\u90E8\u53D8\u91CF\u662F\u7EBF\u7A0B\u79C1\u6709\u7684\uFF0C\u4E0D\u5141\u8BB8\u5171\u4EAB\u3002</p><p>\u5B83\u53EF\u4EE5\u907F\u514D\u7EBF\u7A0B\u4ECE\u81EA\u5DF1\u7684\u5DE5\u4F5C\u7F13\u5B58\u4E2D\u67E5\u627E\u53D8\u91CF\u7684\u503C\uFF0C\u5FC5\u987B\u5230\u4E3B\u5B58\u83B7\u53D6\u5B83\u7684\u503C</p><p>\u7EBF\u7A0B\u64CD\u4F5Cvolatile\u53D8\u91CF\u90FD\u662F\u76F4\u63A5\u64CD\u4F5C\u4E3B\u5B58</p></li><li><p>\u53EF\u89C1\u6027\u5C31\u662F\u8BF4\u5F53\u70ED\u70B9\u4EE3\u7801\u7684\u53D8\u91CF\u88AB\u7F13\u5B58\u5230\u7EBF\u7A0B\u7684\u5DE5\u4F5C\u5185\u5B58\u4E2D\uFF0C\u800C\u8981\u5BF9\u67D0\u4E2A\u53D8\u91CF\u8FDB\u884C\u4FEE\u6539\uFF0C\u662F\u5728\u4E3B\u5B58\u4E2D\u8FDB\u884C\u4FEE\u6539\u3002</p><p>\u90A3\u4E48\u7EBF\u7A0B\u80FD\u4E0D\u80FD\u83B7\u53D6\u5230\u8FD9\u4E2A\u4E3B\u5B58\u4E2D\u7684\u4FEE\u6539\u7684\u53D8\u91CF\uFF0C\u8FD8\u662F\u7EE7\u7EED\u5728\u81EA\u5DF1\u7684\u5DE5\u4F5C\u7F13\u5B58\u4E2D\u627E\u8FD9\u4E2A\u53D8\u91CF\u3002</p><p>\u5C31\u662F\u8FD9\u4E2A\u4FEE\u6539\u7684\u53D8\u91CF\u5BF9\u4E8E\u7EBF\u7A0B\u662F\u5426\u53EF\u89C1\u3002</p></li><li><p>synchronized\u4E5F\u80FD\u4FDD\u8BC1\u53D8\u91CF\u7684\u53EF\u89C1\u6027\uFF0C\u4F46\u662F\u8981\u521B\u5EFAmonitor\u9501\uFF0C\u4E5F\u5C31\u662F\u540C\u6B65\u76D1\u89C6\u5668\u9501\uFF0C\u662F\u6BD4\u8F83\u91CD\u91CF\u7EA7\u7684\u64CD\u4F5C</p><p>\u4F46\u662Fvolatile\u662F\u6BD4\u8F83\u8F7B\u91CF\u7EA7\u7684</p><p>\u5982\u679C\u53EA\u662F\u8981\u4FDD\u8BC1\u53EF\u89C1\u6027\uFF0C\u90A3\u4E48\u63A8\u8350volatile</p></li><li><p>\u4E00\u4E2A\u53D8\u91CF\u52A0\u4E86volatile\u4FEE\u9970\uFF0C\u4FDD\u8BC1\u7684\u662F\u4E00\u4E2A\u7EBF\u7A0B\u5BF9volatile\u53D8\u91CF\u7684\u4FEE\u6539\uFF0C\u5BF9\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u53EF\u89C1\uFF0C<strong>\u4E0D\u80FD\u4FDD\u8BC1\u539F\u5B50\u6027</strong>\u3002\u4EC5\u7528\u5728\u4E00\u4E2A\u7EBF\u7A0B\u662F\u4FEE\u6539\u53D8\u91CF\uFF0C\u53E6\u5916\u7684\u7EBF\u7A0B\u53EA\u662F\u8BFB\u53D6\u53D8\u91CF</p></li><li><p>volatile\u53EA\u662F\u4FDD\u8BC1\u7EBF\u7A0B\u80FD\u770B\u5230\u53D8\u91CF\u7684\u6700\u65B0\u503C\uFF0C\u5E76\u4E0D\u80FD\u89E3\u51B3\u6307\u4EE4\u4EA4\u9519\uFF0C\u5373\u5E76\u4E0D\u80FD\u4FDD\u8BC1\u67D0\u6BB5\u4EE3\u7801\u7684\u539F\u5B50\u6027\u3002</p><p><strong>synchronized\u65E2\u80FD\u4FDD\u8BC1\u4EE3\u7801\u5757\u7684\u539F\u5B50\u6027\u4E5F\u80FD\u4FDD\u8BC1\u4EE3\u7801\u5757\u5185\u53D8\u91CF\u53EF\u89C1\u6027\u3002\u7F3A\u70B9\u5C31\u662F\u5C5E\u4E8E\u91CD\u91CF\u7EA7\u64CD\u4F5C\uFF0C\u6027\u80FD\u66F4\u4F4E</strong></p></li><li><p>i++\uFF0Ci--\u8FD9\u79CD\u64CD\u4F5C\uFF0C\u5728\u5B57\u8282\u7801\u6307\u4EE4\u5C42\u9762\uFF0C\u4ED6\u4EEC\u7684\u6307\u4EE4\u4E0D\u662F\u539F\u5B50\u6027\u7684\u3002\u53EF\u80FD\u4EA7\u751F\u6307\u4EE4\u4EA4\u9519\u3002</p></li><li><p>\u4E24\u4E2A\u7EBF\u7A0B\u5171\u4EAB\u67D0\u4E2A\u53D8\u91CF\uFF0Cvolatile\u5C31\u662F\u4FDD\u8BC1\u8FD9\u4E24\u4E2A\u7EBF\u7A0B\u5BF9\u8FD9\u4E2A\u53D8\u91CF\u7684\u53EF\u89C1\u6027\uFF0C\u5373\u4FEE\u6539\u4E86\u4E4B\u540E\u7EBF\u7A0B\u4E5F\u80FD\u83B7\u5F97\u8FD9\u4E2A\u53D8\u91CF\u7684\u6700\u65B0\u503C\u3002\u800C\u4E0D\u662F\u83B7\u5F97\u4E4B\u524D\u7EBF\u7A0B\u7684\u5DE5\u4F5C\u5185\u5B58\uFF08\u7F13\u5B58\uFF09\u7684\u53D8\u91CF\u7684\u503C\u3002</p></li></ol><h2 id="\u6307\u4EE4\u91CD\u6392\u5E8F\u4F18\u5316" tabindex="-1"><a class="header-anchor" href="#\u6307\u4EE4\u91CD\u6392\u5E8F\u4F18\u5316" aria-hidden="true">#</a> \u6307\u4EE4\u91CD\u6392\u5E8F\u4F18\u5316</h2><ol><li><strong>\u5728\u4E0D\u6539\u53D8\u7A0B\u5E8F\u7ED3\u679C\u7684\u524D\u63D0\u4E0B</strong>\uFF0C\u8FD9\u4E9B\u6307\u4EE4\u7684\u5404\u4E2A\u9636\u6BB5\u53EF\u4EE5\u901A\u8FC7\u91CD\u6392\u5E8F\u548C\u7EC4\u5408\u6765\u5B9E\u73B0\u6307\u4EE4\u7EA7\u5C42\u9762\u7684\u5E76\u884C\u3002</li><li>CPU\u5728\u67D0\u4E00\u523B\u6267\u884C\u591A\u6761\u6307\u4EE4\u7684\u4E0D\u540C\u9636\u6BB5\uFF0C\u4E0D\u6539\u53D8\u7A0B\u5E8F\u7ED3\u679C\u3002</li><li>\u5982\u679C\u4E0B\u4E00\u6761\u6307\u4EE4\u4F9D\u8D56\u4E0A\u4E00\u6761\u6307\u4EE4\u7684\u7ED3\u679C\uFF0C\u90A3\u4E48\u8FD9\u79CD\u60C5\u51B5\u5C31\u4E0D\u80FD\u91CD\u6392\u5E8F\u3002</li></ol><h2 id="volatile\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#volatile\u539F\u7406" aria-hidden="true">#</a> volatile\u539F\u7406</h2><ol><li><p>volatile\u7684\u5E95\u5C42\u5B9E\u73B0\u539F\u7406\u662F\u5185\u5B58\u5C4F\u969C</p></li><li><p>\u5BF9volatile\u53D8\u91CF\u7684<strong>\u5199\u6307\u4EE4\u540E</strong>\u4F1A\u52A0\u5165\u5199\u5C4F\u969C</p><p>\u5BF9volatile\u53D8\u91CF\u7684<strong>\u8BFB\u6307\u4EE4\u524D</strong>\u4F1A\u52A0\u5165\u8BFB\u5C4F\u969C</p></li><li><p><strong>\u5199\u5C4F\u969C\u4FDD\u8BC1\u5728\u8BE5\u5C4F\u969C\u4E4B\u524D\u7684\uFF0C\u5BF9\u5171\u4EAB\u53D8\u91CF\u7684\u6539\u52A8\uFF0C\u90FD\u540C\u6B65\u5230\u4E3B\u5B58\u5F53\u4E2D</strong></p><p><strong>\u8BFB\u5C4F\u969C\u4FDD\u8BC1\u5728\u8BE5\u5C4F\u969C\u4E4B\u540E\u7684\uFF0C\u5BF9\u5171\u4EAB\u53D8\u91CF\u7684\u8BFB\u53D6\uFF0C\u52A0\u8F7D\u7684\u662F\u4E3B\u5B58\u4E2D\u6700\u65B0\u6570\u636E</strong></p></li><li><p>\u5199\u5C4F\u969C\u4E4B\u524D\u7684\u4EE3\u7801\u53EF\u4EE5\u4FDD\u8BC1\u4E0D\u4F1A\u53D1\u751F\u6307\u4EE4\u91CD\u6392\uFF0C\u5C31\u662F\u5199\u5C4F\u969C\u4E4B\u524D\u7684\u4EE3\u7801\u4E0D\u4F1A\u51FA\u73B0\u5728\u5199\u5C4F\u969C\u540E\u3002</p><p>\u8BFB\u5C4F\u969C\u4F1A\u4FDD\u8BC1\u8BFB\u5C4F\u969C\u4E4B\u540E\u7684\u6307\u4EE4\u4E0D\u4F1A\u56E0\u4E3A\u6307\u4EE4\u91CD\u6392\u5E8F\u51FA\u73B0\u5728\u8BFB\u5C4F\u969C\u524D\u3002</p><p>\u5199\u5C4F\u969C\u548C\u8BFB\u5C4F\u969C\u90FD\u662F\u5BF9volatile\u4FEE\u9970\u7684\u53D8\u91CF\u8FDB\u884C\u4FEE\u6539\u548C\u8BFB\u53D6\u65F6\u9644\u5E26\u7684\u5C4F\u969C\u3002</p></li><li><p><strong>volatile\u4FDD\u8BC1\u4E86\u5171\u4EAB\u53D8\u91CF\u7684\u53EF\u89C1\u6027\u548C\u6709\u5E8F\u6027</strong>\uFF0C\u4F46\u662F\u4E0D\u80FD\u89E3\u51B3\u6307\u4EE4\u4EA4\u9519</p><p>\u6709\u5E8F\u6027\u7684\u4FDD\u8BC1\u53EA\u662F\u4FDD\u8BC1\u4E86\u672C\u7EBF\u7A0B\u5185\u76F8\u5173\u4EE3\u7801\u4E0D\u88AB\u91CD\u6392\u5E8F\uFF0C\u901A\u8FC7\u5199\u5C4F\u969C\u548C\u8BFB\u5C4F\u969C\u3002</p></li><li><p>\u997F\u6C49\u5F0F\u5355\u4F8B\u6A21\u5F0F\uFF0C\u7C7B\u52A0\u8F7D\u5C31\u4F1A\u5BFC\u81F4\u8BE5\u5355\u5B9E\u4F8B\u5BF9\u8C61\u88AB\u521B\u5EFA</p><p>\u61D2\u6C49\u5F0F\uFF0C\u7C7B\u52A0\u8F7D\u4E0D\u4F1A\u5BFC\u81F4\u8BE5\u5355\u4F8B\u5BF9\u8C61\u88AB\u521B\u5EFA\uFF0C\u800C\u662F\u9996\u6B21\u4F7F\u7528\u8BE5\u5BF9\u8C61\u65F6\u624D\u4F1A\u521B\u5EFA\u3002</p></li></ol><h2 id="\u5171\u4EAB\u6A21\u578B\u4E4B\u65E0\u9501-\u975E\u963B\u585E" tabindex="-1"><a class="header-anchor" href="#\u5171\u4EAB\u6A21\u578B\u4E4B\u65E0\u9501-\u975E\u963B\u585E" aria-hidden="true">#</a> \u5171\u4EAB\u6A21\u578B\u4E4B\u65E0\u9501\uFF08\u975E\u963B\u585E\uFF09</h2><ol><li><p>\u7BA1\u7A0B\u4E5F\u53EBmonitor\u6216\u76D1\u89C6\u5668\u9501</p><p><strong>\u662F\u60B2\u89C2\u9501</strong></p></li><li><p>CAS\u4E0Evolatile\u7ED3\u5408\u5C31\u53EF\u4EE5\u5B9E\u73B0\u65E0\u9501\u5E76\u53D1\u3002</p></li><li><p>CAS\u4E0Evolatile\u7ED3\u5408\u7684\u5DE5\u4F5C\u65B9\u5F0F</p><p><img src="'+N+'" alt="image-20210908142615745"></p><p><code>compareAndSet</code><strong>\u6BD4\u8F83\u5E76\u8BBE\u7F6E\u503C\uFF0C\u5728CPU\u7684\u6307\u4EE4\u7EA7\u522B\u6216\u8005\u8BF4\u5B57\u8282\u7801\u6307\u4EE4\u7EA7\u522B\u53EF\u4EE5\u5B9E\u73B0\u5176\u539F\u5B50\u6027\u3002</strong></p></li><li><p><img src="'+j+'" alt="image-20210908143216090"></p><p>CAS\u53EF\u80FD\u4F1A\u5931\u8D25\uFF0C\u5C31\u662F\u5982\u679Ccas\u7684\u7B2C\u4E00\u4E2A\u53C2\u6570\u7684\u503C\u548C\u8C03\u7528cas\u65B9\u6CD5\u7684\u5BF9\u8C61\u7684\u5C5E\u6027\u7684\u6700\u65B0\u503C\u4E0D\u76F8\u540C\uFF08\u4E0D\u76F8\u540C\u662F\u56E0\u4E3A\uFF0C\u5728\u83B7\u53D6\u5230\u201C\u6700\u65B0\u503C\u201D\u4E4B\u540E\uFF0C\u6267\u884C\u4E4B\u540E\u7684\u903B\u8F91\u65F6\uFF0C\u6709\u5176\u4ED6\u7684\u7EBF\u7A0B\u8FDB\u6765\u64CD\u4F5C\u8FD9\u4E2A\u5171\u4EAB\u53D8\u91CF\uFF0C\u5BFC\u81F4\u4E4B\u524D\u83B7\u53D6\u7684\u6700\u65B0\u503C\u5DF2\u7ECF\u4E0D\u662F\u6700\u65B0\u4E86\uFF09\uFF0C\u5C31\u4F1A\u5931\u8D25\uFF0C\u5931\u8D25\u4E4B\u540E\u4F1A\u7EE7\u7EED\u4E0B\u4E00\u6B21\u5FAA\u73AF\uFF0C\u7EE7\u7EED\u83B7\u5F97\u6700\u65B0\u503C\uFF0C\u518D\u6267\u884C\u4E4B\u540E\u7684\u903B\u8F91\u3002</p></li><li><p>cas\u9700\u8981volatile\u7684\u652F\u6301\uFF0Ccas\u5FC5\u987B\u501F\u52A9volatile\u624D\u80FD\u8BFB\u53D6\u5230\u5171\u4EAB\u53D8\u91CF\u7684\u6700\u65B0\u503C\u6765\u5B9E\u73B0\u6BD4\u8F83\u5E76\u4EA4\u6362\u7684\u6548\u679C\u3002</p><p>volatile\u53EF\u4EE5\u4FDD\u8BC1\u5171\u4EAB\u53D8\u91CF\u7684\u53EF\u89C1\u6027\u548C\u76F8\u5173\u4EE3\u7801\u7684\u6709\u5E8F\u6027\uFF0C\u4F46\u662F\u5B83\u4E0D\u80FD\u89E3\u51B3\u6307\u4EE4\u4EA4\u9519\u7684\u95EE\u9898\uFF0C\u5B83\u4E0D\u80FD\u4FDD\u8BC1\u4EE3\u7801\u5757\u7684\u539F\u5B50\u6027\u3002\u800CCAS\u7684\u64CD\u4F5C\u5728\u5B57\u8282\u7801\u6307\u4EE4\u5C42\u9762\u662F\u539F\u5B50\u7684\uFF0C\u4E0D\u53EF\u88AB\u6253\u65AD\u3002\u6240\u4EE5CAS\u548Cvolatile\u7ED3\u5408\u8D77\u6765\u53EF\u4EE5\u5B9E\u73B0\u65E0\u9501\u5E76\u53D1\u3002</p><p>synchronized\u5173\u952E\u5B57\u53EF\u4EE5\u4FDD\u8BC1\u4EE3\u7801\u5757\u7684\u539F\u5B50\u6027\u548C\u4EE3\u7801\u5757\u5185\u90E8\u5171\u4EAB\u53D8\u91CF\u7684\u53EF\u89C1\u6027\u3002</p><ul><li>\u539F\u5B50\u6027 -- synchronized</li><li>\u53EF\u89C1\u6027--synchronized\uFF0Cvolatile</li><li>\u6709\u5E8F\u6027---volatile</li></ul></li><li><p>cas\u662F\u6BD4\u8F83\u548C\u8BBE\u7F6E\uFF0C\u6D89\u53CA\u5230\u6BD4\u8F83\uFF0C\u6307\u7684\u5C31\u662F\u5373\u4F7F\u5931\u8D25\uFF0C\u4E0B\u4E00\u6B21\u8FDB\u53BB\u5FAA\u73AF\uFF0C\u4ECD\u7136\u80FD\u591F\u83B7\u53D6\u5230\u6700\u65B0\u503C\uFF0C\u7528\u5F53\u524D\u6700\u65B0\u503C\u6765\u8FDB\u884C\u6BD4\u8F83\uFF0C\u5373\u4F7F\u8FD9\u4E2A\u8FC7\u7A0B\u4E2D\uFF0C\u6700\u65B0\u503C\u88AB\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u6240\u4FEE\u6539\u800C\u4E0D\u662F\u6700\u65B0\u503C\uFF0C\u5728\u4E0B\u4E00\u6B21\u5FAA\u73AF\u4ECD\u7136\u80FD\u591F\u62FF\u5230\u6700\u65B0\u503C\u6BD4\u8F83\u3002\u90A3\u4E48\u8981\u4FDD\u8BC1\u6BCF\u6B21\u5FAA\u73AF\u90FD\u80FD\u62FF\u5230\u8FD9\u4E2A\u6700\u65B0\u503C\uFF0C\u5C31\u8981volatile\u7684\u914D\u5408\u3002</p></li><li><p>\u65E0\u9501\u60C5\u51B5\u4E0B\uFF0C\u5373\u4F7F\u91CD\u8BD5\u5931\u8D25\uFF0C\u7EBF\u7A0B\u59CB\u7EC8\u5728\u9AD8\u901F\u8FD0\u884C\uFF0C\u6CA1\u6709\u505C\u6B47</p><p>\u800Csynchronized\u4F1A\u8BA9\u7EBF\u7A0B\u5728\u6CA1\u6709\u83B7\u5F97\u9501\u7684\u65F6\u5019\uFF0C\u53D1\u751F\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u8FDB\u5165\u963B\u585E\u3002</p><p><img src="'+L+'" alt="image-20210908144636043"></p><p>\u65E0\u9501\u72B6\u6001\u4E5F\u53EF\u80FD\u4F1A\u6709\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u53EA\u4E0D\u8FC7\u8FD9\u91CC\u4E0D\u662F\u8FDB\u5165\u963B\u585E\u72B6\u6001\uFF0C\u800C\u662F\u56E0\u4E3A\u6CA1\u6709\u5206\u5230\u65F6\u95F4\u7247\u4ECE\u8FD0\u884C\u6001\u8FDB\u5165\u5C31\u7EEA\u72B6\u6001\uFF08\u53EF\u8FD0\u884C\u72B6\u6001\uFF09\uFF0C\u8FD8\u662F\u4F1A\u5BFC\u81F4\u4E0A\u4E0B\u6587\u5207\u6362\u3002</p></li><li><p>\u5728\u7EBF\u7A0B\u6570\u5C0F\u4E8ECPU\u6838\u5FC3\u6570\u7684\u65F6\u5019\uFF0C\u7528CAS\u662F\u975E\u5E38\u5408\u9002\u7684\u3002</p></li><li><p>CAS\u662F\u57FA\u4E8E\u4E50\u89C2\u9501\u7684\u601D\u60F3\uFF0C\u4E0D\u6015\u522B\u7684\u7EBF\u7A0B\u6765\u4FEE\u6539\u5171\u4EAB\u53D8\u91CF\uFF0C\u800Csynchronized\u662F\u62FF\u5230\u9501\uFF0C\u7981\u6B62\u5176\u4ED6\u7EBF\u7A0B\u6765\u4FEE\u6539\u5171\u4EAB\u53D8\u91CF\uFF0C\u800CCAS+volatile\u662F\u4E0D\u6015\u522B\u7684\u7EBF\u7A0B\u4FEE\u6539\u5171\u4EAB\u53D8\u91CF\uFF0C\u5927\u4E0D\u4E86\u81EA\u5DF1\u518D\u91CD\u8BD5\u51E0\u6B21\uFF0C\u7ED3\u5408volatile\u6BCF\u6B21\u90FD\u53EF\u4EE5\u4ECE\u4E3B\u5B58\u62FF\u5230\u6700\u65B0\u4FEE\u6539\u7684\u503C\uFF0C\u6765\u91CD\u8BD5\u3002</p><p>\u4E50\u89C2\u9501\u867D\u7136\u6709\u4E00\u4E2A\u201C\u9501\u201D\u5B57\uFF0C\u4F46\u662F\u5176\u5B9E\u6CA1\u6709\u4E0A\u9501</p></li><li><p>synchronized\u662F\u57FA\u4E8E\u60B2\u89C2\u9501\u7684\u601D\u60F3\uFF0C\u7981\u6B62\u5176\u4ED6\u7EBF\u7A0B\u6765\u4FEE\u6539\u5171\u4EAB\u53D8\u91CF\uFF0C\u62FF\u5230\u9501\u7684\u7EBF\u7A0B\u89E3\u5F00\u9501\uFF0C\u522B\u7684\u7EBF\u7A0B\u624D\u53EF\u4EE5\u8FDB\u6765\u3002</p></li><li><p><strong>CAS\u4FDD\u8BC1\u4E86\u539F\u5B50\u6027\uFF0Cvolatile\u4FDD\u8BC1\u4E86\u5171\u4EAB\u53D8\u91CF\u7684\u53EF\u89C1\u6027\uFF0C\u90A3\u4E48\u901A\u8FC7\u4E0D\u65AD\u91CD\u8BD5\u603B\u80FD\u62FF\u5230\u6B63\u786E\u7684\u6700\u65B0\u503C\uFF0C\u4E0D\u6015\u522B\u7684\u7EBF\u7A0B\u5BF9\u5171\u4EAB\u53D8\u91CF\u8FDB\u884C\u4FEE\u6539\uFF0C\u6240\u4EE5\u8BF4\u8FD9\u662F\u4E50\u89C2\u9501\u3002</strong></p></li><li><p>CAS\u4F53\u73B0\u7684\u662F\u65E0\u9501\u5E76\u53D1\u3001\u65E0\u963B\u585E\u5E76\u53D1\u3002\uFF08\u5F53\u7EBF\u7A0B\u6570\u5927\u4E8ECPU\u6838\u5FC3\u6570\u7684\u65F6\u5019\uFF0C\u8FD8\u662F\u53EF\u80FD\u51FA\u73B0\u7EBF\u7A0B\u7684\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u4F46\u662F\u4E0D\u4F1A\u6709\u963B\u585E\uFF0C\u8FD9\u91CC\u7684\u4E0A\u4E0B\u6587\u5207\u6362\u662F\u7EBF\u7A0B\u7531\u8FD0\u884C\u72B6\u6001\u5230\u53EF\u8FD0\u884C\u72B6\u6001\u5F15\u8D77\u7684\u3002\uFF09</p><ul><li><p>\u6CA1\u6709\u4F7F\u7528synchronized\uFF0C\u7EBF\u7A0B\u4E0D\u4F1A\u9677\u5165\u963B\u585E\uFF0C\u8FD9\u662F\u6548\u7387\u63D0\u5347\u7684\u56E0\u7D20\u4E4B\u4E00</p></li><li><p>\u4F46\u662F\u5982\u679C\u7ADE\u4E89\u6FC0\u70C8\uFF0C\u91CD\u8BD5\u5FC5\u7136\u9891\u7E41\u53D1\u751F\uFF0C\u53CD\u800C\u6548\u7387\u4F1A\u53D7\u5F71\u54CD\u3002</p></li></ul></li><li><p><code>value.compareAndSet(int expect, int update)</code></p><p>\u4F1A\u628A\u7B2C\u4E00\u4E2A\u53C2\u6570\u671F\u671B\u503C\u548Cvalue\u7684\u6700\u65B0\u503C\u505A\u5BF9\u6BD4\uFF0C\u5982\u679C\u4E00\u81F4\uFF0C\u90A3\u4E48\u53EF\u4EE5\u7528\u540E\u9762\u7684update\uFF0C\u66F4\u65B0value\uFF0C\u5982\u679C\u66F4\u65B0\u5931\u8D25\u5219\u8FD4\u56DEfalse</p></li><li><p><code>++i,i++</code>\u8FD9\u79CD\u64CD\u4F5C\u5728\u5B57\u8282\u7801\u5C42\u9762\u4E0D\u662F\u539F\u5B50\u6027\u7684\uFF0C\u6240\u4EE5\u53EF\u80FD\u4F1A\u51FA\u73B0\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\uFF0C\u5728\u5B57\u8282\u7801\u5C42\u9762\uFF0C\u4F1A\u51FA\u73B0\u6307\u4EE4\u4EA4\u9519\uFF0C\u6BD4\u5982\u591A\u4E2A\u7EBF\u7A0B\u5BF9<code>i</code>\u8FD9\u4E2A\u5171\u4EAB\u53D8\u91CF\uFF0C\u8FDB\u884C\u8FD9\u7C7B\u64CD\u4F5C\u3002</p></li><li><p>\u539F\u5B50\u6574\u578B<code>AtomicInteger</code>\u91CC\u4F1A\u7EF4\u62A4\u4E00\u4E2Avalue\u503C\uFF0C\u8FD9\u4E2Avalue\u503C\uFF0C\u5C31\u662F\u4F1A\u7528CAS\u6765\u4FDD\u8BC1\u5B83\u7684\u7EBF\u7A0B\u5B89\u5168\uFF0CCAS\u4FDD\u8BC1\u6307\u4EE4\u7684\u539F\u5B50\u6027\uFF0C\u4F46\u662F\u8FD9\u4E2Avalue\u503C\u662F\u7528\u4E86volatile\u6765\u4FEE\u9970\u4FDD\u8BC1\u4E86\u5B83\u7684\u53EF\u89C1\u6027\uFF0C\u5C31\u662F\u5B83\u6BCF\u4E00\u6B21\u4FEE\u6539\u4E4B\u540E\uFF0C\u90FD\u4FDD\u8BC1\u80FD\u5728\u4E3B\u5B58\u62FF\u5230\u6700\u65B0\u503C\u6765\u8FDB\u884C\u6BD4\u8F83\u548C\u8BBE\u7F6E\u3002</p><p><img src="'+E+'" alt="image-20210908152216836"></p></li><li><p>CAS\u5E94\u7528\u5728\u7EBF\u7A0B\u6570\u6BD4\u8F83\u5C11\u7684\u65F6\u5019\uFF0C\u6700\u597D\u662F\u4E0D\u8981\u8D85\u8FC7CPU\u6838\u5FC3\u6570\u3002</p></li><li><p><strong>AtomixStampedReference\u53EF\u4EE5\u7ED9\u539F\u5B50\u5F15\u7528\u52A0\u4E0A\u7248\u672C\u53F7\uFF0C\u8FFD\u8E2A\u539F\u5B50\u5F15\u7528\u6574\u4E2A\u7684\u53D8\u5316\u8FC7\u7A0B\uFF0C\u53EF\u4EE5\u77E5\u9053\u5F15\u7528\u53D8\u91CF\u4E2D\u9014\u88AB\u66F4\u6539\u4E86\u51E0\u6B21</strong></p><p>\u5982\u679C\u53EA\u662F\u5355\u7EAF\u5173\u5FC3\u539F\u5B50\u5F15\u7528\u53D8\u91CF\u662F\u5426\u66F4\u6539\u8FC7\uFF0C\u5C31\u7528<code>AtomicMarkableReference</code></p></li></ol><h3 id="\u539F\u5B50\u7D2F\u52A0\u5668" tabindex="-1"><a class="header-anchor" href="#\u539F\u5B50\u7D2F\u52A0\u5668" aria-hidden="true">#</a> \u539F\u5B50\u7D2F\u52A0\u5668</h3><ol><li><p>\u539F\u5B50\u7D2F\u52A0\u5668 LongAdder\u6027\u80FD\u63D0\u5347\u7684\u539F\u56E0\uFF1A</p><p>\u5728\u6709\u7ADE\u4E89\u65F6\uFF0C\u8BBE\u7F6E\u591A\u4E2A\u7D2F\u52A0\u5355\u5143\uFF0C\u6700\u540E\u5C06\u7ED3\u679C\u6C47\u603B\uFF0C\u8FD9\u6837\u4ED6\u4EEC\u5728\u7D2F\u52A0\u65F6\u64CD\u4F5C\u7684\u4E0D\u540C\u7684cell\u53D8\u91CF\uFF0C\u56E0\u6B64\u51CF\u5C11\u4E86CAS\u91CD\u8BD5\u5931\u8D25\u3002\u4ECE\u800C\u63D0\u9AD8\u4E86\u6027\u80FD\u3002</p></li></ol><h2 id="final\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#final\u539F\u7406" aria-hidden="true">#</a> final\u539F\u7406</h2><ol><li><p>final\u53D8\u91CF\u7684\u8D4B\u503C\u4E5F\u4F1A\u901A\u8FC7putfield\u6307\u4EE4\u6765\u5B8C\u6210\uFF0C\u540C\u6837\u5728\u8FD9\u6761\u6307\u4EE4\u540E\u4E5F\u4F1A\u52A0\u5165\u5199\u5C4F\u969C</p><p>\u5199\u5C4F\u969C\u5C31\u662F\u4E4B\u524D\u7684\u6307\u4EE4\u4E0D\u4F1A\u5728\u5199\u5C4F\u969C\u4E4B\u540E\u6267\u884C\uFF0C\u5199\u5C4F\u969C\u4E4B\u524D\u5BF9\u53D8\u91CF\u7684\u4FEE\u6539\u4F1A\u540C\u6B65\u5230\u4E3B\u5B58\u4E2D</p><p>\u52A0\u5165\u4E86\u5199\u5C4F\u969C\uFF0C\u4FDD\u8BC1\u5728\u5176\u4ED6\u7EBF\u7A0B\u8BFB\u5230\u5B83\u7684\u503C\u65F6\u4E0D\u4F1A\u51FA\u73B0\u4E3A0\u7684\u60C5\u51B5</p></li><li><p>\u5982\u679C\u4E00\u4E2A\u6210\u5458\u53D8\u91CF\u4E0D\u52A0final\u4FEE\u9970\uFF0C\u90A3\u4E48\u76F8\u5F53\u4E8E\u662F\u7ED9\u4E00\u4E2A\u53D8\u91CF\u8D4B\u503C\u3002\u8FD9\u4E2A\u53D8\u91CF\u5148\u8981\u9ED8\u8BA4\u8D4B\u521D\u59CB\u503C0\uFF0C\u7136\u540E\u624D\u4F1A\u663E\u5F0F\u8D4B\u503C\u3002\u5176\u4ED6\u7EBF\u7A0B\u6709\u53EF\u80FD\u4F1A\u770B\u5230\u8FD9\u4E2A0\u4ECE\u800C\u5BFC\u81F4\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002</p><p>\u5728\u7C7B\u52A0\u8F7D\u8FC7\u7A0B\u4E2D\u7684\u94FE\u63A5\u9636\u6BB5\u7684\u51C6\u5907\u9636\u6BB5\uFF0C\u4F1A\u7ED9\u6210\u5458\u53D8\u91CF\u4E2D\u7684\u9759\u6001\u5C5E\u6027\u9ED8\u8BA4\u8D4B\u521D\u59CB\u503C\uFF0C\u7136\u540E\u5728\u521D\u59CB\u5316\u9636\u6BB5\u7ED9\u5176\u663E\u5F0F\u8D4B\u503C\u3002\u8FD9\u4E2A\u51C6\u5907\u9636\u6BB5\uFF0C\u4E0D\u4F1A\u7ED9\u6210\u5458\u53D8\u91CF\u4E2D\u7684\u975E\u9759\u6001\u5C5E\u6027\u8D4B\u503C\uFF0C\u56E0\u4E3A\u975E\u9759\u6001\u5C5E\u6027\u662F\u5C5E\u4E8E\u5BF9\u8C61\u7684\u53D8\u91CF\uFF0C\u9700\u8981\u968F\u7740\u5BF9\u8C61\u7684\u521B\u5EFA\u800C\u88AB\u5206\u914D\u5728\u5806\u7A7A\u95F4\u4E2D\uFF0C\u4E5F\u4E0D\u4F1A\u7ED9final\u4FEE\u9970\u7684\u9759\u6001\u5C5E\u6027\u8D4B\u503C\uFF0C\u56E0\u4E3Afinal\u4FEE\u9970\u7684\u9759\u6001\u5C5E\u6027\u65E9\u5728\u7F16\u8BD1\u9636\u6BB5\u5C31\u4F1A\u8FDB\u884C\u8D4B\u503C\u4E86\u3002</p><p>\u7C7B\u52A0\u8F7D\u8FC7\u7A0B\u4E2D\u7684\u521D\u59CB\u5316\u9636\u6BB5\uFF0C&lt;clinit&gt;\uFF0C\u7ED9\u9759\u6001\u5C5E\u6027\u663E\u5F0F\u8D4B\u521D\u59CB\u503C\uFF0C\u6267\u884C\u9759\u6001\u4EE3\u7801\u5757\u5185\u7684\u5185\u5BB9\u3002</p></li></ol><h2 id="\u81EA\u5B9A\u4E49\u7EBF\u7A0B\u6C60" tabindex="-1"><a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u7EBF\u7A0B\u6C60" aria-hidden="true">#</a> \u81EA\u5B9A\u4E49\u7EBF\u7A0B\u6C60</h2><ol><li><p>\u6211\u4EEC\u5E94\u8BE5\u5145\u5206\u5229\u7528\u5DF2\u6709\u7EBF\u7A0B\u7684\u6F5C\u529B\uFF0C\u4E0D\u5E94\u8BE5\u6BCF\u6B21\u4E00\u6709\u4EFB\u52A1\u90FD\u65B0\u5EFA\u65B0\u7684\u7EBF\u7A0B\uFF0C\u4E0D\u7136\u7EBF\u7A0B\u5F88\u591A\uFF0C\u4F1A\u9891\u7E41\u5730\u51FA\u73B0\u4E0A\u4E0B\u6587\u5207\u6362\uFF0C\u751A\u81F3\u662F\u6B7B\u9501\uFF0C\u8FD8\u6709\u7CFB\u7EDF\u8D44\u6E90\u9650\u5236\u7684\u95EE\u9898\uFF0C\u90FD\u8BF4\u660E\u4E86\u7EBF\u7A0B\u4E0D\u662F\u8D8A\u591A\u8D8A\u597D\uFF0C\u6240\u4EE5\u8981\u5145\u5206\u5229\u7528\u5DF2\u6709\u7EBF\u7A0B\u3002</p></li><li><p>\u6BCF\u521B\u5EFA\u4E00\u4E2A\u7EBF\u7A0B\u90FD\u8981\u5360\u7528\u4E00\u5B9A\u5185\u5B58\uFF0C\u8981\u5206\u914D\u865A\u62DF\u673A\u6808\u7B49\u7EBF\u7A0B\u79C1\u6709\u7A7A\u95F4</p><p>\u5982\u679C\u521B\u5EFA\u5F88\u591A\u7EBF\u7A0B</p><ul><li>\u5BF9\u5185\u5B58\u7684\u5360\u7528\u5927\uFF0C\u4E5F\u5C31\u662F\u7CFB\u7EDF\u8D44\u6E90\u9650\u5236\u95EE\u9898</li><li>\u4E0A\u4E0B\u6587\u5207\u6362\u5BFC\u81F4\u6548\u7387\u4E0D\u9AD8</li><li>\u6B7B\u9501</li></ul></li><li><p>\u7EBF\u7A0B\u4E00\u5B9A\u4E0D\u662F\u521B\u5EFA\u5F97\u8D8A\u591A\u8D8A\u597D\u3002</p></li><li><p>\u7EBF\u7A0B\u6C60\u5C31\u662F\u521B\u5EFA\u4E00\u4E9B\u7EBF\u7A0B\uFF0C\u8BA9\u7EBF\u7A0B\u80FD\u591F\u5F97\u5230\u91CD\u590D\u7684\u5229\u7528\uFF0C\u7EBF\u7A0B\u7528\u5B8C\u4E86\uFF0C\u4E0D\u9500\u6BC1\uFF0C\u653E\u8FDB\u7EBF\u7A0B\u6C60\u3002</p></li><li><p>\u7EBF\u7A0B\u6C60</p><ul><li>jdk\u63D0\u4F9B\u7684\u529F\u80FD\u5B8C\u5907\u7684\u7EBF\u7A0B\u6C60</li><li>\u81EA\u5B9A\u4E49\u7EBF\u7A0B\u6C60</li></ul></li><li><p>\u81EA\u5B9A\u4E49\u7EBF\u7A0B\u6C60\u5206\u6210\u4EE5\u4E0B\u7EC4\u4EF6</p><ul><li>\u7EBF\u7A0B\u6C60\uFF0C\u91CC\u9762\u6709\u53EF\u91CD\u7528\u7684\u7EBF\u7A0B</li><li>\u963B\u585E\u961F\u5217\uFF0C\u5E73\u8861\u751F\u4EA7\u8005\u7EBF\u7A0B\u3001\u6D88\u8D39\u8005\u7EBF\u7A0B\u901F\u5EA6\u5DEE\u5F02\u7684\u7EC4\u4EF6</li><li>\u7EBF\u7A0B\u7684\u751F\u4EA7\u8005</li></ul><p><img src="'+x+'" alt="image-20210908183204652"></p></li></ol><h2 id="jdk\u5B9A\u4E49\u7684\u7EBF\u7A0B\u6C60" tabindex="-1"><a class="header-anchor" href="#jdk\u5B9A\u4E49\u7684\u7EBF\u7A0B\u6C60" aria-hidden="true">#</a> jdk\u5B9A\u4E49\u7684\u7EBF\u7A0B\u6C60</h2><h3 id="\u7EBF\u7A0B\u6C60\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u6C60\u72B6\u6001" aria-hidden="true">#</a> \u7EBF\u7A0B\u6C60\u72B6\u6001</h3><ol><li><p><img src="'+R+'" alt="image-20210908205551426"></p><p>ExecutorService\u662F\u7EBF\u7A0B\u6C60\u7684\u6700\u57FA\u672C\u7684\u63A5\u53E3\uFF0C\u63D0\u4F9B\u4E86\u63D0\u4EA4\u4EFB\u52A1\uFF0C\u5173\u95ED\u7EBF\u7A0B\u6C60\u7B49\u65B9\u6CD5\u3002</p><p>ScheduledExecutorService\u65B0\u589E\u4E86\u8C03\u5EA6\u4EFB\u52A1\u7684\u529F\u80FD\uFF0C\u7528\u4E8E\u5B9A\u65F6\u6267\u884C\u4EFB\u52A1</p><p>ThreadPoolExecutor\u662F\u6700\u57FA\u7840\u7684\u5B9E\u73B0</p><p>ScheduledThreadPoolExecutor\u662F\u5E26\u6709\u4EFB\u52A1\u8C03\u5EA6\u529F\u80FD\u7684\u7EBF\u7A0B\u6C60\u5B9E\u73B0</p></li><li><p>\u8BA9\u6709\u9650\u7684\u5DE5\u4F5C\u7EBF\u7A0B\uFF08Worker Thread\uFF09\u6765\u8F6E\u6D41\u5730\u5F02\u6B65\u5730\u5904\u7406\u65E0\u9650\u591A\u7684\u4EFB\u52A1\uFF0C\u7EBF\u7A0B\u6C60\u505A\u7684\u5C31\u662F\u8FD9\u4E2A\u4E8B\u60C5\u3002</p></li><li><p>\u7EBF\u7A0B\u6C60\u72B6\u6001</p><p>ThreadPoolExecutor\u4F7F\u7528int\u7684\u9AD83\u4F4D\u6765\u8868\u793A\u7EBF\u7A0B\u6C60\u72B6\u6001\uFF0C\u4F4E29\u4F4D\u8868\u793A\u7EBF\u7A0B\u6570\u91CF</p><p><img src="'+I+'" alt="image-20210908205814692"></p><p>\u7EBF\u7A0B\u6C60\u72B6\u6001\u548C\u7EBF\u7A0B\u6570\u91CF\u5B58\u50A8\u5728\u4E00\u4E2A\u539F\u5B50\u53D8\u91CFctl\u4E2D\uFF0C\u76EE\u7684\u662F\u5C06\u7EBF\u7A0B\u6C60\u72B6\u6001\u4E0E\u7EBF\u7A0B\u4E2A\u6570\u5408\u4E8C\u4E3A\u4E00\uFF0C\u8FD9\u6837\u5C31\u53EF\u4EE5\u7528\u4E00\u6B21cas\u539F\u5B50\u64CD\u4F5C\u8FDB\u884C\u8D4B\u503C\u3002</p></li></ol><h3 id="\u6784\u9020\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u6784\u9020\u65B9\u6CD5" aria-hidden="true">#</a> \u6784\u9020\u65B9\u6CD5</h3><ol><li><p>\u7EBF\u7A0B\u6C60\u7684\u6784\u9020\u65B9\u6CD5</p><p><img src="'+U+'" alt="image-20210908210307737"></p><p><strong>\u963B\u585E\u961F\u5217\u6307\u7684\u662F\u4EFB\u52A1\u963B\u585E\u961F\u5217\u3002\u8981\u6E05\u695A\u4EFB\u52A1\u662F\u4EC0\u4E48\uFF0C\u770B\u6CDB\u578B\u5F88\u6E05\u695A\uFF0C\u91CC\u9762\u5199\u7684Runnable\uFF0CRunnable\u6216Callable\u63A5\u53E3\u7684\u5B9E\u73B0\u7C7B\u7684\u5BF9\u8C61\u5C31\u662F\u4EFB\u52A1\u5BF9\u8C61</strong></p></li></ol><h3 id="\u6838\u5FC3\u7EBF\u7A0B\u548C\u6551\u6025\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u6838\u5FC3\u7EBF\u7A0B\u548C\u6551\u6025\u7EBF\u7A0B" aria-hidden="true">#</a> \u6838\u5FC3\u7EBF\u7A0B\u548C\u6551\u6025\u7EBF\u7A0B</h3><ol><li><p>\u7EBF\u7A0B\u6C60\u4E2D\u7684\u7EBF\u7A0B\u5206\u4E3A\u4E24\u79CD</p><ul><li>\u6838\u5FC3\u7EBF\u7A0B</li><li>\u6551\u6025\u7EBF\u7A0B</li></ul><p>\u6838\u5FC3\u7EBF\u7A0B\u6570 + \u6551\u6025\u7EBF\u7A0B\u6570 = \u6700\u5927\u7EBF\u7A0B\u6570</p></li><li><p>\u6551\u6025\u7EBF\u7A0B\u7528\u4E8E\u4EFB\u52A1\u91CF\u7279\u522B\u5927\uFF0C\u4EFB\u52A1\u5982\u679C\u6CA1\u6709\u6838\u5FC3\u7EBF\u7A0B\u6765\u6267\u884C\uFF0C\u90A3\u4E48\u4F1A\u8FDB\u5165\u963B\u585E\u961F\u5217\uFF0C\u5F53\u963B\u585E\u961F\u5217\u90FD\u653E\u4E0D\u4E0B\u4E86\uFF0C\u6765\u7684\u4E0B\u4E00\u4E2A\u4EFB\u52A1\u4F1A\u4EA4\u7ED9\u6551\u6025\u7EBF\u7A0B\u53BB\u6267\u884C\u3002</p><p><img src="'+H+'" alt="image-20210908211936243"></p></li><li><p>\u6551\u6025\u7EBF\u7A0B\u548C\u6838\u5FC3\u7EBF\u7A0B\u6700\u5927\u7684\u533A\u522B\u662F\uFF1A</p><p>\u6551\u6025\u7EBF\u7A0B\u6709\u751F\u5B58\u65F6\u95F4\uFF0C\u4EFB\u52A1\u6267\u884C\u5B8C\u4E86\uFF0C\u6551\u6025\u7EBF\u7A0B\u4F1A\u9500\u6BC1\uFF0C\u4E0B\u4E00\u6B21\u9AD8\u5CF0\u671F\u6765\u4E86\uFF0C\u624D\u4F1A\u518D\u521B\u5EFA</p><p>\u6838\u5FC3\u7EBF\u7A0B\u6CA1\u6709\u751F\u5B58\u65F6\u95F4\uFF0C\u6267\u884C\u5B8C\u4EFB\u52A1\uFF0C\u4ECD\u7136\u4F1A\u4FDD\u7559\u5728\u7EBF\u7A0B\u6C60\u4E2D\u3002</p></li><li><ul><li>\u7EBF\u7A0B\u6C60\u4E2D\u521A\u5F00\u59CB\u6CA1\u6709\u7EBF\u7A0B\uFF0C\u5F53\u4E00\u4E2A\u4EFB\u52A1\u63D0\u4EA4\u7ED9\u7EBF\u7A0B\u6C60\u540E\uFF0C\u7EBF\u7A0B\u6C60\u4F1A\u521B\u5EFA\u4E00\u4E2A\u65B0\u7EBF\u7A0B\u6765\u6267\u884C\u4EFB\u52A1</li><li>\u5F53\u7EBF\u7A0B\u6570\u8FBE\u5230corePoolSize\u540E\uFF0C\u5E76\u6CA1\u6709\u7EBF\u7A0B\u7A7A\u95F2\uFF0C\u8FD9\u65F6\u518D\u52A0\u5165\u4EFB\u52A1\uFF0C\u65B0\u52A0\u7684\u4EFB\u52A1\u4F1A\u88AB\u52A0\u5165workQueue\u961F\u5217\u6392\u961F\uFF0C\u76F4\u5230\u6709\u7A7A\u95F2\u7684\u7EBF\u7A0B\u3002</li></ul></li><li><p><strong>\u5982\u679C\u7EBF\u7A0B\u6570\u8FBE\u5230maximumPoolSize\uFF0C\u4ECD\u7136\u6709\u65B0\u4EFB\u52A1\u8FD9\u65F6\u4F1A\u6267\u884C\u62D2\u7EDD\u7B56\u7565</strong>\uFF0C\u62D2\u7EDD\u7B56\u7565jdk\u63D0\u4F9B\u4E864\u79CD\u5B9E\u73B0\uFF1A</p><p><img src="'+P+'" alt="image-20210908212728493"></p><p><img src="'+O+'" alt="image-20210908212946761"></p></li><li><p>jdk\u63D0\u4F9B\u4E86Executors\u5DE5\u5177\u7C7B\uFF0C\u8FD9\u4E2A\u5DE5\u5177\u7C7B\u63D0\u4F9B\u4E86\u5F88\u591A\u5DE5\u5382\u65B9\u6CD5\u6765\u521B\u5EFA\u5404\u79CD\u7528\u9014\u7684\u7EBF\u7A0B\u6C60\uFF0C\u4F46\u662F\u5185\u90E8\u5C31\u662F\u8C03\u7528\u6784\u9020\u65B9\u6CD5\uFF0C\u4F20\u9012\u4E0D\u540C\u53C2\u6570\uFF0C\u521B\u5EFA\u7EBF\u7A0B\u6C60</p></li><li><p>\u603B\u7ED3\uFF1A</p><p>\u7EBF\u7A0B\u6570\u8FBE\u5230corePoolSize\uFF1A</p><ul><li>\u65B0\u52A0\u7684\u4EFB\u52A1\u52A0\u5165\u4EFB\u52A1\u963B\u585E\u961F\u5217\u6392\u961F\uFF0C\u76F4\u5230\u6709\u7A7A\u95F2\u7684\u7EBF\u7A0B</li><li>\u82E5\u4EFB\u52A1\u963B\u585E\u961F\u5217\u5DF2\u6EE1\uFF08\u5373\u4EFB\u52A1\u963B\u585E\u961F\u5217\u5DF2\u7ECF\u653E\u4E0D\u4E0B\u65B0\u52A0\u7684\u4EFB\u52A1\uFF09\uFF1A <ul><li>\u6551\u6025\u7EBF\u7A0B\u6765\u6267\u884C\u65B0\u52A0\u7684\u4EFB\u52A1</li><li>\u82E5\u6838\u5FC3\u7EBF\u7A0B\u6570 + \u6551\u6025\u7EBF\u7A0B\u6570 \u5373\u6700\u5927\u7EBF\u7A0B\u6570\u5DF2\u7ECF\u8FBE\u5230maximumPoolSize\uFF0C\u5982\u679C\u4ECD\u7136\u6709\u65B0\u4EFB\u52A1\uFF0C\u6267\u884C\u62D2\u7EDD\u7B56\u7565\uFF084\u79CD\uFF09</li></ul></li></ul></li></ol><h3 id="\u51E0\u79CD\u7C7B\u578B\u7684\u7EBF\u7A0B\u6C60" tabindex="-1"><a class="header-anchor" href="#\u51E0\u79CD\u7C7B\u578B\u7684\u7EBF\u7A0B\u6C60" aria-hidden="true">#</a> \u51E0\u79CD\u7C7B\u578B\u7684\u7EBF\u7A0B\u6C60</h3><ol><li><p>\u56FA\u5B9A\u5927\u5C0F\u7EBF\u7A0B\u6C60</p><p><code>newFixedThreadPool</code></p><p><img src="'+w+'" alt="image-20210908213524594"></p><p>\u7279\u70B9\uFF1A</p><ul><li><p>\u6838\u5FC3\u7EBF\u7A0B\u6570 == \u6700\u5927\u7EBF\u7A0B\u6570\uFF08<strong>\u6CA1\u6709\u6551\u6025\u7EBF\u7A0B\u88AB\u521B\u5EFA</strong>\uFF09\uFF0C\u56E0\u6B64\u4E5F\u65E0\u9700\u8D85\u65F6\u65F6\u95F4</p></li><li><p>\u963B\u585E\u961F\u5217\u662F\u65E0\u754C\u7684\uFF0C\u53EF\u4EE5\u653E\u4EFB\u610F\u6570\u91CF\u7684\u4EFB\u52A1</p><p>\u9002\u7528\u4E8E\u4EFB\u52A1\u91CF\u5DF2\u77E5\uFF0C\u76F8\u5BF9\u8017\u65F6\u7684\u4EFB\u52A1</p></li></ul></li><li><p>\u5E26\u7F13\u51B2\u7EBF\u7A0B\u6C60</p><p><code>newCachedThreadPool</code></p><p><img src="'+z+'" alt="image-20210908214251452"></p><p>\u7279\u70B9\uFF1A</p><ul><li>\u6838\u5FC3\u7EBF\u7A0B\u6570\u662F0\uFF0C\u6700\u5927\u7EBF\u7A0B\u6570\u662FInteger.MAX_VALUE\uFF0C\u6551\u6025\u7EBF\u7A0B\u7684\u7A7A\u95F2\u751F\u5B58\u65F6\u95F4\u662F60s</li><li><strong>\u5168\u90E8\u90FD\u662F\u6551\u6025\u7EBF\u7A0B\uFF0860s\u540E\u53EF\u4EE5\u56DE\u6536\uFF09</strong></li><li>\u6551\u6025\u7EBF\u7A0B\u53EF\u4EE5\u65E0\u9650\u521B\u5EFA</li></ul><p>\u9002\u7528\u4E8E\u4EFB\u52A1\u5BC6\u96C6\uFF0C\u4F46\u662F\u6BCF\u4E2A\u4EFB\u52A1\u65F6\u95F4\u90FD\u5F88\u77ED\u7684\u60C5\u51B5</p></li><li><p>\u5355\u7EBF\u7A0B\u7EBF\u7A0B\u6C60</p><p><img src="'+W+'" alt="image-20210909140256403"></p><p>\u4F7F\u7528\u573A\u666F\uFF1A</p><p>\u5E0C\u671B\u591A\u4E2A\u4EFB\u52A1\u6392\u961F\u6267\u884C\uFF0C\u7EBF\u7A0B\u6570\u56FA\u5B9A\u4E3A1\uFF0C\u4EFB\u52A1\u6570\u591A\u4E8E1\u65F6\uFF0C\u4F1A\u653E\u5165\u65E0\u754C\u961F\u5217\u6392\u961F</p><p>\u4EFB\u52A1\u6267\u884C\u5B8C\u6BD5\uFF0C\u8FD9\u552F\u4E00\u7684\u7EBF\u7A0B\u4E5F\u4E0D\u4F1A\u91CA\u653E\u3002</p><p><strong>\u53EA\u6709\u4E00\u4E2A\u6838\u5FC3\u7EBF\u7A0B\uFF0C\u6CA1\u6709\u6551\u6025\u7EBF\u7A0B</strong></p><p>\u533A\u522B\uFF1A</p><p>\u81EA\u5DF1\u521B\u5EFA\u4E00\u4E2A\u5355\u7EBF\u7A0B\u4E32\u884C\u6267\u884C\u4EFB\u52A1\uFF0C\u5982\u8FC7\u4EFB\u52A1\u6267\u884C\u5931\u8D25\u800C\u7EC8\u6B62\u6CA1\u6709\u4EFB\u4F55\u8865\u6551\u63AA\u65BD\uFF0C\u800C\u7EBF\u7A0B\u6C60\u8FD8\u4F1A\u65B0\u5EFA\u4E00\u4E2A\u7EBF\u7A0B\uFF0C\u4FDD\u8BC1\u7EBF\u7A0B\u6C60\u7684\u6B63\u5E38\u5DE5\u4F5C</p><p><img src="'+D+'" alt="image-20210909141045584"></p><p>\u5355\u7EBF\u7A0B\u6267\u884C\u5668\u8FD4\u56DE\u7684\u662F\u5305\u88C5\u540E\u7684\u5BF9\u8C61\uFF0C\u6838\u5FC3\u7EBF\u7A0B\u6570\u5927\u5C0F\u4E0D\u80FD\u4FEE\u6539\u3002</p></li></ol><h3 id="\u63D0\u4EA4\u4EFB\u52A1" tabindex="-1"><a class="header-anchor" href="#\u63D0\u4EA4\u4EFB\u52A1" aria-hidden="true">#</a> \u63D0\u4EA4\u4EFB\u52A1</h3><ol><li><p>\u63D0\u4EA4\u4EFB\u52A1</p><p><img src="'+J+'" alt="image-20210909141325138"></p><ul><li><p><code>submit</code></p><p>Future\u7528\u7684\u5C31\u662F\u4FDD\u62A4\u6027\u6682\u505C\u6A21\u5F0F\u6765\u63A5\u6536\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u8FD4\u56DE\u7684\u7ED3\u679C\u3002</p></li><li><p><code>invokeAll</code></p><p><img src="'+B+'" alt="image-20210909142412154"></p><p><img src="'+K+'" alt="image-20210909142301150"></p><p>\u610F\u601D\u5C31\u662F\u8BF4\uFF0CinvokeAll()\u65B9\u6CD5\u4F20\u5165\u7684\u53C2\u6570\u662F\u4EFB\u52A1tasks\uFF0C<strong>\u4EFB\u52A1\u7684\u672C\u8D28\u4E5F\u662F\u5B9E\u73B0Callable\u63A5\u53E3\u7684\u7C7B\u7684\u5BF9\u8C61</strong></p><p>\u800C\u521B\u5EFA\u7EBF\u7A0B\u6C60\u65F6\u6307\u5B9A\u7684\u6700\u5927\u7EBF\u7A0B\u6570\u5373\u6838\u5FC3\u7EBF\u7A0B\u6570\uFF08\u56E0\u4E3A\u91C7\u7528\u7684\u662F\u56FA\u5B9A\u5927\u5C0F\u7EBF\u7A0B\u6C60\uFF0C\u6240\u4EE5\u6CA1\u6709\u6551\u6025\u7EBF\u7A0B\uFF09\u662F2\uFF0C\u6240\u4EE5\u524D\u4E24\u4E2A\u4EFB\u52A1\uFF0C\u4E5F\u5C31\u662F\u5B9E\u73B0Callable\u63A5\u53E3\u7684\u7C7B\u7684\u5BF9\u8C61\uFF0C\uFF08\u6211\u8BA4\u4E3A\u4EFB\u52A1\u7684\u672C\u8D28\u5C31\u662F\u5B9E\u73B0Runnable\u6216Callable\u63A5\u53E3\u7684\u7C7B\u7684\u5BF9\u8C61\uFF0C<strong>\u628A\u8FD9\u4E2A\u5BF9\u8C61\uFF0C\u4F5C\u4E3A\u54EA\u4E2A\u7EBF\u7A0B\u521B\u5EFA\u7684\u6784\u9020\u51FD\u6570\u7684\u53C2\u6570\u4F20\u5165\uFF0C\u5C31\u662F\u4EFB\u52A1\u4EA4\u7ED9\u54EA\u4E2A\u7EBF\u7A0B\u6267\u884C\u3002</strong>\uFF09</p><p>\u524D\u4E24\u4E2A\u4EFB\u52A1\u88AB\u7EBF\u7A0B\u6267\u884C\u4E86\uFF0C\u7B2C\u4E09\u4E2A\u4EFB\u52A1\u8FDB\u5165\u963B\u585E\u961F\u5217\uFF0C\u524D\u4E24\u4E2A\u4EFB\u52A1\u6267\u884C\u5B8C\u540E\uFF0C\u7B2C\u4E8C\u4E2A\u7EBF\u7A0B\u5C06\u7B2C\u4E09\u4E2A\u4EFB\u52A1\u53D6\u51FA\u6267\u884C\u3002</p><p><strong>\u4EFB\u52A1\u5C31\u662F\u5B9E\u73B0Runnable\u63A5\u53E3\u6216Callable\u63A5\u53E3\u7684\u5B9E\u73B0\u7C7B\u7684\u5BF9\u8C61</strong></p><p><strong>\u600E\u4E48\u628A\u4EFB\u52A1\u4EA4\u7ED9\u67D0\u4E2A\u7EBF\u7A0B\u6267\u884C\u5462\uFF1F\u6211\u4EEC\u4E4B\u524D\u8BF4\u628A\u4EFB\u52A1\u548C\u7EBF\u7A0B\u5206\u5F00\uFF0C\u5C31\u662F\u91C7\u7528\u7684\u5B9E\u73B0Runnable\u6216Callable\u63A5\u53E3\u7684\u65B9\u5F0F\uFF0C\u90A3\u4E48\u8FD9\u91CC\u540C\u6837\uFF0C\u628A\u4EFB\u52A1\u4EA4\u7ED9\u67D0\u4E2A\u7EBF\u7A0B\u6267\u884C\uFF0C\u5C31\u76F8\u5F53\u4E8E\u628A\u5B9E\u73B0Runnable\u6216Callable\u63A5\u53E3\u7684\u5BF9\u8C61\uFF0C\u4F5C\u4E3A\u521B\u5EFA\u7EBF\u7A0B\u7684\u6784\u9020\u51FD\u6570\u7684\u53C2\u6570\u4F20\u5165</strong></p></li><li><p><code>invokeAny</code>\uFF0C \u627E\u5230\u4E00\u4E2A\u6700\u5148\u6267\u884C\u7684\u4EFB\u52A1\uFF0C\u8FD4\u56DE\u7ED3\u679C\u4E4B\u540E\uFF0C\u5176\u4ED6\u4EFB\u52A1\u5C31\u4E0D\u6267\u884C\u4E86\u3002</p><p>\u8FD4\u56DE\u7ED3\u679C\u7C7B\u578B\u662FObject\uFF0C\u4E5F\u5C31\u662F\u8BF4\u6700\u7EC8\u53EA\u5F97\u5230\u4E00\u4E2A\u4EFB\u52A1\u7684\u7ED3\u679C\u3002</p></li></ul></li><li><p><strong>\u4EFB\u52A1\u5BF9\u8C61\uFF1A\u5B9E\u73B0Runnable\u63A5\u53E3\u6216\u5B9E\u73B0Callable\u63A5\u53E3\u7684\u5BF9\u8C61\u53EB\u505A\u4EFB\u52A1\u5BF9\u8C61\uFF0C\u4EA4\u7ED9\u7EBF\u7A0B\u6267\u884C\uFF0C\u5373\u4F5C\u4E3A\u7EBF\u7A0B\u521B\u5EFA\u7684\u6784\u9020\u51FD\u6570\u7684\u53C2\u6570\u4F20\u5165</strong></p></li></ol><h3 id="\u5173\u95ED\u7EBF\u7A0B\u6C60" tabindex="-1"><a class="header-anchor" href="#\u5173\u95ED\u7EBF\u7A0B\u6C60" aria-hidden="true">#</a> \u5173\u95ED\u7EBF\u7A0B\u6C60</h3><ol><li><p><code>shutdown</code>---\u4F7F\u7EBF\u7A0B\u6C60\u72B6\u6001\u4ECERUNNING\u53D8\u4E3ASHUTDOWN</p><p>\u4E0D\u4F1A\u63A5\u6536\u65B0\u4EFB\u52A1</p><p>\u4F46\u5DF2\u63D0\u4EA4\u7684\u4EFB\u52A1\u4F1A\u6267\u884C\u5B8C\uFF0C\u4F1A\u628A\u963B\u585E\u961F\u5217\u4E2D\u7B49\u5F85\u4EFB\u52A1\u5BF9\u8C61\u6267\u884C\u5B8C\u6BD5</p><p>\u6B64\u65B9\u6CD5\u4E0D\u4F1A\u963B\u585E\u8C03\u7528\u7EBF\u7A0B\u7684\u6267\u884C\uFF0C\u6BD4\u5982\u4E3B\u7EBF\u7A0B\u8C03\u7528\u4E86shutdown\uFF0C\u4E3B\u7EBF\u7A0B\u5982\u679C\u8FD8\u6709\u5176\u4ED6\u4EE3\u7801\uFF0C\u4F1A\u7EE7\u7EED\u8FD0\u884C\u3002</p></li><li><p><code>shutdownNow</code>---\u4F7F\u7EBF\u7A0B\u6C60\u72B6\u6001\u4ECERUNNING\u53D8\u4E3ASTOP</p><p>\u4E0D\u4F1A\u63A5\u6536\u65B0\u4EFB\u52A1</p><p>\u4F1A\u629B\u5F03\u963B\u585E\u961F\u5217\u4E2D\u7684\u4EFB\u52A1\uFF08\u5176\u5B9E\u4E0D\u51C6\u786E\uFF0C\u963B\u585E\u961F\u5217\u4E2D\u6CA1\u6267\u884C\u7684\u4EFB\u52A1\u4F1A\u4F5C\u4E3A\u7ED3\u679C\u8FD4\u56DE\uFF09</p><p>\u4F1A\u7528interrupt\u7684\u65B9\u5F0F\u4E2D\u65AD\u6B63\u5728\u6267\u884C\u7684\u4EFB\u52A1</p><p>\u961F\u5217\u4E2D\u7684\u4EFB\u52A1\u4F1A\u4F5C\u4E3A\u8FD4\u56DE\u7ED3\u679C\uFF0C\u62FF\u5230\u8FD9\u4E2A\u8FD4\u56DE\u7ED3\u679C\u662F\u91CD\u65B0\u6267\u884C\uFF0C\u8FD8\u662F\u629B\u5F03\uFF0C\u7531\u4E1A\u52A1\u6765\u51B3\u5B9A\u3002</p><p><img src="'+Q+'" alt="image-20210909152652554"></p><p>\u8FD9\u91CC\u53C8\u8BC1\u660E\u4E86\uFF0CRunnable\uFF0CCallable\u63A5\u53E3\u5B9E\u73B0\u7C7B\u7684\u5BF9\u8C61\u5C31\u662F\u4EFB\u52A1\u5BF9\u8C61</p></li></ol><h3 id="\u4EFB\u52A1\u8C03\u5EA6\u7EBF\u7A0B\u6C60" tabindex="-1"><a class="header-anchor" href="#\u4EFB\u52A1\u8C03\u5EA6\u7EBF\u7A0B\u6C60" aria-hidden="true">#</a> \u4EFB\u52A1\u8C03\u5EA6\u7EBF\u7A0B\u6C60</h3><ol><li><p>\u6709\u7684\u65F6\u5019\u6211\u4EEC\u5E0C\u671B\u4EFB\u52A1<strong>\u5EF6\u65F6</strong>\u6267\u884C\uFF0C\u6216\u8005\u5E0C\u671B\u4EFB\u52A1\u6BCF\u9694\u51E0\u79D2\u5C31\u6267\u884C\u4E00\u6B21\uFF08<strong>\u5B9A\u65F6</strong>\uFF09\uFF0C\u8FD9\u79CD\u60C5\u51B5\u6211\u4EEC\u5C31\u8981\u7528\u5230\u4EFB\u52A1\u8C03\u5EA6\u7EBF\u7A0B\u6C60</p><p>\u4EFB\u52A1\u8C03\u5EA6\u7EBF\u7A0B\u6C60\u662F\u5728jdk1.5\u52A0\u5165\u3002</p></li><li><p>\u5728\u4EFB\u52A1\u8C03\u5EA6\u7EBF\u7A0B\u6C60\u52A0\u5165\u4E4B\u524D\uFF0C\u6709\u4E00\u79CD<code>java.util.Timer</code>\u6765\u5B9E\u73B0\u5B9A\u65F6\u529F\u80FD\uFF0CTimer\u7684\u4F18\u70B9\u662F\u7B80\u5355\u6613\u7528\uFF0C\u4F46\u7531\u4E8E\u6240\u6709\u7684\u5EF6\u65F6\u6216\u5B9A\u65F6\u7684\u4EFB\u52A1\u90FD\u662F\u7531<strong>\u540C\u4E00\u4E2A\u7EBF\u7A0B\u6765\u8C03\u5EA6\u6267\u884C</strong>\uFF0C\u6240\u4EE5<strong>\u6240\u6709\u7684\u4EFB\u52A1\u90FD\u662F\u4E32\u884C</strong>\u3002</p></li><li><p>Timer\u5DF2\u7ECF\u8FC7\u65F6\u4E86</p><p>Timer\u7684\u8FD9\u4E2A\u7EBF\u7A0B\u5F88\u8106\u5F31\uFF0C\u524D\u4E00\u4E2A\u4EFB\u52A1\u51FA\u73B0\u4E86\u5F02\u5E38\uFF0C\u540E\u9762\u7684\u4EFB\u52A1\u5C31\u4E0D\u80FD\u6267\u884C\u4E86\u3002</p><p>\u5E94\u8BE5\u7528\u5E26\u6709\u4EFB\u52A1\u8C03\u5EA6\u529F\u80FD\u7684\u7EBF\u7A0B\u6C60\uFF0C\u53EF\u4EE5\u8BBE\u7F6E\u7EBF\u7A0B\u6C60\u4E2D\u7EBF\u7A0B\u6570\u91CF\uFF0C\u5C31\u4E0D\u662F\u6240\u6709\u7684\u4EFB\u52A1\u90FD\u662F\u4E00\u4E2A\u7EBF\u7A0B\u6765\u6267\u884C\u4E86\u3002\uFF08\u591A\u7EBF\u7A0B\u89E3\u51B3\u4E32\u884C\uFF0C\u5B9E\u73B0\u5E76\u884C\uFF08CPU\u591A\u6838\u7684\u60C5\u51B5\u4E0B\uFF0C\u5355\u6838\u7684\u60C5\u51B5\u4E0B\u5FAE\u89C2\u4E0A\u4ECD\u662F\u4E32\u884C\uFF0C\u4E0A\u4E0B\u6587\u5207\u6362\uFF09\uFF09</p></li><li><p><img src="'+q+'" alt="image-20210909163938947"></p><p>Executors\u662F\u5DE5\u5177\u7C7B\uFF0C\u521B\u5EFA\u5404\u79CD\u7EBF\u7A0B\u6C60\uFF0C\u672C\u8D28\u4E0A\u662F\u4FEE\u6539\u6784\u9020\u65B9\u6CD5\u7684\u90A3\u4E03\u79CD\u53C2\u6570</p></li><li><p>\u6B63\u786E\u5904\u7406\u5F02\u5E38</p><ol><li>\u7B2C\u4E00\u79CD\u65B9\u5F0F\uFF0C\u81EA\u5DF1\u624B\u52A8\u5728Callable\u5B9E\u73B0\u7C7B\u590D\u5199call()\u65B9\u6CD5\u65F6\uFF0C\u6216\u5728\u5B9E\u73B0Runnable\u7C7B\u590D\u5199run()\u65F6\uFF0C\u7528try-catch\u5904\u7406</li><li>\u7B2C\u4E8C\u79CD\uFF0C\u7528\u5B9E\u73B0Callable\u63A5\u53E3\u7ED3\u5408Future\u7684\u65B9\u5F0F\u66FF\u4EE3\u5B9E\u73B0Runnable\u63A5\u53E3\u7684\u65B9\u5F0F\uFF0C\u56E0\u4E3A\u5B9E\u73B0Callable\u63A5\u53E3\u7ED3\u5408Future\u7684\u65B9\u5F0F\uFF0C\u91CD\u5199call()\u65B9\u6CD5\uFF0Ccall()\u65B9\u6CD5\u6709\u8FD4\u56DE\u503C\uFF0C\u8FD9\u4E2A\u8FD4\u56DE\u503C\uFF0C\u901A\u8FC7Future\u5BF9\u8C61\u7684get()\u65B9\u6CD5\u62FF\u5230\uFF0C\u5982\u679C\u8BF4call()\u5185\u90E8\u6709\u5F02\u5E38\uFF0C\u90A3\u4E48\u5728\u901A\u8FC7Future\u5BF9\u8C61\u7684get()\u65B9\u6CD5\u62FF\u8FD4\u56DE\u7ED3\u679C\u65F6\uFF0C\u4F1A\u5C06\u5F02\u5E38\u4FE1\u606F\u6253\u5370\u51FA\u6765\u3002</li></ol></li></ol><h2 id="fork-join\u7EBF\u7A0B\u6C60\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#fork-join\u7EBF\u7A0B\u6C60\u5B9E\u73B0" aria-hidden="true">#</a> Fork/Join\u7EBF\u7A0B\u6C60\u5B9E\u73B0</h2><ol><li><p>Fork/Join\u7EBF\u7A0B\u6C60\u662Fjdk1.7\u52A0\u5165\u7684\u65B0\u7684\u7EBF\u7A0B\u6C60\u5B9E\u73B0</p><p>\u4F53\u73B0\u7684\u5206\u6CBB\u601D\u60F3</p><p>\u9002\u7528\u4E8E\u80FD\u591F\u8FDB\u884C\u4EFB\u52A1\u62C6\u5206\u7684cpu\u5BC6\u96C6\u578B\u8FD0\u7B97</p></li><li><p>\u6240\u8C13\u4EFB\u52A1\u62C6\u5206\uFF0C\u662F\u5C06\u4E00\u4E2A\u5927\u4EFB\u52A1\u62C6\u5206\u4E3A\u7B97\u6CD5\u4E0A\u76F8\u540C\u7684\u5C0F\u4EFB\u52A1</p><p>\u8FD9\u4E9B\u5C0F\u4EFB\u52A1\u5C31\u53EF\u4EE5\u4EA4\u7ED9\u4E0D\u540C\u7684\u7EBF\u7A0B\u6765\u5B8C\u6210\uFF0C\u63D0\u5347\u8FD0\u884C\u6548\u7387</p></li><li><p>Fork\\Join\u9ED8\u8BA4\u4F1A\u521B\u5EFA\u4E0ECPU\u6838\u5FC3\u6570\u5927\u5C0F\u76F8\u540C\u7684\u7EBF\u7A0B\u6C60\u3002\uFF08\u8981\u5145\u5206\u5229\u7528CPU\uFF09</p></li><li><p>\u4F7F\u7528Fork\\Join\u7EBF\u7A0B\u6C60</p><ul><li>\u521B\u5EFA\u4EFB\u52A1\u5BF9\u8C61\uFF0C\u4E0D\u80FD\u4F7F\u7528Runnable\u6216Callable\u4EFB\u52A1\u5BF9\u8C61</li><li>\u4F7F\u7528Fork\\Join\u7EBF\u7A0B\u6C60\u6267\u884C\u4EFB\u52A1\u5BF9\u8C61</li></ul></li><li><p><img src="'+F+'" alt="image-20210909175235649"></p><p>\u5982\u679C\u662F\u65E0\u53C2\u7684\uFF0C\u90A3\u4E48\u521B\u5EFA\u7684\u7EBF\u7A0B\u6570\u5C31\u7B49\u4E8ECPU\u6838\u5FC3\u6570</p><p>\u54EA\u79CD\u7EBF\u7A0B\u6C60\u7528\u4EC0\u4E48\u65B9\u6CD5\u6765\u6267\u884C\u4EFB\u52A1\u8981\u641E\u6E05\u695A\u3002</p><p>\u6BD4\u5982\u4EFB\u52A1\u8C03\u5EA6\u7EBF\u7A0B\u6C60\u7528\u7684schedule</p><p>Fork\\Join\u7EBF\u7A0B\u6C60\u7528\u7684invoke</p></li><li><p>Future\u662F\u4E00\u4E2A\u63A5\u53E3\uFF0CFutureTask\u662F\u5B9E\u73B0\u4E86RunnableFuture\u63A5\u53E3\u7684\u5B9E\u73B0\u7C7B\uFF0CRunnableFuture\u63A5\u53E3\u7EE7\u627F\u4E8EFuture\u63A5\u53E3\u548CRunnable\u63A5\u53E3</p></li></ol><h2 id="\u5F02\u6B65\u6A21\u5F0F\u4E4B\u5DE5\u4F5C\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u5F02\u6B65\u6A21\u5F0F\u4E4B\u5DE5\u4F5C\u7EBF\u7A0B" aria-hidden="true">#</a> \u5F02\u6B65\u6A21\u5F0F\u4E4B\u5DE5\u4F5C\u7EBF\u7A0B</h2><h3 id="\u5B9A\u4E49" tabindex="-1"><a class="header-anchor" href="#\u5B9A\u4E49" aria-hidden="true">#</a> \u5B9A\u4E49</h3><ol><li><p>\u8BA9\u6709\u9650\u7684\u8D44\u6E90\u5373\u5DE5\u4F5C\u7EBF\u7A0B\u5904\u7406\u65E0\u9650\u7684\u4EFB\u52A1\uFF0C\u5178\u578B\u5B9E\u73B0\u5C31\u662F\u7EBF\u7A0B\u6C60\u3002\u800C\u4E14\u4F7F\u7528\u7EBF\u7A0B\u6C60\u53EF\u4EE5\u505A\u5230\u5C06\u7EBF\u7A0B\u91CD\u590D\u4F7F\u7528\uFF0C\u4E5F\u4E0D\u7528\u6BCF\u6B21\u65B0\u5EFA\u7EBF\u7A0B\u6216\u9500\u6BC1\u7EBF\u7A0B\uFF0C\u63D0\u9AD8\u4E86\u6548\u7387\uFF0C\u8282\u7701\u4E86\u65F6\u95F4\u6210\u672C\u3002</p><p>\u7EBF\u7A0B\u6C60\u53EF\u4EE5\u8BBE\u7F6E\u6700\u5927\u7EBF\u7A0B\u6570\u548C\u6838\u5FC3\u7EBF\u7A0B\u6570\uFF0C\u53EF\u4EE5\u901A\u8FC7\u6709\u9650\u7684\u7EBF\u7A0B\u5904\u7406\u65E0\u9650\u7684\u4EFB\u52A1\uFF0C\u4E00\u4E2A\u7EBF\u7A0B\u6267\u884C\u4E00\u4E2A\u4EFB\u52A1\u5BF9\u8C61\u5B8C\u6210\u4E4B\u540E\uFF0C\u5E76\u4E0D\u9500\u6BC1\uFF0C\u800C\u662F\u653E\u56DE\u5230\u7EBF\u7A0B\u6C60\u4E2D\uFF0C\u8FDB\u884C\u4E0B\u4E00\u4E2A\u4EFB\u52A1\u5BF9\u8C61\u7684\u6267\u884C\u3002</p><p>\u4EFB\u52A1\u5BF9\u8C61\u9664\u4E86\u4E00\u8FDB\u6765\u5C31\u80FD\u591F\u88AB\u7EBF\u7A0B\u6267\u884C\u4EE5\u5916\uFF0C\u6CA1\u6709\u80FD\u88AB\u6267\u884C\u7684\u7EBF\u7A0B\u90FD\u653E\u8FDB\u7EBF\u7A0B\u963B\u585E\u961F\u5217\u4E2D\u3002</p><p>\u4EFB\u52A1\u5BF9\u8C61\u51FA\u961F\u5217\uFF0C\u88AB\u7EBF\u7A0B\u6267\u884C\uFF0C\u662F\u8FD9\u79CD\u6D41\u7A0B\u3002</p><p>\u81EA\u5B9A\u4E49\u7EBF\u7A0B\u6C60\u7684\u65F6\u5019\u5982\u679C\u5DF2\u6709\u7EBF\u7A0B\u6570\u5C0F\u4E8E\u6700\u5927\u7EBF\u7A0B\u6570\uFF0C\u90A3\u4E48\u5C31\u521B\u5EFA\u5DE5\u4F5C\u7EBF\u7A0B</p></li><li><p>\u5BF9\u5E94\u4E8E\u4E00\u4E2A\u4E1A\u52A1\uFF0C\u4E5F\u53EF\u4EE5\u521B\u5EFA\u591A\u4E2A\u7EBF\u7A0B\u6C60\uFF0C\u4E0D\u662F\u53EA\u80FD\u6709\u4E00\u4E2A\u7EBF\u7A0B\u6C60\u3002</p></li></ol><h3 id="\u9965\u997F\u73B0\u8C61" tabindex="-1"><a class="header-anchor" href="#\u9965\u997F\u73B0\u8C61" aria-hidden="true">#</a> \u9965\u997F\u73B0\u8C61</h3><ol><li><p>\u7528\u56FA\u5B9A\u5927\u5C0F\u7684\u7EBF\u7A0B\u6C60\uFF0C\u4F1A\u6709\u9965\u997F\u73B0\u8C61\uFF0C\u7EBF\u7A0B\u6570\u4E0D\u8DB3\uFF0C\u5BFC\u81F4\u9965\u997F</p><p>\u7528\u5E26\u7F13\u51B2\u7684\u7EBF\u7A0B\u6C60\uFF0C\u4E0D\u4F1A\u6709\u9965\u997F\u73B0\u8C61</p><p>\u5355\u7EBF\u7A0B\u7EBF\u7A0B\u6C60\uFF0C\u4F1A\u6709\u9965\u997F\u73B0\u8C61\u3002</p></li><li><p>\u5BF9\u4E8E\u4E0D\u540C\u7684\u5DE5\u4F5C\u4EFB\u52A1\uFF0C\u5E94\u8BE5\u4F7F\u7528\u4E0D\u540C\u7684\u7EBF\u7A0B\u6C60\uFF0C\u6765\u907F\u514D\u9965\u997F\u73B0\u8C61\u3002</p><p>\u907F\u514D\u56E0\u4E3A\u591A\u4E2A\u7EBF\u7A0B\u90FD\u53BB\u6267\u884C\u4EFB\u52A1A\uFF0C\u800C\u6CA1\u6709\u7EBF\u7A0B\u53BB\u6267\u884C\u4EFB\u52A1B\uFF0C\u5982\u679C\u6309\u4EFB\u52A1\u6765\u5212\u5206\u4E86\u7EBF\u7A0B\u6C60\uFF0C\u90A3\u4E48\u5C31\u4E0D\u5B58\u5728\u6CA1\u6709\u7EBF\u7A0B\u53BB\u6267\u884C\u4EFB\u52A1B\u7684\u60C5\u51B5\u3002</p><p>\u8FD9\u79CD\u65B9\u5F0F\u6BD4\u5355\u7EAF\u589E\u52A0\u7EBF\u7A0B\u6C60\u7684\u5BB9\u91CF\u66F4\u4E3A\u91CD\u8981</p></li><li><p>\u7EBF\u7A0B\u6C60\u4E2D\u7684\u7EBF\u7A0B\u6570\u91CF\u8FC7\u5C0F\uFF0C\u53EF\u80FD\u4F1A\u5BFC\u81F4\u9965\u997F</p><p>\u8FC7\u5927\u7684\u8BDD\u4F1A\u5BFC\u81F4\u66F4\u591A\u7684\u7EBF\u7A0B\u4EA7\u751F\u4E0A\u4E0B\u6587\u5207\u6362\uFF08\u4E0A\u4E0B\u6587\u5207\u6362\u5BF9\u4E8ECPU\u6765\u8BF4\u662F\u4E00\u79CD\u5F00\u9500\uFF09\uFF0C\u5E76\u4E14\u6D89\u53CA\u5230\u7CFB\u7EDF\u8D44\u6E90\u4E0D\u8DB3\u7684\u95EE\u9898\uFF0C\u7EBF\u7A0B\u8FC7\u591A\u4E5F\u53EF\u80FD\u4F1A\u53D1\u751FOOM</p><ul><li><p>CPU\u5BC6\u96C6\u578B\u8FD0\u7B97</p><p>\u901A\u5E38\u91C7\u7528cpu\u6838\u6570 + 1\uFF0C\u80FD\u591F\u5B9E\u73B0\u6700\u4F18\u7684CPU\u5229\u7528\u7387\u3002</p><p>+1 \u4FDD\u8BC1\u5F53\u7EBF\u7A0B\u7531\u4E8E\u9875\u7F3A\u5931\u6545\u969C\u6216\u5176\u4ED6\u539F\u56E0\u5BFC\u81F4\u6682\u505C\u65F6\uFF0C\u989D\u5916\u7684\u8FD9\u4E2A\u7EBF\u7A0B\u80FD\u9876\u4E0A\u53BB\uFF0C\u4FDD\u8BC1CPU\u65F6\u949F\u5468\u671F\u4E0D\u88AB\u6D6A\u8D39\uFF0C\u4FDD\u8BC1CPU\u7684\u5229\u7528\u7387\u3002</p></li><li><p>IO\u5BC6\u96C6\u578B\u8FD0\u7B97</p></li></ul></li></ol><h2 id="juc" tabindex="-1"><a class="header-anchor" href="#juc" aria-hidden="true">#</a> JUC</h2><h3 id="aqs\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#aqs\u539F\u7406" aria-hidden="true">#</a> AQS\u539F\u7406</h3><ol><li><p>\u5176\u4ED6\u7684\u5E76\u53D1\u5DE5\u5177\u90FD\u662F\u4F9D\u8D56\u4E8EAQS\u7684\uFF0C\u62BD\u8C61\u7684<strong>\u57FA\u4E8E\u961F\u5217</strong>\u7684\u540C\u6B65\u5668\u3002\u662F<strong>\u963B\u585E\u5F0F\u9501</strong>\u548C\u76F8\u5173\u7684\u540C\u6B65\u5668\u5DE5\u5177\u7684\u6846\u67B6</p><p>Synchronized\u9501\u5C31\u662F\u963B\u585E\u5F0F\u7684\u9501\uFF0CCAS+volatile\u5C31\u662F\u5B9E\u73B0\u7684\u65E0\u9501\u5E76\u53D1\uFF0C\u662F\u4E50\u89C2\u9501\uFF0C\u7EBF\u7A0B\u4E0D\u963B\u585E\u3002</p><p>\u4F46\u662FAQS\u5E76\u4E0D\u662FSynchronized\u7684\u539F\u7406\uFF0C\u800C\u662FReentrantLock\u7684\u5B9E\u73B0\u539F\u7406\uFF0CReentrantLock\u662F\u963B\u585E\u5F0F\u9501</p><p>Synchronized\u7684\u5B9E\u73B0\u539F\u7406\u662FMonitor\uFF0C\u662FJVM\u5C42\u9762\u7684\uFF0C\u5E95\u5C42\u662F\u7528C++\u6765\u5B9E\u73B0\u7684\u3002</p></li><li><p>AQS ---- AbstractQueuedSynchronizer\uFF0C\u662F\u4E00\u4E2A\u62BD\u8C61\u7C7B\uFF0C\u62BD\u8C61\u7684\u57FA\u4E8E\u961F\u5217\u7684\u540C\u6B65\u5668</p></li><li><p>AQS\u7684\u4F7F\u7528\u65B9\u5F0F\u901A\u5E38\u90FD\u662F<strong>\u901A\u8FC7\u5185\u90E8\u7C7B</strong>\u7EE7\u627FAQS\u5B9E\u73B0\u540C\u6B65\u529F\u80FD\uFF0CAQS\u662F\u5F88\u591A\u540C\u6B65\u5668\u7684\u57FA\u7840\u6846\u67B6\uFF0C\u6211\u4EEC\u8FD8\u53EF\u4EE5\u57FA\u4E8EAQS\uFF0C\u5B9A\u5236\u51FA\u6211\u4EEC\u6240\u9700\u8981\u7684\u540C\u6B65\u5668</p></li><li><p>\u5728AQS\u5185\u90E8\uFF0C\u901A\u8FC7\u7EF4\u62A4\u4E00\u4E2AFIFO\u961F\u5217\uFF0C\u6765\u7BA1\u7406\u591A\u7EBF\u7A0B\u7684\u6392\u961F\u5DE5\u4F5C\uFF0C\u5728\u516C\u5E73\u7ADE\u4E89\u7684\u60C5\u51B5\u4E0B\uFF0C\u65E0\u6CD5\u83B7\u53D6\u9501\u7684<strong>\u7EBF\u7A0B</strong>\u4F1A\u88AB<strong>\u5C01\u88C5</strong>\u6210\u4E00\u4E2A\u8282\u70B9\uFF0C<strong>\u7F6E\u4E8EAQS\u961F\u5217\u5C3E\u90E8\uFF0C\u5165\u961F\u7684\u7EBF\u7A0B\u901A\u8FC7\u81EA\u65CB\u7684\u65B9\u5F0F\u83B7\u53D6\u9501\uFF0C\u82E5\u5728\u6709\u9650\u6B21\u7684\u5C1D\u8BD5\u540E\uFF0C\u4ECD\u672A\u83B7\u53D6\u6210\u529F\uFF0C\u7EBF\u7A0B\u4F1A\u88AB\u963B\u585E\u4F4F</strong>\uFF0C\u540E\u9762\u6709\u5177\u4F53\u7684\u8FC7\u7A0B\u8BF4\u660E</p></li><li><p><code>state</code>\u5C5E\u6027\uFF0C\u8868\u793A\u8D44\u6E90\u7684\u72B6\u6001</p><ul><li><p>\u72EC\u5360\u6A21\u5F0F---\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u80FD\u591F\u8BBF\u95EE\u8D44\u6E90\uFF0C\u6BD4\u5982\u4E4B\u524D\u7684\u76D1\u89C6\u5668\u9501\u4F7F\u67D0\u4E00\u4E2A\u65F6\u95F4\u6BB5\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u80FD\u591F\u8BBF\u95EE\u8D44\u6E90</p></li><li><p>\u5171\u4EAB\u6A21\u5F0F----\u5141\u8BB8\u591A\u4E2A\u7EBF\u7A0B\u8BBF\u95EE\u8D44\u6E90\uFF0C\u4F46\u662F\u6709\u4E0A\u9650</p><p>\u5B50\u7C7B\u9700\u8981\u5B9A\u4E49\u5982\u4F55\u7EF4\u62A4\u8FD9\u4E2A\u72B6\u6001\uFF0C\u63A7\u5236\u5982\u4F55\u83B7\u53D6\u9501\u548C\u91CA\u653E\u9501</p></li></ul></li></ol><p><img src="'+G+'" alt="image-20210909190349224"></p><p>\u200B \u7528cas\u4FEE\u6539state\u72B6\u6001\uFF0C\u4FDD\u8BC1\u4E86\u4FEE\u6539state\u72B6\u6001\u8FD9\u4E2A\u8FC7\u7A0B\u662F\u539F\u5B50\u6027\u7684\u3002</p><ol><li><p><strong>\u63D0\u4F9B\u4E86\u57FA\u4E8EFIFO\u7684\u7B49\u5F85\u961F\u5217</strong>\uFF0C\u7C7B\u4F3C\u4E8EMonitor\u7684EntryList\uFF0CMonitor\u662F\u64CD\u4F5C\u7CFB\u7EDF\u5C42\u9762\u7684\uFF0C\u6216\u8005\u8BF4\u662FJVM\u5C42\u9762\u7684\uFF0CEntryList\u662F\u7528C++\u6765\u5B9E\u73B0\u7684\uFF0C\u800C<strong>AQS\u662F\u7EAFJava\u5B9E\u73B0\u7684</strong>\u3002</p></li><li><p>ReentrantLock\u662FJava\u5C42\u9762\u7684\u9501</p></li><li><p>\u6761\u4EF6\u53D8\u91CF\u6765\u5B9E\u73B0\u7B49\u5F85\u3001\u5524\u9192\u673A\u5236\uFF0C\u652F\u6301\u591A\u4E2A\u6761\u4EF6\u53D8\u91CF\uFF0C\u7C7B\u4F3C\u4E8EMonitor\u7684WaitSet</p></li><li><p>Lock\u662F\u4E00\u4E2A\u63A5\u53E3\uFF0CReentrantLock\u662F\u4E00\u4E2ALock\u63A5\u53E3\u7684\u5B9E\u73B0\u7C7B\u3002</p></li><li><p>\u5B50\u7C7B\uFF08\u7EE7\u627F\u4E8E<code>AbstractQueuedSynchronizer</code>\uFF09\u4E3B\u8981\u5B9E\u73B0\u8FD9\u6837\u4E00\u4E9B\u65B9\u6CD5\uFF08\u9ED8\u8BA4\u629B\u51FAUnsupportedOperationException\uFF09</p><ul><li>tryAcquire</li><li>tryRelease</li><li>tryAcquireShared</li><li>tryRealeaseShared</li><li>isHeldExclusively</li></ul><p><img src="'+V+'" alt="image-20210909191200097"></p><p><img src="'+X+'" alt="image-20210909191210548"></p><p><strong>\u81EA\u5B9A\u4E49\u9501\u6216ReentrantLock\u91CC\u5B9A\u4E49\u7684\u4E0A\u9501\u3001\u4E0A\u9501\u5E26\u8D85\u65F6\u3001\u4E0A\u9501\u53EF\u6253\u65AD\u3001\u5C1D\u8BD5\u4E0A\u9501\u3001\u89E3\u9501\u3001\u591A\u4E2A\u6761\u4EF6\u53D8\u91CF\u7B49\u65B9\u6CD5\u90FD\u662F\u901A\u8FC7\u8C03\u7528\u7EE7\u627F\u4E8EAQS\u7684\u5B50\u7C7B\u5B9A\u4E49\u7684\u65B9\u6CD5\u3002</strong></p></li></ol><h3 id="reentrantlock\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#reentrantlock\u539F\u7406" aria-hidden="true">#</a> ReentrantLock\u539F\u7406</h3><ol><li><img src="'+Y+'" alt="image-20210909194450657"></li><li>ReentrantLock\u5B9E\u73B0\u4E86Lock\u63A5\u53E3\uFF0C<strong>\u5185\u90E8\u4E5F\u7EF4\u62A4\u4E86\u7EE7\u627F\u4E8EAQS\u7684\u540C\u6B65\u5668Sync</strong>\uFF0C<strong>\u4E0D\u8FC7\u8FD9\u4E2A\u540C\u6B65\u5668Sync\u662F\u62BD\u8C61\u7684</strong>\uFF0C<strong>\u8FD8\u6709\u4E24\u4E2A\u7EE7\u627F</strong><ul><li>NonfairSync -- \u975E\u516C\u5E73\u9501</li><li>FairSync -- \u516C\u5E73\u9501</li></ul></li></ol><h4 id="\u975E\u516C\u5E73\u9501\u5B9E\u73B0\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u975E\u516C\u5E73\u9501\u5B9E\u73B0\u539F\u7406" aria-hidden="true">#</a> \u975E\u516C\u5E73\u9501\u5B9E\u73B0\u539F\u7406</h4><ol><li><p>\u6784\u9020\u5668\uFF1A</p><p>\u9ED8\u8BA4\u901A\u8FC7\u975E\u516C\u5E73\u9501\u6765\u5B9E\u73B0\u5185\u90E8\u7EF4\u62A4\u7684Sync\u62BD\u8C61\u7C7B</p><p><img src="'+Z+'" alt="image-20210909194836695"></p></li><li><p>NonfairSync\u8FD9\u4E2A\u7C7B\u7EE7\u627F\u4E8ESync\uFF08ReentrantLock\u5185\u90E8\u7684\u62BD\u8C61\u7C7B\uFF09</p></li><li><p>\u539F\u7406\uFF1A</p><ol><li><p>\u6CA1\u6709\u7ADE\u4E89\u65F6\uFF0CThread-0\u6210\u4E3A\u975E\u516C\u5E73\u9501\u7684Owner</p><p><img src="'+$+'" alt="image-20210909201243193"></p></li><li><p>\u7B2C\u4E00\u4E2A\u7ADE\u4E89\u51FA\u73B0\u65F6\uFF0C<strong>\u9996\u5148\u5C1D\u8BD5CAS</strong>\uFF0C\u60F3\u8981\u901A\u8FC7CAS\u5C06state\u7F6E\u4E3A1\uFF0C\u4F46\u662F\u76EE\u524Dstate\u5DF2\u662F1\uFF0C\u800C\u8FD9\u6B21\u8C03\u7528cas\u7684\u53C2\u6570\u662F\u671F\u671B\u503C\uFF1A0\uFF0C\u66F4\u65B0\u503C\uFF1A1.</p><p>\u6240\u4EE5\u671F\u671B\u503C\u548C\u5F53\u524D\u5BF9\u8C61\u7684state\u5C5E\u6027\u4E0D\u4E00\u6837\uFF0C\u66F4\u65B0\u5931\u8D25\uFF0C\u8FDB\u5165accquire</p><p><img src="'+ii+'" alt="image-20210909201251908"></p><p><img src="'+li+'" alt="image-20210909203507236"></p></li><li><p>\u8FDB\u5165accquire\u65B9\u6CD5\u4E4B\u540E\uFF0C<strong>\u9996\u5148\u4F1A\u518D\u6B21\u5C1D\u8BD5\uFF0C\u4F1A\u8FDB\u884CtryAccquire</strong>\uFF0C\u8FD9\u65F6state\u5DF2\u662F1\uFF0C\u7ED3\u679C\u4ECD\u7136\u662Ffalse</p><p>\u7136\u540E\u8FDB\u5165addWaiter\u903B\u8F91</p><ul><li>\u5982\u679C\u662F\u975E\u516C\u5E73\u9501\uFF0C\u90A3\u4E48\u8FDB\u5165tryAccquire\uFF0C\u4F1A\u62A2\u5360\u9501\uFF0C\u62A2\u5360\u9501\u5931\u8D25\uFF0C\u624D\u4F1A\u5C01\u88C5\u6210\u8282\u70B9\u5165AQS\u961F\u5217</li><li>\u516C\u5E73\u9501\u7684tryAccquire\u6BD4\u975E\u516C\u5E73\u9501\u591A\u4E86\u4E00\u4E2A\u6761\u4EF6\uFF0C\u5373!hasQueuedPredecessors()\uFF0C\u68C0\u67E5AQS\u961F\u5217\u91CC\u662F\u5426\u6709\u7B49\u5F85\u65F6\u95F4\u66F4\u957F\u7684\u7EBF\u7A0B\u8282\u70B9</li></ul></li><li><p>\u8FDB\u5165addWaiter\u903B\u8F91\uFF0C\u6784\u9020Node\u961F\u5217</p><p><img src="'+pi+'" alt="image-20210909203742017"></p><p>\u7B2C\u4E00\u4E2ANode\u79F0\u4E3A\u54D1\u5143\u6216\u54E8\u5175\uFF0C\u7528\u6765\u7AD9\u4F4D\uFF0C\u5E76\u4E0D\u5173\u8054\u7EBF\u7A0B\u3002</p><p>Node\u961F\u5217\u5E95\u5C42\u662F\u901A\u8FC7\u53CC\u5411\u94FE\u8868\u5B9E\u73B0</p></li><li><p>AQS\u7EF4\u62A4\u7684\u7EBF\u7A0B\u8282\u70B9\u540C\u6B65\u7B49\u5F85\u961F\u5217\u4E2D\uFF0C\u5934\u8282\u70B9\u662F\u6210\u529F\u83B7\u53D6\u5230\u540C\u6B65\u72B6\u6001\u7684\u8282\u70B9\u3002</p></li><li><p>\u53EA\u6709\u524D\u9A71\u8282\u70B9\u662F\u5934\u8282\u70B9\u7684\u7EBF\u7A0B\u8282\u70B9\u624D\u80FD\u591F\u5C1D\u8BD5\u83B7\u53D6\u540C\u6B65\u72B6\u6001\u3002</p><p>\u5982\u679C\u975E\u9996\u8282\u70B9\u7EBF\u7A0B\u524D\u9A71\u8282\u70B9\u51FA\u961F\u6216\u8005\u88AB\u4E2D\u65AD\uFF0C\u5219\u68C0\u67E5\u81EA\u5DF1\u7684\u524D\u9A71\u8282\u70B9\u662F\u5426\u662F\u5934\u8282\u70B9\uFF0C\u5982\u679C\u662F\u5219\u5C1D\u8BD5\u83B7\u53D6\u540C\u6B65\u72B6\u6001\uFF0C\u5982\u679C\u4E0D\u662F\u5F53\u524D\u7EBF\u7A0B\u8282\u70B9\u5219\u963B\u585E\uFF08park\uFF09\u3002\u53EF\u4EE5\u8BF4\u662F\u963B\u585E\uFF0C\u4E5F\u53EF\u4EE5\u8BF4\u662F\u8FDB\u5165\u7B49\u5F85\u72B6\u6001\u3002</p></li><li><p>\u7136\u540E\u8FDB\u5165acquireQueued\u903B\u8F91</p><ul><li><p>acquireQueued\u4F1A\u5728\u4E00\u4E2A\u5FAA\u73AF\u4E2D\u4E0D\u65AD\u5C1D\u8BD5\u83B7\u5F97\u9501\uFF0C\u5931\u8D25\u540E<strong>\u8FDB\u5165park\u963B\u585E</strong></p></li><li><p><strong>\u5982\u679C\u5F53\u524DNode\u662F\u7B2C\u4E8C\u4F4D</strong>\uFF0C\u90A3\u4E48\u518D\u6B21tryAcquire\u5C1D\u8BD5\u83B7\u53D6\u9501\uFF0Cstate\u4ECD\u662F1\uFF0C\u5931\u8D25</p></li><li><p><strong>\u8FDB\u5165shouldParkAfterFailedAcquire\u903B\u8F91\uFF0C\u5C06\u524D\u9A71node\u5373head\u7684waitStatus\u6539\u4E3A-1</strong>\uFF0C\u8FD9\u6B21\u8FD4\u56DEfalse</p><p><img src="'+ei+'" alt="image-20210909204148130"></p></li><li><p>shouldParkAfterFailedAcquire\u6267\u884C\u5B8C\u6BD5\u540E\uFF0C\u56DE\u5230acquireQueued\uFF0C\u518D\u6B21tryAcquire\u5C1D\u8BD5\u83B7\u53D6\u9501\uFF0C\u5F53\u7136\u8FD9\u65F6state\u4ECD\u4E3A1\uFF0C\u5931\u8D25</p></li><li><p>\u5F53\u518D\u6B21\u8FDB\u5165shouldParkAfterFailedAcquire\u65F6\uFF0C\u8FD9\u65F6\u56E0\u4E3A\u524D\u9A71node\u7684<strong>waitStatus</strong>\u5DF2\u7ECF\u662F-1\uFF0C\u8FD9\u6B21\u8FD4\u56DEtrue</p></li><li><p>\u8FDB\u5165parkAndCheckInterrupt\uFF0C\u8FDB\u5165\u963B\u585E\u6001\u3002</p><p><img src="'+ai+'" alt="image-20210909204356085"></p><p>\u53EF\u4EE5\u53D1\u73B0\u9664\u4E86\u6700\u540E\u4E00\u4E2Anode\uFF0C\u524D\u9762\u7684node\u7684waitStatus\u90FD\u88AB\u6539\u6210\u4E86-1\uFF0C\u6BCF\u4E2Anode\u90FD\u5E94\u8BE5\u7531\u4E0A\u4E00\u4E2A\u8282\u70B9\u5524\u9192\u3002</p><p>-1\u8868\u793A-1\u7684node\u6709\u8D23\u4EFB\u5524\u9192\u540E\u7EE7\u8282\u70B9</p></li></ul></li><li><p>Thread-0 \u91CA\u653E\u9501\uFF0C\u8FDB\u5165tryRelease\u6D41\u7A0B\uFF0C\u5982\u679C\u6210\u529F</p><ul><li>\u8BBE\u7F6EexclusiveOwnerThread \u4E3Anull</li><li>state = 0</li></ul></li><li><p>\u5F53\u524DNode\u961F\u5217\u4E0D\u4E3Anull\uFF0C\u5E76\u4E14head\u7684waitStatus = -1\uFF0C\u8FDB\u5165unparkSuccessor\u6D41\u7A0B</p><p>\u627E\u5230\u961F\u5217\u4E2D\u79BBhead\u6700\u8FD1\u7684\u4E00\u4E2ANode\uFF0Cunpark\u6062\u590D\u5176\u8FD0\u884C\uFF0C\u672C\u4F8B\u4E2D\u5373\u4E3AThread-1</p><ul><li><strong>head\u6307\u5411Thread-1\u6240\u5728Node</strong></li><li>\u539F\u672C\u7684head Node\u4ECE\u94FE\u8868\u65AD\u5F00\uFF0C\u88AB\u5783\u573E\u56DE\u6536\u5668\u56DE\u6536</li></ul></li><li><p>\u8FD9\u65F6\u5019\u5982\u679C\u6709\u5176\u4ED6\u7EBF\u7A0B\u6765\u7ADE\u4E89\uFF08<strong>\u975E\u516C\u5E73\u7684\u4F53\u73B0</strong>\uFF09\uFF0C\u6BD4\u5982Thread-4</p><p>\u8FD9\u4E2AThread-4\u53EF\u4EE5\u548CThread-1\u7ADE\u4E89\uFF0C\u53EF\u80FDThread-1\u7ADE\u4E89\u9501\u53C8\u5931\u8D25\u4E86\u3002</p></li><li><p><strong>\u975E\u516C\u5E73\u7684\u610F\u601D\u5C31\u662F\u8BF4\uFF0C\u5373\u4F7F\u6392\u5728Node\u961F\u5217\uFF08\u53CC\u5411\u94FE\u8868\uFF09\u7684\u5934\u4F4D\uFF0C\u4ECD\u7136\u6709\u53EF\u80FD\u4E0D\u4F1A\u83B7\u5F97\u9501</strong></p></li></ol></li></ol><h4 id="\u53EF\u91CD\u5165\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u53EF\u91CD\u5165\u539F\u7406" aria-hidden="true">#</a> \u53EF\u91CD\u5165\u539F\u7406</h4><ol><li>\u5982\u679C\u9501\u91CD\u5165\uFF0C\u8BA9state++\uFF0C\u8BF4\u660E\u540C\u4E00\u7EBF\u7A0B\u83B7\u5F97\u4E86\u591A\u6B21\u9501</li><li>\u91CA\u653E\u9501\u7684\u65F6\u5019\uFF0C\u4E5F\u8981\u8BA9state\u51CF1\uFF08\u81EA\u51CF\uFF09\uFF0C\u53EA\u6709state\u51CF\u4E3A0\uFF0C\u624D\u91CA\u653E\u6210\u529F\u3002</li></ol><h4 id="\u53EF\u6253\u65AD\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u53EF\u6253\u65AD\u539F\u7406" aria-hidden="true">#</a> \u53EF\u6253\u65AD\u539F\u7406</h4><ol><li>ReentrantLock\u9ED8\u8BA4\u662F\u4E0D\u53EF\u6253\u65AD\u7684</li><li>\u53EF\u6253\u65AD\uFF0C\u5728park\u8FC7\u7A0B\u4E2D\u5982\u679C\u88AB\u6253\u65AD\uFF0C\u91C7\u7528\u4E86\u629B\u51FA\u5F02\u5E38\u7684\u65B9\u5F0F\uFF0C\u4E0D\u4F1A\u518D\u6B21\u8FDB\u5165for(;;)\u53BB\u7ADE\u4E89\u9501</li></ol><h4 id="\u516C\u5E73\u9501\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u516C\u5E73\u9501\u539F\u7406" aria-hidden="true">#</a> \u516C\u5E73\u9501\u539F\u7406</h4><ol><li><p>\u975E\u516C\u5E73\u9501\u53EA\u4F1A\u68C0\u67E5state\uFF0C<strong>\u4E0D\u4F1A\u68C0\u67E5AQS\u7B49\u5F85\u961F\u5217\uFF08\u5728\u6E90\u7801\u4E2D\u53EF\u4EE5\u53D1\u73B0\u53EA\u68C0\u67E5\u4E86state\uFF0C\u6CA1\u6709\u505AAQS\u961F\u5217\u7684\u5224\u65AD\uFF09</strong>\uFF0C\u4E0D\u4F1A\u7BA1\u662F\u5426\u6709\u7EBF\u7A0B\u5BF9\u5E94\u7684\u8282\u70B9\u5728AQS\u961F\u5217\u4E2D\u7B49\u5F85\uFF0C\u4E0D\u4F1A\u7BA1AQS\u7B49\u5F85\u961F\u5217\uFF0C\u76F4\u63A5\u5C31\u53BB\u7ADE\u4E89</p><p>\u5373\u4F7F\u67D0\u4E2A\u7EBF\u7A0B\u5BF9\u5E94\u7684\u8282\u70B9\u5728AQS\u7B49\u5F85\u961F\u5217\u7684\u7D27\u63A5\u7740\u5360\u4F4D\u8282\u70B9\u7684\u4E0B\u4E00\u4E2A\u8282\u70B9\uFF0C\u4E5F\u4E0D\u4E00\u5B9A\u4F1A\u6210\u529F\u7ADE\u4E89\u5230\u9501</p></li><li><p>\u800C\u516C\u5E73\u9501\u4F1A\u68C0\u67E5AQS\u961F\u5217\u4E2D\u662F\u5426\u6709\u524D\u9A71\u8282\u70B9\uFF0C\u6CA1\u6709\u524D\u9A71\u8282\u70B9\uFF0C\u624D\u53BB\u7ADE\u4E89\u3002</p><p>\u5982\u679C\u6709\u524D\u9A71\u8282\u70B9\uFF0C\u8BE5\u7EBF\u7A0B\u90FD\u4E0D\u4F1A\u53BB\u6267\u884Ccas\uFF0C\u90FD\u4E0D\u4F1A\u53BB\u6BD4\u8F83state\u3002</p></li></ol><h4 id="\u6761\u4EF6\u53D8\u91CF\u5B9E\u73B0\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u6761\u4EF6\u53D8\u91CF\u5B9E\u73B0\u539F\u7406" aria-hidden="true">#</a> \u6761\u4EF6\u53D8\u91CF\u5B9E\u73B0\u539F\u7406</h4><ol><li><p>\u6BCF\u4E2A\u6761\u4EF6\u53D8\u91CF\u5BF9\u5E94\u4E8E\u4E00\u4E2AConditionObject</p><p>ConditionObject\u4E5F\u7EF4\u62A4\u4E86\u4E00\u4E2A\u53CC\u5411\u94FE\u8868\uFF0C\u4F5C\u4E3A\u90A3\u4E9B\u4E0D\u6EE1\u8DB3\u6761\u4EF6\uFF0C\u9700\u8981\u4F11\u606F\u7684\u7EBF\u7A0B</p></li><li><p>await\u6D41\u7A0B</p><ol><li><p>\u8C03\u7528await\u4E4B\u524D\uFF0C\u5FC5\u987B\u62E5\u6709\u9501\u624D\u6709\u8D44\u683C\u8C03\u7528</p><p>await\u65B9\u6CD5\u662FConditionObject\u7684\u65B9\u6CD5\u800C\u4E0D\u662FLock\u7684\u65B9\u6CD5</p></li><li><p>\u5F00\u59CBThread-0\u6301\u6709\u9501\uFF0C\u6709\u8D44\u683C\u8C03\u7528await\uFF0C\u7136\u540E\u8C03\u7528await()\uFF0C\u8FDB\u5165ConditionObject\u7684addConditionWaiter\u6D41\u7A0B</p><p>\u521B\u5EFA\u65B0\u7684Node\u72B6\u6001\u4E3A-2\u7684\u8282\u70B9\uFF0C\u5173\u8054Thread-0\uFF0C\u52A0\u5165\u7B49\u5F85\u961F\u5217\u5C3E\u90E8</p><p><img src="'+ri+'" alt="image-20210909220203679"></p></li><li><p>\u63A5\u4E0B\u6765\u8FDB\u5165AQS\u7684fullRelease()\u6D41\u7A0B\uFF0C\u91CA\u653E\u540C\u6B65\u76D1\u89C6\u5668\u4E0A\u7684\u9501</p><p><img src="'+ti+'" alt="image-20210909220242221"></p></li><li><p>unpark AQS\u961F\u5217\u4E2D\u7684\u4E0B\u4E00\u4E2A\u8282\u70B9\uFF0C\u7ADE\u4E89\u9501\uFF0C\u7D27\u63A5\u7740\u5360\u4F4D\u8282\u70B9\u4E4B\u540E\u7684\u90A3\u4E2A\u8282\u70B9\u5BF9\u5E94\u7684\u7EBF\u7A0B\u7ADE\u4E89\u6210\u529F\uFF08\u5982\u679C\u662F\u975E\u516C\u5E73\u9501\u7684\u673A\u5236\uFF0C\u4F46\u662F\u6CA1\u6709\u5176\u4ED6\u7EBF\u7A0B\u6765\u7ADE\u4E89\u7684\u60C5\u51B5\uFF0C\u6216\u8005\u662F\u516C\u5E73\u9501\u7684\u673A\u5236\uFF09</p><p><img src="'+ni+'" alt="image-20210909220502184"></p><p>Thread-1\u8282\u70B9\u7684\u524D\u4E00\u4E2A\u8282\u70B9\uFF08\u5360\u4F4D\u8282\u70B9\uFF09\u8981\u65AD\u5F00\uFF0C\u7136\u540Ehead\u8981\u6307\u5411\u65B0\u7684\u8282\u70B9\u5373\u539F\u5360\u4F4D\u8282\u70B9\u7684\u4E0B\u4E00\u4E2A\u8282\u70B9\u6210\u4E3A\u65B0\u7684\u5360\u4F4D\u8282\u70B9\uFF0C\u4E0B\u4E00\u4E2A\u7ADE\u4E89\u9501\u7684\u8282\u70B9\u5C31\u662F\u5F53\u524Dhead\u8282\u70B9\u7684\u4E0B\u4E00\u4E2A\u8282\u70B9\u3002\u5728\u56FE\u4E2D\u5373Thread-2</p></li><li><p><strong>\u5728ConditionObject\u7B49\u5F85\u961F\u5217\u7684\u7EBF\u7A0B\u8282\u70B9\u963B\u585E</strong></p><p><img src="'+oi+'" alt="image-20210909220707854"></p></li></ol></li><li><p><strong>AQS\u961F\u5217\u548CConditionObject\u7B49\u5F85\u961F\u5217\u7684\u7EBF\u7A0B\u6700\u540E\u963B\u585E\uFF0C\u90FD\u662F\u901A\u8FC7\u8C03\u7528park()\u963B\u585E\u7684</strong></p></li><li><p>signal\u6D41\u7A0B</p><ol><li><p>\u5047\u8BBE\u73B0\u5728\u5360\u6709\u9501\u7684Thread-1\u8981\u6765\u5524\u9192ConditionObject\u7B49\u5F85\u961F\u5217\u4E2D\u7684\u7EBF\u7A0B\uFF0C\u90A3\u4E48Thread-1\u8981\u5524\u9192\u7B49\u5F85\u961F\u5217\u4E2D\u7684Thread-0</p></li><li><p>\u8FDB\u5165ConditionObject\u7684doSignal\u6D41\u7A0B\uFF0C\u53D6\u5F97\u7B49\u5F85\u961F\u5217\u4E2D\u7B2C\u4E00\u4E2ANode\uFF0C\u5373Thread-0\u6240\u5728Node</p><p><img src="'+si+'" alt="image-20210910125940213"></p></li><li><p>\u6267\u884CTransferForSignal\u6D41\u7A0B\uFF0C\u5C06\u7B49\u5F85\u961F\u5217\u4E2D\u53D6\u5F97\u7684Node\uFF0C\u52A0\u5165AQS\u961F\u5217\u5C3E\u90E8\uFF0C\u5C06Thread-0\u7684\u72B6\u6001\u7531-2\u6539\u4E3A0\uFF0C\u5C06AQS\u961F\u5217\u4E2D\uFF0C<strong>Thread-0\u7684\u524D\u4E00\u4E2A\u7EBF\u7A0B\u8282\u70B9\u7684\u72B6\u6001\u6539\u4E3A-1</strong>\uFF0C\u8868\u793A\u524D\u4E00\u4E2A\u7EBF\u7A0B\u6709\u8D44\u683C\u5524\u9192Thread-0\u8FD9\u4E2A\u7EBF\u7A0B</p><p><img src="'+di+'" alt="image-20210910125952369"></p></li><li><p>\u73B0\u5728\u5360\u6709\u9501\u7684Thread-1\u91CA\u653E\u9501\uFF0C\u8FDB\u5165unlock\u6D41\u7A0B</p></li></ol></li></ol><h4 id="\u516C\u5E73\u4E0E\u975E\u516C\u5E73" tabindex="-1"><a class="header-anchor" href="#\u516C\u5E73\u4E0E\u975E\u516C\u5E73" aria-hidden="true">#</a> \u516C\u5E73\u4E0E\u975E\u516C\u5E73</h4><ol><li><p>\u516C\u5E73\u4E0E\u975E\u516C\u5E73\u6307\u7684\u662F\u7EBF\u7A0B\u83B7\u53D6\u9501\u7684\u65B9\u5F0F\u3002\u516C\u5E73\u6A21\u5F0F\u4E0B\uFF0C\u7EBF\u7A0B\u5728<strong>\u540C\u6B65\u961F\u5217</strong>\u4E2D\u901A\u8FC7 FIFO \u7684\u65B9\u5F0F\u83B7\u53D6\u9501\uFF0C\u6BCF\u4E2A\u7EBF\u7A0B\u6700\u7EC8\u90FD\u80FD\u83B7\u53D6\u9501\u3002\u5728\u975E\u516C\u5E73\u6A21\u5F0F\u4E0B\uFF0C\u7EBF\u7A0B\u4F1A\u901A\u8FC7\u201C\u63D2\u961F\u201D\u7684\u65B9\u5F0F\u53BB\u62A2\u5360\u9501\uFF08<strong>\u4E5F\u5C31\u662F\u961F\u5217\u5185\u7684\u7EBF\u7A0B\u5C01\u88C5\u6210\u7684\u8282\u70B9\uFF0C\u5C31\u53EF\u4EE5\u7406\u89E3\u4E3A\u7EBF\u7A0B\uFF0C\u662F\u6309\u7167\u961F\u5217FIFO\u987A\u5E8F\u83B7\u5F97\u9501\u7684\uFF0C\u4F46\u662F\u961F\u5217\u5916\u7684\u7EBF\u7A0B\uFF0C\u5C31\u770B\u5B83\u662F\u5426\u68C0\u67E5\u8FD9\u4E2AAQS\u961F\u5217\u4E86\uFF0C\u5982\u679C\u4E0D\u68C0\u67E5\uFF0C\u5C31\u662F\u975E\u516C\u5E73\u6A21\u5F0F\uFF0C\u961F\u5217\u5916\u7684\u7EBF\u7A0B\u5C31\u53EF\u4EE5\u63D2\u961F\u3002</strong>\uFF09\uFF0C\u62A2\u4E0D\u5230\u7684\u5219\u8FDB\u5165\u540C\u6B65\u961F\u5217\u8FDB\u884C\u6392\u961F\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0CReentrantLock \u4F7F\u7528\u7684\u662F\u975E\u516C\u5E73\u6A21\u5F0F\u83B7\u53D6\u9501\uFF0C\u800C\u4E0D\u662F\u516C\u5E73\u6A21\u5F0F\u3002\u4E0D\u8FC7\u6211\u4EEC\u4E5F\u53EF\u901A\u8FC7 ReentrantLock \u6784\u9020\u65B9\u6CD5<code>ReentrantLock(boolean fair)</code>\u8C03\u6574\u52A0\u9501\u7684\u6A21\u5F0F\u3002</p></li><li><p>\u516C\u5E73\u4E0E\u975E\u516C\u5E73\u9501\u7684\u4F18\u7F3A\u70B9\uFF1A</p><p>\u516C\u5E73\u6A21\u5F0F\u4E0B\uFF0C\u53EF\u4FDD\u8BC1\u6BCF\u4E2A\u7EBF\u7A0B\u6700\u7EC8\u90FD\u80FD\u83B7\u5F97\u9501\uFF0C\u4F46\u6548\u7387\u76F8\u5BF9\u6BD4\u8F83\u8F83\u4F4E\uFF0C\u53EF\u4EE5\u89E3\u51B3\u9965\u997F\u95EE\u9898\u3002</p><p>\u975E\u516C\u5E73\u6A21\u5F0F\u4E0B\uFF0C\u6548\u7387\u6BD4\u8F83\u9AD8\uFF0C\u4F46\u53EF\u80FD\u4F1A\u5BFC\u81F4\u7EBF\u7A0B\u51FA\u73B0\u9965\u997F\u7684\u60C5\u51B5\u3002\u5373\u4F7F\u51FA\u73B0\u9965\u997F\uFF0C\u4E5F\u5F88\u5C11\u4F7F\u7528\u4FEE\u6539\u4E3A\u516C\u5E73\u9501\u7684\u65B9\u5F0F\u89E3\u51B3\uFF0C\u800C\u901A\u8FC7tryLock()\u7684\u65B9\u5F0F\u89E3\u51B3</p></li><li><p>\u4E3A\u5565\u975E\u516C\u5E73\u6A21\u5F0F\u62A2\u4E86\u5176\u4ED6\u7EBF\u7A0B\u83B7\u53D6\u9501\u7684\u673A\u4F1A\uFF0C\u800C\u6574\u4E2A\u7A0B\u5E8F\u7684\u8FD0\u884C\u6548\u7387\u4F1A\u66F4\u9AD8\u5462\uFF1F</p><p>\u5728\u6FC0\u70C8\u7ADE\u4E89\u7684\u60C5\u51B5\u4E0B\uFF0C\u975E\u516C\u5E73\u9501\u7684\u6027\u80FD\u9AD8\u4E8E\u516C\u5E73\u9501\u7684\u6027\u80FD\u7684\u4E00\u4E2A\u539F\u56E0\u662F\uFF1A\u5728\u6062\u590D\u4E00\u4E2A\u88AB\u6302\u8D77\u7684\u7EBF\u7A0B\u4E0E\u8BE5\u7EBF\u7A0B\u771F\u6B63\u5F00\u59CB\u8FD0\u884C\u4E4B\u95F4\u5B58\u5728\u7740\u4E25\u91CD\u7684\u5EF6\u8FDF\u3002\u4E0E\u6B64\u540C\u65F6\uFF0C\u5982\u679C C \u4E5F\u8BF7\u6C42\u8FD9\u4E2A\u9501\uFF0C\u90A3\u4E48 C \u5F88\u6709\u53EF\u80FD\u4F1A\u5728 B \u88AB\u5B8C\u5168\u5524\u9192\u524D\u83B7\u5F97\u3001\u4F7F\u7528\u4EE5\u53CA\u91CA\u653E\u8FD9\u4E2A\u9501\u3002\u8FD9\u6837\u7684\u60C5\u51B5\u65F6\u4E00\u79CD\u201C\u53CC\u8D62\u201D\u7684\u5C40\u9762\uFF1AB \u83B7\u5F97\u9501\u7684\u65F6\u523B\u5E76\u6CA1\u6709\u63A8\u8FDF\uFF0CC \u66F4\u65E9\u7684\u83B7\u5F97\u4E86\u9501\uFF0C\u5E76\u4E14\u541E\u5410\u91CF\u4E5F\u83B7\u5F97\u4E86\u63D0\u9AD8\u3002\uFF08\u541E\u5410\u91CF\u662F\u6307\u7528\u6237\u7EBF\u7A0B\u6267\u884C\u65F6\u95F4\u5360\u6BD4\uFF0C\u5176\u4ED6\u65F6\u95F4\u6709\u5783\u573E\u56DE\u6536\u65F6\u95F4\uFF0C\u7EBF\u7A0B\u4E0A\u4E0B\u6587\u5207\u6362\u6D88\u8017\u7B49\uFF09</p><p><img src="'+hi+'" alt="image-20210910183523679"></p></li><li><p><strong>AQS \u7EF4\u62A4\u4E86\u4E00\u4E2A\u57FA\u4E8E\u53CC\u5411\u94FE\u8868\u7684\u540C\u6B65\u961F\u5217\uFF0C\u7EBF\u7A0B\u5728\u83B7\u53D6\u540C\u6B65\u72B6\u6001\u5931\u8D25\u7684\u60C5\u51B5\u4E0B\uFF0C\u90FD\u4F1A\u88AB\u5C01\u88C5\u6210\u8282\u70B9\uFF0C\u7136\u540E\u52A0\u5165\u961F\u5217\u4E2D\u3002\u52A0\u5165\u8FD9\u4E2A\u961F\u5217\u4E2D\uFF0C\u4E0D\u4EE3\u8868\u7EBF\u7A0B\u5C01\u88C5\u6210\u7684\u8282\u70B9\u963B\u585E\u4E86\uFF0C\u52A0\u5165\u8FD9\u4E2A\u961F\u5217\uFF0C\u8FD8\u4F1A\u901A\u8FC7\u81EA\u65CB\u7684\u65B9\u5F0F\u83B7\u5F97\u9501\uFF0C\u591A\u6B21\uFF08\u6709\u9650\u6B21\uFF09\u5C1D\u8BD5\u5931\u8D25\u540E\uFF0C\u624D\u4F1A\u901A\u8FC7park\u963B\u585E\uFF0C\u5E76\u4E0D\u662F\u8BF4\u5165\u961F\u5C31\u963B\u585E</strong></p></li><li><ul><li><p>**\u975E\u516C\u5E73\u9501\u7684 lock \u65B9\u6CD5\u4F1A\u9996\u5148\u5C1D\u8BD5\u53BB\u62A2\u5360\u8BBE\u7F6E\u540C\u6B65\u72B6\u6001\uFF08\u901A\u8FC7CAS\uFF09\uFF0C\u800C\u4E0D\u662F\u76F4\u63A5\u8C03\u7528 acquire()\u65B9\u6CD5 \u5C06\u7EBF\u7A0B\u653E\u5165\u540C\u6B65\u961F\u5217\u4E2D\u7B49\u5F85\u83B7\u53D6\u9501\u3002**\u5982\u679C\u8BBE\u7F6E\u540C\u6B65\u72B6\u6001state\u5931\u8D25\uFF0C\u5373CAS\u6BD4\u8F83\u4E0D\u6210\u529F\uFF0C\u90A3\u4E48\u624D\u8FDB\u5165acquire()</p></li><li><p><strong>\u516C\u5E73\u9501\u7684lock()\u5219\u76F4\u63A5\u8C03\u7528acquire()</strong></p></li><li><p><strong>\u8FDB\u5165acquire()\u4E4B\u540E\uFF0C\u5148\u8FDB\u884CtryAcquire()</strong></p><ul><li>\u516C\u5E73\u9501\u7684tryAcquire \u591A\u51FA\u4E86\u4E00\u4E2A\u6761\u4EF6\uFF0C\u5373<code>!hasQueuedPredecessors()</code>\u3002\u8FD9\u4E2A\u65B9\u6CD5\u7684\u76EE\u7684\u662F\u5224\u65AD\u662F\u5426\u6709\u5176\u4ED6\u7EBF\u7A0B\u6BD4\u5F53\u524D\u7EBF\u7A0B\u5728\u540C\u6B65\u961F\u5217\u4E2D\u7B49\u5F85\u7684\u65F6\u95F4\u66F4\u957F\u3002</li><li>\u5982\u679C\u6211\u4EEC\u628A tryAcquire \u4E2D\u7684\u6761\u4EF6<code>!hasQueuedPredecessors()</code>\u53BB\u6389\uFF0C\u516C\u5E73\u9501\u5C06\u4E0D\u518D\u90A3\u4E48\u201C\u8C26\u8BA9\u201D\uFF0C\u5B83\u5C06\u4F1A\u50CF\u975E\u516C\u5E73\u9501\u90A3\u6837\u62A2\u5360\u83B7\u53D6\u9501\uFF0C\u62A2\u5360\u5931\u8D25\u624D\u4F1A\u5165\u961F\uFF0C\u5C31\u53D8\u6210\u4E86\u975E\u516C\u5E73\u9501\u3002</li></ul></li></ul></li></ol><h3 id="reentrantreadwritelock" tabindex="-1"><a class="header-anchor" href="#reentrantreadwritelock" aria-hidden="true">#</a> ReentrantReadWriteLock</h3><ol><li><p>ReentrantReadWriteLock\u548CStampedLock\u90FD\u662F\u8BFB\u5199\u9501</p></li><li><p>ReentrantReadWriteLock\u652F\u6301\u91CD\u5165\uFF0C\u662F\u53EF\u91CD\u5165\u9501</p></li><li><p>ReentrantReadWriteLock\u7684\u76EE\u7684\u662F\u63D0\u9AD8\u8BFB\u64CD\u4F5C\u7684\u6027\u80FD</p><p>\u5F53\u8BFB\u64CD\u4F5C\u8FDC\u8FDC\u9AD8\u4E8E\u5199\u64CD\u4F5C\u65F6\uFF0C\u8FD9\u65F6\u5019\u4F7F\u7528\u8BFB\u5199\u9501\u8BA9<code>\u8BFB-\u8BFB</code>\u53EF\u4EE5\u5E76\u53D1\uFF0C\u63D0\u9AD8\u6027\u80FD\u3002</p><p>\u8BFB\u8BFB\u53EF\u4EE5\u5E76\u53D1\uFF0C \u800C\u8BFB\u5199\u4E92\u65A5</p></li></ol><h3 id="\u7EBF\u7A0B\u5B89\u5168\u96C6\u5408\u7C7B\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u5B89\u5168\u96C6\u5408\u7C7B\u6982\u8FF0" aria-hidden="true">#</a> \u7EBF\u7A0B\u5B89\u5168\u96C6\u5408\u7C7B\u6982\u8FF0</h3><ol><li><ul><li><p>\u9057\u7559\u7684\u7EBF\u7A0B\u5B89\u5168\u96C6\u5408\u5982Hashtable\uFF0CVector</p><p>Hashtable\u662FMap\u63A5\u53E3\u7684\u5B9E\u73B0\u7C7B</p><p>Vector\u662FList\u63A5\u53E3\u7684\u5B9E\u73B0\u7C7B</p></li><li><p><img src="'+gi+'" alt="image-20210910130603196"></p></li><li><p><strong>JUC\u5B89\u5168\u96C6\u5408</strong></p><ul><li>BLOCKING\u7C7B\uFF0C\u5927\u90E8\u5206\u57FA\u4E8E\u9501\uFF0C\u5E76\u63D0\u4F9B\u7528\u6765\u963B\u585E\u7684\u65B9\u6CD5\u3002\uFF08\u8FD9\u79CD\u79F0\u4E3A\u60B2\u89C2\u9501\uFF0C\u4E50\u89C2\u9501\u5176\u5B9E\u6CA1\u6709\u9501\uFF0C\u662F\u5B9E\u73B0\u65E0\u9501\u5E76\u53D1\uFF0CCAS+volatile\u5B9E\u73B0\uFF09</li><li>CopyOnWrite\u7C7B\uFF0C\u9002\u7528\u4E8E\u8BFB\u591A\u5199\u5C11\u7684\u573A\u666F</li><li>Concurrent\u7C7B</li></ul></li></ul></li><li><p><img src="'+ci+'" alt="image-20210910130839000"></p></li><li><p>Concurrent\u7C7B\u578B\u7684\u5BB9\u5668</p><ul><li><p>\u5927\u591A\u6027\u80FD\u90FD\u6BD4\u8F83\u9AD8</p><p>\u5185\u90E8\u5F88\u591A\u64CD\u4F5C\u4F7F\u7528cas\u4F18\u5316\uFF0C\u4E00\u822C\u53EF\u4EE5\u63D0\u9AD8\u8F83\u9AD8\u541E\u5410\u91CF\uFF0C\u7528\u6237\u7EBF\u7A0B\u6267\u884C\u7684\u65F6\u95F4\u5360\u6BD4\u9AD8\u3002</p><p>\u56E0\u4E3A\u7528cas+volatile\u5B9E\u73B0\u7684\u65E0\u9501\u5E76\u53D1\uFF0C\u5373\u4E50\u89C2\u9501</p></li><li><p>\u5F31\u4E00\u81F4\u6027</p><p>\u5F53\u5229\u7528\u8FED\u4EE3\u5668\u904D\u5386\u65F6\uFF0C\u5982\u679C\u5BB9\u5668\u53D1\u751F\u4FEE\u6539\uFF0C\u8FED\u4EE3\u5668\u4ECD\u7136\u53EF\u4EE5\u7EE7\u7EED\u8FDB\u884C\u904D\u5386\uFF08\u56E0\u4E3A\u4E0D\u963B\u585E\uFF0C\u6CA1\u6709\u4E0A\u9501\uFF09\uFF0C\u8FD9\u65F6\u5185\u5BB9\u662F\u65E7\u7684</p><p>\u6C42\u5927\u5C0F\uFF0C\u56E0\u4E3A\u5F31\u4E00\u81F4\u6027\uFF0C\u5E76\u4E0D\u4E00\u5B9A\u51C6\u786E</p><p><strong>\u5BF9\u4E8E\u975E\u5B89\u5168\u5BB9\u5668\u6765\u8BB2\uFF0C\u904D\u5386\u65F6\u5982\u679C\u53D1\u751F\u4E86\u4FEE\u6539\uFF0C\u4F7F\u7528fail-fast\u673A\u5236\u4E5F\u5C31\u662F\u8BA9\u904D\u5386\u7ACB\u523B\u5931\u8D25\uFF0C\u4E0D\u518D\u7EE7\u7EED\u904D\u5386</strong></p><p><strong>Concurrent\u7C7B\u578B\u7684\u5BB9\u5668\u662F\u7EBF\u7A0B\u5B89\u5168\u7684</strong></p></li></ul></li></ol><h3 id="concurrenthashmap" tabindex="-1"><a class="header-anchor" href="#concurrenthashmap" aria-hidden="true">#</a> ConcurrentHashMap</h3><ol><li><p>\u5185\u90E8\u65B9\u6CD5\u8DDF\u666E\u901AHashMap\u65B9\u6CD5\u4E00\u6837\uFF0C\u90FD\u662F\u5B9E\u73B0\u4E86Map\u63A5\u53E3</p></li><li><p>\u91CD\u8981\u65B9\u6CD5<code>computeIfAbsent</code></p><p>\u5148\u8981\u8FDB\u884C\u68C0\u67E5\uFF0C\u5982\u679C\u7F3A\u5C11key\uFF0C\u5219\u8BA1\u7B97\u751F\u6210\u4E00\u4E2A\u503C\uFF0C\u7136\u540E\u5C06key value\u653E\u5165map</p></li><li><p>HashMap\u5728put\u8FC7\u7A0B\u4E2D\u7684\u539F\u7406</p><p>\u5148\u8BA1\u7B97hashCode\uFF0C\u627E\u5230\u5E95\u5C42Entry[]\u6570\u7EC4\u7684\u4E00\u4E2A\u4F4D\u7F6E\u8FDB\u884C\u5B58\u653E\uFF0C\u4E0D\u540ChashCode\u4ECD\u7136\u53EF\u80FD\u653E\u5230\u4E00\u4E2A\u4F4D\u7F6E</p><p><strong>\u5982\u679C\u6B64\u4F4D\u7F6E\u4E0A\u7684\u6570\u636E\u4E0D\u4E3A\u7A7A\uFF08\u610F\u5473\u7740\u6B64\u4F4D\u7F6E\u4E0A\u5B58\u5728\u4E00\u4E2A\u6216\u591A\u4E2A\u6570\u636E\uFF08\u591A\u4E2A\u6570\u636E\u4EE5\u94FE\u8868\u5F62\u5F0F\u5B58\u5728\uFF09\uFF09\uFF0C\u6BD4\u8F83key1\u548C\u5DF2\u7ECF\u5B58\u5728\u7684\u4E00\u4E2A\u6216\u591A\u4E2A\u6570\u636E\u7684\u54C8\u5E0C\u503C\uFF1A</strong></p><ul><li><strong>\u5982\u679Ckey1\u7684\u54C8\u5E0C\u503C\u4E0E\u5DF2\u7ECF\u5B58\u5728\u7684\u6570\u636E\u7684\u54C8\u5E0C\u503C\u90FD\u4E0D\u76F8\u540C\uFF0C\u6B64\u65F6key1-value1\u8FD9\u4E2AEntry\u6DFB\u52A0\u6210\u529F-----\u60C5\u51B52</strong></li><li><strong>\u5982\u679Ckey1\u7684\u54C8\u5E0C\u503C\u548C\u5DF2\u7ECF\u5B58\u5728\u7684\u67D0\u4E00\u4E2A\u6570\u636E\u7684\u54C8\u5E0C\u503C\u76F8\u540C\uFF0C\u90A3\u4E48\u7EE7\u7EED\u6BD4\u8F83\uFF0C\u8C03\u7528key1\u6240\u5728\u7C7B\u7684equals()\u65B9\u6CD5\uFF1A</strong><ul><li><strong>\u5982\u679Cequals()\u8FD4\u56DEfalse\uFF1A\u6B64\u65F6key1-value1\u6DFB\u52A0\u6210\u529F------\u60C5\u51B53</strong></li><li><strong>\u5982\u679Cequals()\u8FD4\u56DEtrue\uFF1A\u4F7F\u7528value1\u66FF\u6362\u76F8\u540Ckey\u7684value\u503C\u3002</strong></li></ul></li></ul></li><li><p>\u8981\u6CE8\u610F\u5982\u679C\u5728\u5E95\u5C42Entry[]\u6570\u7EC4\uFF0C\u5143\u7D20\u88AB\u653E\u5728\u540C\u4E00\u4E2A\u4F4D\u7F6E\uFF0C\u4EE5\u94FE\u8868\u5F62\u5F0F\u5B58\u50A8\uFF0C\u5728JDK8\uFF0C\u65B0\u52A0\u5165\u7684\u5143\u7D20\u603B\u662F\u653E\u5728\u94FE\u8868\u7684\u5C3E\u90E8\uFF0C\u5728jdk7\uFF0C\u65B0\u52A0\u5165\u7684\u5143\u7D20\u603B\u662F\u653E\u5728\u94FE\u8868\u7684\u5934\u90E8\u3002</p><p>\u5728jdk7\uFF0C\u65B0\u52A0\u5165\u7684\u5143\u7D20\u603B\u662F\u653E\u5728\u94FE\u8868\u7684\u5934\u90E8\uFF0C\u8FD9\u4E5F\u662F\u4EA7\u751F\u6B7B\u94FE\u7684\u91CD\u8981\u539F\u56E0\uFF0C\u6240\u4EE5\u5728jdk8\u8FDB\u884C\u4E86\u4FEE\u6539\u3002</p><p><strong>\u6B7B\u94FE\u662F\u53D1\u751F\u5728\u6269\u5BB9\u7684\u65F6\u5019</strong></p><p>\u6269\u5BB9\u662F\u5F80HashMap\u91CCput\u5143\u7D20\uFF0C\u5F53\u5143\u7D20\u8FBE\u5230\u4E00\u4E2A\u9608\u503C\u65F6\u8FDB\u884C\u6269\u5BB9\uFF0C\u8FD9\u4E2A\u9608\u503C\u662F\u6570\u7EC4\u957F\u5EA6 * \u52A0\u8F7D\u56E0\u5B50\uFF0C\u52A0\u8F7D\u56E0\u5B50\u9ED8\u8BA4\u662F0.75\uFF0C<strong>\u6269\u5BB9\u662F\u6269\u5BB9\u4E3A\u539F\u6765\u7684\u4E24\u500D</strong>\uFF0C<strong>\u5E95\u5C42Entry[]\u6570\u7EC4\u521D\u59CB\u5927\u5C0F\u662F16</strong>\uFF08\u6216\u8005\u8BF4HashMap\u5728\u5E95\u5C42\u521D\u59CB\u5927\u5C0F\u662F16\uFF0C\u90A3\u4E48\u9608\u503C\u662F12\uFF0C\u8D85\u8FC712\u65F6\uFF0C\u5C31\u8981\u5F00\u59CB\u6269\u5BB9\uFF09</p><p>ArrayList\u5E95\u5C42\u662FObject[]\u6570\u7EC4\uFF0C\u521D\u59CB\u5927\u5C0F\u662F10\uFF0C\u5982\u679C\u4E0D\u8DB310\uFF0C\u7B2C\u4E00\u6B21\u6269\u5BB9\uFF0C\u6269\u5BB9\u4E3A10\uFF0C\u4E4B\u540E\u90FD\u6269\u5BB9\u4E3A\u539F\u6765\u5927\u5C0F\u76841.5\u500D</p><p>\u800CStringBuffer\u548CStringBuilder\u6269\u5BB9\u90FD\u662F\u6269\u5BB9\u4E3A\u539F\u6765\u76842\u500D+2\uFF0C\u5E95\u5C42\u6570\u7EC4\u521D\u59CB\u5927\u5C0F\u662F16.</p><p>\u53EA\u8981\u662F\u6570\u7EC4\u6269\u5BB9\uFF0C\u90FD\u662F\u4F1A\u9020\u4E00\u4E2A\u65B0\u7684\u6570\u7EC4\uFF0C\u56E0\u4E3A\u6570\u7EC4\u5728\u5E95\u5C42\u7684\u957F\u5EA6\u662F\u521B\u5EFA\u65F6\u5C31\u786E\u5B9A\u4E86\u7684\uFF0C\u65B0\u5EFA\u4E00\u4E2A\u6570\u7EC4\u4E4B\u540E\uFF0C\u5C06\u539F\u6765\u6570\u7EC4\u7684\u6570\u636E\u590D\u5236\u8FC7\u6765\u3002</p><p><strong>\u6269\u5BB9\u4E4B\u540E\uFF0C\u5143\u7D20\u5728\u65B0\u7684\u6570\u7EC4\u53C8\u4F1A\u5206\u5F97\u66F4\u52A0\u5747\u5300</strong></p></li><li><p>\u6269\u5BB9\u7684\u65F6\u5019\u4F1A\u904D\u5386\u539FEntry[]\u6570\u7EC4\u7684\u67D0\u4E2A\u4F4D\u7F6E\u4E0A\u7684\u94FE\u8868\uFF0C\u904D\u5386\u6BCF\u4E00\u4E2AEntry\uFF0C\u628A\u4ED6\u4EEC\u653E\u5230\u65B0\u7684\u6570\u7EC4\u53BB</p></li><li><p>HashMap\u5728jdk7\u4EA7\u751F\u7684\u6B7B\u94FE\u95EE\u9898\uFF1A</p><p>\u6BD4\u5982\u5728Entry[]\u6570\u7EC4\u7684\u67D0\u4E2A\u4E0B\u6807\u4F4D\u7F6E\uFF0C\u6709\u4E00\u4E2A\u94FE\u8868\u662F\u8282\u70B91-\u8282\u70B92-null\uFF0C\u5373\u5934\u8282\u70B9\u5143\u7D20\u4E3A\u8282\u70B91\uFF0C\u4E0B\u4E00\u4E2A\u8282\u70B9\u4E3A\u8282\u70B92\uFF0C\u518D\u4E0B\u4E00\u4E2A\u8282\u70B9\u4E3Anull</p><p><strong>\u6B64\u65F6\u7EBF\u7A0BThread-0\u5728\u6267\u884Cput\u64CD\u4F5C</strong></p><p>\u9996\u5148\u8981\u660E\u786E\u6B7B\u94FE\u662F\u53D1\u751F\u5728\u6269\u5BB9\u65F6\uFF0C\u867D\u7136JDK8\u6539\u53D8\u4E86\u65B0\u8282\u70B9\u52A0\u5165\u94FE\u8868\u7684\u5B58\u50A8\u65B9\u5F0F\uFF0C\u89E3\u51B3\u4E86\u6B7B\u94FE\uFF0C\u4F46\u662F\u8FD8\u6709\u5176\u4ED6\u95EE\u9898\uFF0C\u6BD4\u5982\u6269\u5BB9\u4E22\u6570\u636E\uFF0C\u6839\u672C\u539F\u56E0\u662F\u56E0\u4E3A\u5728\u591A\u7EBF\u7A0B\u73AF\u5883\u4E0B\u91C7\u7528\u4E86HashMap\u8FD9\u79CD\u4E0D\u5B89\u5168\u7684\u96C6\u5408</p><p>\u90A3\u4E48\u6B64\u65F6\u5982\u679C\u53D1\u751F\u6269\u5BB9\uFF0C<strong>\u5E76\u4E14\u8FD9\u4E2A\u6269\u5BB9\u64CD\u4F5C\u7531\u53E6\u4E00\u4E2A\u7EBF\u7A0BThread-1\u6765\u6267\u884C\uFF0C\u5047\u8BBE\u6269\u5BB9\u540E\u8282\u70B91\u548C\u8282\u70B92\u8FD8\u5728\u65B0\u6570\u7EC4\uFF08\u6269\u5BB9\u90FD\u4F1A\u9020\u4E00\u4E2A\u65B0\u6570\u7EC4\uFF09\u7684\u540C\u4E00\u4E2A\u4E0B\u6807\u4F4D\u7F6E\u4E0A</strong>\uFF0C\u90A3\u4E48\u9996\u5148\u8282\u70B91\u4F1A\u5B58\u50A8\u5230\u8FD9\u4E2A\u4E0B\u6807\u4F4D\u7F6E\uFF0C\u7531\u4E8EJDK7\u4F1A\u5C06\u65B0\u52A0\u5165\u7684\u5143\u7D20\u653E\u5728\u94FE\u8868\u7684\u5934\u90E8\u800C\u4E0D\u662F\u5C3E\u90E8\uFF0C\u6240\u4EE5\u8282\u70B92\u4F1A\u52A0\u5165\u5230\u94FE\u8868\u7684\u5934\u90E8\uFF0C\u90A3\u4E48\u5728\u65B0\u6570\u7EC4\u7684\u8FD9\u4E2A\u4E0B\u6807\u4F4D\u7F6E\u4E0A\uFF0C\u94FE\u8868\u4E3A\u8282\u70B92-\u8282\u70B91-null</p><p>\u4F46\u662FThread-0\u8BB0\u5F55\u4E86\u5F53\u524D\u7684e\u4E3A\u8282\u70B91\uFF0Cnext\u4E3A\u8282\u70B92</p><p>\u6240\u4EE5\u5F53\u524D\u7684e\u662F\u8282\u70B91-null</p><p>next\u662F\u8282\u70B92-\u8282\u70B91-null</p><p>\u6240\u4EE5\u6B64\u65F6Thread\u8BA4\u4E3A\u8282\u70B91\u6307\u5411\u8282\u70B92\uFF0C\u4F46\u662F\u5B9E\u9645\u4E0A\u662F\u8282\u70B92\u6307\u5411\u8282\u70B91\uFF0C</p><p>\u90A3\u4E48\u5728\u4E0B\u4E00\u6B21\u5FAA\u73AF\u4F1A\u53D1\u751F\u5C06\u8282\u70B91-null\u79FB\u5230\u65B0\u7684\u6570\u7EC4\u7684\u94FE\u8868\u5934</p><p>e\u53D8\u4E3A\u8282\u70B92-\u8282\u70B91-null</p><p>next\u53D8\u4E3A\u8282\u70B91-null</p><p>\u518D\u4E0B\u4E00\u6B21\u5FAA\u73AF\u4F1A\u53D1\u751F\u5C06\u8282\u70B92-\u8282\u70B91-null\u79FB\u5230\u65B0\u7684\u6570\u7EC4\u7684\u94FE\u8868\u5934</p><p>e\u53D8\u4E3A\u8282\u70B91-null</p><p>next\u53D8\u4E3Anull\uFF0C\u5F62\u6210\u6B7B\u94FE</p></li><li><p>\u603B\u7ED3\uFF1A</p><p>jdk1.7HashMap\u5728\u5E76\u53D1\u73AF\u5883\u4E0B\uFF0C\u6267\u884Cput\u64CD\u4F5C\u65F6\uFF0C\u4F1A\u5F15\u8D77\u6B7B\u5FAA\u73AF\uFF0C\u56E0\u4E3A\u591A\u7EBF\u7A0B\u4F1A\u5BFC\u81F4HashMap\u7684Entry\u94FE\u8868\u5F62\u6210\u6B7B\u94FE\u5373\u73AF\u5F62\u6570\u636E\u7ED3\u6784\uFF0C\u4E00\u65E6\u5F62\u6210\u73AF\u5F62\u6570\u636E\u7ED3\u6784\uFF0C<strong>Entry\u7684next\u8282\u70B9\u6C38\u8FDC\u4E0D\u4E3A\u7A7A</strong>\uFF0C\u5C31\u4F1A\u4EA7\u751F\u6B7B\u5FAA\u73AF</p></li><li><p>JDK8\u867D\u7136\u5C06\u6269\u5BB9\u7B97\u6CD5\u505A\u4E86\u8C03\u6574\uFF0C\u5728\u6269\u5BB9\u65F6\uFF0C\u8282\u70B9\u4FDD\u6301\u4E86\u548C\u4E4B\u524D\u4E00\u6837\u7684\u987A\u5E8F\uFF0C\u65B0\u7684\u8282\u70B9\u88AB\u52A0\u5165\u5230\u94FE\u8868\u7684\u5C3E\u90E8\uFF0C\u89E3\u51B3\u4E86\u6B7B\u94FE\u95EE\u9898\uFF08<strong>\u53EA\u6709jdk7\u6709\u6B7B\u94FE\u95EE\u9898\uFF0C\u5728\u6269\u5BB9\u65F6\u4F1A\u53D1\u751F</strong>\uFF09</p><p>\u4F46JDK8\u4ECD\u4E0D\u610F\u5473\u7740\u5728\u591A\u7EBF\u7A0B\u73AF\u5883\u4E0B\u80FD\u591F\u5B89\u5168\u6269\u5BB9\uFF0C\u8FD8\u4F1A\u51FA\u73B0\u5176\u4ED6\u95EE\u9898\uFF0C\u5728jdk8\u4E0B\uFF0CHashMap\u4ECD\u7136\u662F\u7EBF\u7A0B\u4E0D\u5B89\u5168\u7684\u3002</p></li></ol><h4 id="\u91CD\u8981\u5C5E\u6027\u548C\u5185\u90E8\u7C7B" tabindex="-1"><a class="header-anchor" href="#\u91CD\u8981\u5C5E\u6027\u548C\u5185\u90E8\u7C7B" aria-hidden="true">#</a> \u91CD\u8981\u5C5E\u6027\u548C\u5185\u90E8\u7C7B</h4><ol><li><p><img src="'+ui+'" alt="image-20210910144345408"></p><p>\u5185\u90E8\u7C7Bclass Node\u662F\u6307\u540C\u4E00\u4E2A\u4E0B\u6807\u4F4D\u7F6E\u4E0A\u7684\u94FE\u8868</p><p>ForwardingNode\u4F5C\u4E3A\u65E7table\u7684\u5934\u8282\u70B9\uFF0C\u4EE3\u8868\u65E7Entry[]\u6570\u7EC4\u7684\u8FD9\u4E2A\u4F4D\u7F6E\u4E0A\u7684\u8282\u70B9\u662F\u5904\u7406\u8FC7\u7684\uFF01</p><p>TreeBin\u6307\u7EA2\u9ED1\u6811\uFF0C\u662Fjdk8\u5BF9HashMap\u5E95\u5C42\u7684\u4F18\u5316\uFF0C\u5728hash\u8868\u7684\u957F\u5EA6\u5927\u4E8E64\u548C\u94FE\u8868\u7684\u957F\u5EA6\u5927\u4E8E8\u65F6\uFF0C\u4F1A\u91C7\u7528\u7EA2\u9ED1\u6811\u6765\u4EE3\u66FF\u94FE\u8868\uFF0C\u53EF\u4EE5\u63D0\u9AD8\u67E5\u8BE2\u6548\u7387\uFF0C\u5E76\u4E14\u53EF\u4EE5\u4E00\u5B9A\u7A0B\u5EA6\u4E0A\u9632\u6B62DOS\u653B\u51FB\uFF08\u6076\u610F\u9020\u5927\u91CFhashcode\u4E00\u6837\u7684\u5BF9\u8C61\u5F80hashmap\u586B\u5145\uFF09</p><p><strong>\u94FE\u8868\u7684\u957F\u5EA6\u5927\u4E8E8\u65F6\uFF0C\u4F1A\u5C1D\u8BD5\u628A\u94FE\u8868\u8F6C\u6362\u6210\u7EA2\u9ED1\u6811\uFF0C\u4F46\u662F\u5728\u8F6C\u6362\u4E4B\u524D\uFF0C\u4F1A\u5C1D\u8BD5\u6269\u5BB9\uFF0C\u5982\u679C\u54C8\u5E0C\u8868\u7684\u957F\u5EA6\u6CA1\u6709\u8FBE\u523064\u65F6\uFF0C\u5148\u4E0D\u4F1A\u628A\u94FE\u8868\u53D8\u4E3A\u7EA2\u9ED1\u6811\uFF0C\u5148\u4F1A\u6269\u5BB9\u3002\u5F53\u54C8\u5E0C\u8868\u7684\u5BB9\u91CF\u6269\u5BB9\u523064\u65F6\uFF0C\u90A3\u4E48\u624D\u4F1A\u5C06\u94FE\u8868\u8F6C\u6362\u6210\u7EA2\u9ED1\u6811\u3002</strong></p></li></ol><h4 id="\u6784\u9020\u5668" tabindex="-1"><a class="header-anchor" href="#\u6784\u9020\u5668" aria-hidden="true">#</a> \u6784\u9020\u5668</h4><ol><li><p><img src="'+mi+'" alt="image-20210910145407027"></p><p>initialCapacity\u662F\u6307\u521D\u59CB\u5BB9\u91CF</p><ul><li>\u521D\u59CB\u5BB9\u91CF\u8FBE\u4E0D\u5230\u5E76\u53D1\u5EA6\u65F6\uFF0C\u4F1A\u8BA9\u521D\u59CB\u5BB9\u91CF = \u5E76\u53D1\u5EA6</li><li><strong>\u8BBE\u7F6E\u7684\u521D\u59CB\u5BB9\u91CF\u4E0D\u4E00\u5B9A\u662F\u771F\u6B63\u7684\u521D\u59CB\u5BB9\u91CF\uFF0C\u56E0\u4E3AtableSizeFor\u8981\u4FDD\u8BC1\u5BB9\u91CF\u662F2\u7684n\u6B21\u65B9\uFF0C\u6700\u5C0F\u662F16\uFF0C\u5982\u679C\u5C06\u521D\u59CB\u5BB9\u91CF\u8BBE\u7F6E\u4E3A8\uFF0C\u4F1A\u901A\u8FC7\u8FD9\u79CD\u8BA1\u7B97\u65B9\u5F0F\u5C06\u521D\u59CB\u5BB9\u91CF\u8BBE\u7F6E\u4E3A16</strong></li></ul><p>loadFactor\u662F\u8D1F\u8F7D\u56E0\u5B50\uFF0C\u9ED8\u8BA4\u4E3A0.75</p><p>concurrencyLevel \u5E76\u53D1\u5EA6</p></li><li><p><strong>ConcurrentHashMap\u6709\u5728table\u4E0B\u6807\u51B2\u7A81\u7684\u65F6\u5019\u624D\u4F1A\u52A0\u9501\uFF0C\u9501\u7684\u4E0D\u662F\u6574\u4E2Atable\uFF0C\u9501\u7684\u662F\u8FD9\u4E2A\u94FE\u8868\u7684\u5934\u8282\u70B9</strong></p><p>\u8FD9\u4E2A\u5730\u65B9\u4FDD\u8BC1\u4E86\u7EBF\u7A0B\u5B89\u5168\u6027\u3002\u5E76\u4E14\u662F\u7EC6\u7C92\u5EA6\u7684\u9501\uFF0C\u4FDD\u8BC1\u4E86Entry[]\u6570\u7EC4\u5176\u4ED6\u5143\u7D20\u8FD8\u80FD\u88AB\u7EBF\u7A0B\u8BBF\u95EE\u5230\u3002</p><p>\u800CHashMap\u5219\u6CA1\u6709\u8FD9\u4E2A\u64CD\u4F5C\u3002</p><p>\u5728\u521B\u5EFAConcurrentHashMap\u7684\u65F6\u5019\u4E5F\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u5168\uFF0C\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u80FD\u591F\u521B\u5EFA</p></li></ol><h4 id="jdk7-concurrenthashmap" tabindex="-1"><a class="header-anchor" href="#jdk7-concurrenthashmap" aria-hidden="true">#</a> jdk7 ConcurrentHashMap</h4><ol><li><p>\u7EF4\u62A4\u4E86<strong>\u4E00\u4E2Asegment\u6570\u7EC4</strong>\uFF0C\u6BCF\u4E2Asegment\u5BF9\u5E94\u4E00\u628A\u9501\uFF08\u5206\u6BB5\u9501\uFF09</p><p>jdk7\u662F\u628A\u9501\u52A0\u5728\u6BCF\u4E2Asegment\u5BF9\u8C61\u4E0A\uFF0C\u800Cjdk8\u662F\u628A\u9501\u52A0\u5728\u94FE\u8868\u7684\u5934\u8282\u70B9</p><p>\u7F3A\u70B9\uFF1A</p><ul><li>\u4E0D\u662F\u61D2\u60F0\u521D\u59CB\u5316</li><li>Segment\u6570\u7EC4\u9ED8\u8BA4\u5927\u5C0F\u4E3A16\uFF0C\u5BB9\u91CF\u521D\u59CB\u5316\u6307\u5B9A\u540E\u5C31\u4E0D\u80FD\u6539\u53D8\u4E86\uFF0C\u4F46\u662FJDK8\u7684Hash\u8868\u662F\u6709\u6269\u5BB9\u673A\u5236\u7684\u3002</li></ul></li><li><p><strong>\u6BCF\u4E2Asegment\u5BF9\u5E94\u4E8E\u4E00\u4E2A\u5C0F\u7684Hash\u8868\uFF08HashEntry[]\u6570\u7EC4\uFF09</strong>\uFF0C<strong>\u6BCF\u4E2AHash\u8868\u91CC\u9762\u53C8\u662F\u6570\u7EC4\u52A0\u94FE\u8868\u7684\u7ED3\u6784</strong></p><p>\u4E00\u4E2Asegment\u5BF9\u5E94\u4E8E\u4E00\u4E2A\u6570\u7EC4+\u94FE\u8868\u7ED3\u6784\u3002\u6570\u7EC4\u662FHashEntry[]\u6570\u7EC4\uFF0C\u6570\u7EC4\u91CC\u6BCF\u4E2A\u5143\u7D20\u662F\u4E00\u4E2A\u94FE\u8868\uFF0C\u94FE\u8868\u91CC\u6BCF\u4E00\u4E2A\u5143\u7D20\u662FHashEntry</p></li><li><p>jdk7\u7684HashMap\u5728\u591A\u7EBF\u7A0B\u73AF\u5883\u4E0B\uFF0C\u8FDB\u884Cput\u64CD\u4F5C\uFF0C\u4F1A\u4EA7\u751F\u73AF\u5F62\u94FE\u8868\u95EE\u9898\uFF0C\u4F1A\u4EA7\u751F\u6B7B\u94FE\uFF0C\u9020\u6210\u6B7B\u5FAA\u73AF\uFF0Cjdk8\u867D\u7136\u6539\u53D8\u4E86\u8FD9\u79CDput\u65F6\uFF0C\u5C06\u8282\u70B9\u63D2\u5165\u5230\u94FE\u8868\u7684\u5934\u90E8\u6539\u4E3A\u4E86\u8282\u70B9\u63D2\u5165\u5230\u94FE\u8868\u7684\u5C3E\u90E8\uFF0C\u89E3\u51B3\u4E86\u6B7B\u94FE\u95EE\u9898\uFF0C\u4F46\u662F\u5E76\u4E0D\u610F\u5473\u7740jdk8\u4E0B\u7684HashMap\u80FD\u591F\u5728\u591A\u7EBF\u7A0B\u73AF\u5883\u4E0B\u5B89\u5168\u6269\u5BB9\uFF0C\u4ECD\u7136\u6709\u5176\u4ED6\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002\u6839\u672C\u539F\u56E0\u662F\u56E0\u4E3AHashMap\u662F\u7EBF\u7A0B\u4E0D\u5B89\u5168\u7684</p><p>\u6240\u4EE5\u60F3\u8981\u91C7\u7528\u7EBF\u7A0B\u5B89\u5168\u7684HashMap\uFF0C\u5E94\u8BE5\u91C7\u7528ConcurrentHashMap</p><p>\u800CConcurrentHashMap\u5728jdk7\u548Cjdk8\u5B9E\u73B0\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u7684\u65B9\u5F0F\u662F\u4E0D\u540C\u7684</p></li><li><p>ConcurrentHashMap\u5728jdk7\u4E0B\u662F\u91C7\u7528segment\u5206\u6BB5\u9501\u7684\u65B9\u5F0F\u5B9E\u73B0\u7684\u7EBF\u7A0B\u5B89\u5168\uFF0C\u5728jdk8\u4E2D\u662F\u91C7\u7528\u7684CAS+Synchronized\u9501\u7684\u65B9\u5F0F\u5B9E\u73B0\u7684\u7EBF\u7A0B\u5B89\u5168\uFF0C\u8FD9\u91CC\u7684Synchronized\u53EA\u6709\u5728put\u7684\u65F6\u5019\uFF0C\u5BF9\u94FE\u8868\u7684\u5934\u90E8\u8282\u70B9\u8FDB\u884C\u4E0A\u9501\uFF0C\u5E76\u4E0D\u662F\u5BF9\u6574\u4E2AMap\u8FDB\u884C\u4E0A\u9501\uFF0C\u91C7\u7528\u7684\u662F\u7EC6\u7C92\u5EA6\u9501\uFF0C\u800C\u4E14\u5728jdk6\u4E2D\u5DF2\u7ECF\u6DFB\u52A0\u4E86Synchronized\u4ECE\u504F\u5411\u9501\u5230\u8F7B\u91CF\u7EA7\u9501\u5230Monitor\u91CD\u91CF\u7EA7\u9501\u7684\u5347\u7EA7\u65B9\u5F0F\uFF0C\u6240\u4EE5\u6548\u7387\u6709\u6240\u63D0\u5347</p><p>segment\u626E\u6F14\u7684\u9501\u7684\u89D2\u8272\uFF0C\u5B9E\u9645\u662F\u7EE7\u627F\u7684ReentrantLock\u7684\u65B9\u5F0F</p></li><li><p>\u4E3A\u4EC0\u4E48\u91C7\u7528ConcurrentHashMap\uFF0C\u800C\u4E0D\u91C7\u7528HashTable\uFF1F</p><p>HashTable\u5BB9\u5668\u4F7F\u7528synchronized\u6765\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u5168\uFF0C\u4F46\u5728\u7EBF\u7A0B\u7ADE\u4E89\u6FC0\u70C8\u7684\u60C5\u51B5\u4E0BHashTable\u7684\u6548\u7387\u5F88\u4F4E\u4E0B\uFF0C\u56E0\u4E3A\u53EA\u6709\u4E00\u628A\u76D1\u89C6\u5668\u9501\uFF0C\u5F53\u7136\u91C7\u7528synchronized\u672C\u6765\u5C31\u5E94\u8BE5\u4FDD\u8BC1\u53EA\u6709\u4E00\u628A\u76D1\u89C6\u5668\u9501\uFF0C\u6240\u4EE5\u540E\u9762\u91C7\u7528\u7684\u5206\u6BB5\u9501\u7684\u65B9\u5F0F\u3002HashTable\u5BF9get\u64CD\u4F5C\u548Cput\u64CD\u4F5C\u90FD\u8981\u4E0A\u9501\uFF0C\u6548\u7387\u4F4E\u4E0B\u3002ConcurrentHashMap\u7684get\u64CD\u4F5C\u662F\u4E0D\u9700\u8981\u4E0A\u9501\u7684\uFF0C\u56E0\u4E3A\u91C7\u7528\u4E86volatile\u6765\u4FEE\u9970\u5171\u4EAB\u53D8\u91CF\uFF0C\u6240\u6709\u7EBF\u7A0B\u5728get\u8FD9\u4E2A\u8BFB\u64CD\u4F5C\u90FD\u80FD\u4ECE\u4E3B\u5B58\u4E2D\u83B7\u5F97\u5171\u4EAB\u53D8\u91CF\u7684\u6700\u65B0\u503C\uFF0C\u4E0D\u4F1A\u5BFC\u81F4\u8BFB\u53D6\u9519\u8BEF\u7684\u60C5\u51B5\uFF0C\u6D89\u53CA\u5230\u5185\u5B58\u5C4F\u969C\uFF0C\u6240\u4EE5get\u64CD\u4F5C\u4E0D\u9700\u8981\u4E0A\u9501\u3002</p><p>\u53EA\u6709\u4E00\u628A\u76D1\u89C6\u5668\u9501\uFF0C\u5BFC\u81F4\u4E86\u5F53\u4E00\u4E2A\u7EBF\u7A0B\u8BBF\u95EEHashTable\u7684\u540C\u6B65\u65B9\u6CD5\u7684\u65F6\u5019\uFF0C\u5176\u4ED6\u7EBF\u7A0B\u4E5F\u8BBF\u95EEHashTable\u7684\u540C\u6B65\u65B9\u6CD5\u65F6\uFF0C\u4F1A\u8FDB\u5165\u963B\u585E\u6216\u8F6E\u8BE2\u72B6\u6001\uFF0C\u65E2\u4E0D\u80FDget\u4E5F\u4E0D\u80FDput\u3002\uFF08<strong>\u8FDEget()\u8FD9\u79CD\u8BFB\u64CD\u4F5C\u90FD\u4E0D\u53EF\u4EE5\uFF0C\u5E76\u4E14\u5BB9\u6613\u5F15\u8D77\u7EBF\u7A0B\u963B\u585E\uFF0C\u8FDB\u800C\u9020\u6210\u7EBF\u7A0B\u7684\u9891\u7E41\u4E0A\u4E0B\u6587\u5207\u6362\u5BFC\u81F4\u5F00\u9500</strong>\uFF09</p></li><li><p>\u6240\u4EE5ConcurrentHashMap\u5728jdk7\u4E0B\u662F\u91C7\u7528segment\u5206\u6BB5\u9501\u7684\u65B9\u5F0F\u5B9E\u73B0\u7684\u7EBF\u7A0B\u5B89\u5168</p><p>\u5206\u6BB5\u9501\uFF0C\u901A\u4FD7\u7406\u89E3\u4E3A\u6709\u591A\u4E2A\u6570\u636E\u6BB5\uFF0C\u6BCF\u4E2A\u6570\u636E\u6BB5\u5BF9\u5E94\u4E00\u628A\u9501\uFF0C\u62FF\u5230\u67D0\u4E00\u4E2A\u6570\u636E\u6BB5\u7684\u9501\uFF0C\u5C31\u53EF\u4EE5\u64CD\u4F5C\u8FD9\u4E2A\u6570\u636E\u6BB5\u7684\u5185\u5BB9\u3002</p><p>\u5F53\u591A\u4E2A\u7EBF\u7A0B\u8BBF\u95EE\u5BB9\u5668\u91CC\u4E0D\u540C\u6570\u636E\u6BB5\u7684\u6570\u636E\u65F6\uFF0C\u7EBF\u7A0B\u95F4\u5C31\u4E0D\u4F1A\u4EA7\u751F\u9501\u7ADE\u4E89\uFF0C\u63D0\u9AD8\u6548\u7387</p><p>\u9996\u5148\u5C06\u6570\u636E\u5206\u6210\u4E00\u6BB5\u4E00\u6BB5\u5730\u5B58\u50A8\uFF0C\u7136\u540E\u7ED9\u6BCF\u4E00\u6BB5\u6570\u636E\u914D\u4E00\u628A\u9501\uFF0C\u5F53\u4E00\u4E2A\u7EBF\u7A0B\u5360\u7528\u67D0\u4E00\u6BB5\u7684\u9501\u8BBF\u95EE\u5176\u4E2D\u4E00\u4E2A\u6BB5\u7684\u6570\u636E\u7684\u65F6\u5019\uFF0C\u5176\u4ED6\u6BB5\u7684\u6570\u636E\u4E5F\u80FD\u88AB\u5176\u4ED6\u7EBF\u7A0B\u8BBF\u95EE\u3002</p></li><li><p><strong>Segment\u662F\u4E00\u79CD\u53EF\u91CD\u5165\u9501---ReentrantLock</strong>\uFF0C\u5728ConcurrentHashMap\u91CC\u626E\u6F14\u9501\u7684\u89D2\u8272</p></li><li><p><strong>\u4E00\u4E2ASegment\u5305\u542B\u4E00\u4E2AHashEntry\u6570\u7EC4\uFF0C\u6BCF\u4E2AHashEntry\u662F\u4E00\u4E2A\u94FE\u8868\u7ED3\u6784\u7684\u5143\u7D20</strong></p><p>\u5C31\u76F8\u5F53\u4E8E\u4E00\u4E2ASegment\u5BF9\u5E94\u4E8E\u4E00\u4E2A\u5C0F\u7684Hash\u8868\uFF0C\u662F\u6570\u7EC4\u52A0\u94FE\u8868\u7684\u7ED3\u6784</p><p>\u5F53\u5BF9HashEntry\u6570\u7EC4\u7684\u6570\u636E\u8FDB\u884C\u4FEE\u6539\u7684\u65F6\u5019\uFF0C\u5FC5\u987B\u9996\u5148\u83B7\u5F97\u4E0E\u5B83\u5BF9\u5E94\u7684segment\u9501</p><p><img src="'+yi+'" alt="image-20210910170942805"></p></li><li><p><strong>segment\u5C31\u53EF\u4EE5\u76F4\u63A5\u7406\u89E3\u4E3A\u9501\uFF0C\u5206\u6BB5\u9501\uFF0Csegment\u5C31\u662F\u9501</strong></p></li><li><p>\u65E2\u7136ConcurrentHashMap\u4F7F\u7528\u5206\u6BB5\u9501segment\u6765\u4FDD\u62A4\u4E0D\u540C\u6BB5\u7684\u6570\u636E\uFF0C\u90A3\u4E48\u5FC5\u987B\u901A\u8FC7\u6563\u5217\u7B97\u6CD5\u5B9A\u4F4D\u5230Segment</p><p>\u8FD9\u91CC\u7684\u901A\u8FC7\u6563\u5217\u7B97\u6CD5\u5B9A\u4F4D\uFF0C\u4E0D\u662F\u7528hashCode\u901A\u8FC7\u6563\u5217\u7B97\u6CD5\u5B9A\u4F4D\uFF0C\u662F\u5C06hashCode\u518D\u6563\u5217\u4E00\u6B21\u540E\u5F97\u5230\u65B0\u7684hash\u503C\uFF0C\u518D\u901A\u8FC7\u6563\u5217\u7B97\u6CD5\u6216\u8005\u8BF4\u6620\u5C04\u7B97\u6CD5\u5B9A\u4F4D\u3002</p><p><strong>ConcurrentHashMap\u4F1A\u9996\u5148\u4F7F\u7528Wang/Jenkins hash\u7684\u53D8\u79CD\u7B97\u6CD5\u5BF9\u5143\u7D20\u7684hashCode\u8FDB\u884C\u518D\u6563\u5217</strong></p></li><li><p>\u8FDB\u884C\u518D\u6563\u5217\u7684\u539F\u56E0\uFF1A</p><p>\u51CF\u5C11\u6563\u5217\u51B2\u7A81\uFF0C\u4F7F\u5143\u7D20\u80FD\u591F\u5747\u5300\u5730\u5206\u5E03\u5728\u4E0D\u540C\u7684Segment\u4E0A\uFF0C\u52A0\u5165\u6563\u5217\u7684\u8D28\u91CF\u5DEE\u5230\u6781\u70B9\uFF0C\u90A3\u4E48\u6240\u6709\u7684\u5143\u7D20\u90FD\u5728\u4E00\u4E2Asegment\u4E2D\uFF0C\u8FD9\u6837\u4E5F\u5931\u53BB\u4E86\u5206\u6BB5\u9501\u7684\u610F\u4E49\u3002</p><p><strong>\u518D\u6563\u5217\u4E0D\u662F\u6307\u7684\u5B9A\u4F4D\u7684\u8FC7\u7A0B\uFF0C\u662F\u6307\u5BF9hashCode\u518D\u6563\u5217\u7684\u8FC7\u7A0B\uFF0C\u6BD4\u5982<code>int hash = hash(key.hashCode())</code></strong></p><p><strong>\u901A\u8FC7\u518D\u6563\u5217\u4E4B\u540E\u7684hash\u503C\uFF0C\u53BB\u5B9A\u4F4D\u3002\u5B9A\u4F4D\u662F\u901A\u8FC7\u6563\u5217\u7B97\u6CD5\u6216\u6620\u5C04\u7B97\u6CD5\u53BB\u5B9A\u4F4D</strong></p><ul><li><strong>\u5F97\u5230hashCode\u503C</strong></li><li><strong>\u518D\u6563\u5217\u5F97\u5230\u65B0\u7684hash\u503C</strong></li><li><strong>\u901A\u8FC7\u65B0\u7684hash\u503C\uFF0C\u901A\u8FC7\u6563\u5217\u51FD\u6570\u6216\u8005\u6620\u5C04\u7B97\u6CD5\u53BB\u5B9A\u4F4D\u5230segment</strong></li></ul></li><li><p><code>get()</code>\u64CD\u4F5C</p><ul><li>\u5F97\u5230hashCode\u503C</li><li>\u518D\u6563\u5217\u5F97\u5230\u65B0\u7684hash\u503C</li><li>\u901A\u8FC7\u65B0\u7684hash\u503C\uFF0C<strong>\u901A\u8FC7\u6563\u5217\u7B97\u6CD5</strong>\u5B9A\u4F4D\u5230segment <ul><li>\u5B9A\u4F4Dsegment\u4F7F\u7528\u7684\u662FhashCode\u901A\u8FC7\u518D\u6563\u5217\u540E\u5F97\u5230\u7684\u503C\u5373\u7B2C\u4E8C\u6B65\u7684\u65B0\u7684hash\u503C\u7684<strong>\u9AD8\u4F4D</strong>\u53BB<strong>\u901A\u8FC7\u6563\u5217\u7B97\u6CD5</strong>\u8FDB\u884C\u5B9A\u4F4D</li></ul></li><li>\u518D\u901A\u8FC7\u6563\u5217\u7B97\u6CD5\u5B9A\u4F4D\u5230\u5143\u7D20 <ul><li>\u5B9A\u4F4DHashEntry\uFF0C<strong>\u4F7F\u7528\u7684\u662F\u7B2C\u4E8C\u6B65\u7684hash\u503C</strong>\u53BB\u901A\u8FC7<strong>\u6563\u5217\u7B97\u6CD5</strong>\u53BB\u5B9A\u4F4D\u3002</li></ul></li></ul><p>HashTable\u5BB9\u5668\u7684get\u65B9\u6CD5\u662F\u9700\u8981\u52A0\u9501\u7684\uFF0CConcurrentHashMap\u7684get\u64CD\u4F5C\u4E0D\u9700\u8981\u52A0\u9501\uFF0C\u5171\u4EAB\u53D8\u91CF\u90FD\u5B9A\u4E49\u6210volatile\u7C7B\u578B\uFF0C\u80FD\u591F\u5728\u7EBF\u7A0B\u4E4B\u95F4\u4FDD\u6301\u53EF\u89C1\u6027\uFF0C\u80FD\u591F\u88AB\u591A\u7EBF\u7A0B\u540C\u65F6\u8BFB\uFF0C\u5E76\u4E14\u4FDD\u8BC1\u4E0D\u4F1A\u8BFB\u5230\u8FC7\u671F\u7684\u503C\u3002\u8FD9\u91CC\u7684\u539F\u7406\u662F\u5185\u5B58\u5C4F\u969C\uFF0C\u9762\u8BD5\u7684\u65F6\u5019\u53EF\u4EE5\u591A\u8BF4\u4E00\u8BF4</p></li><li><p><code>put()</code>\u65B9\u6CD5</p><ul><li>\u9996\u5148\u5B9A\u4F4D\u5230segment\uFF0C<strong>\u548C\u4E4B\u524Dget()\u65B9\u6CD5\u7684\u5B9A\u4F4D\u65B9\u5F0F\u76F8\u540C</strong></li><li>get()\u53EF\u4EE5\u4E0D\u52A0\u9501\uFF0C\u4F46\u662Fput()\u5FC5\u987B\u52A0\u9501\uFF0C\u662F\u7531\u4E8Eput\u65B9\u6CD5\u662F\u5BF9\u5171\u4EAB\u53D8\u91CF\u8FDB\u884C\u5199\u5165\u64CD\u4F5C</li><li>\u5B9A\u4F4D\u5230segment\u4E4B\u540E\uFF0C\u9996\u5148\u4F1A\u5C1D\u8BD5\u83B7\u53D6\u9501\uFF0C\u5982\u679C\u83B7\u53D6\u5931\u8D25\u80AF\u5B9A\u6709\u5176\u4ED6\u7EBF\u7A0B\u7ADE\u4E89</li><li>\u7136\u540E\u5C1D\u8BD5\u81EA\u65CB\u83B7\u53D6\u9501 <ul><li>\u5982\u679C\u91CD\u8BD5\u7684\u6B21\u6570\u8FBE\u5230\u4E86MAX_SCAN_RETRIES\uFF0C\u5219\u6539\u4E3A\u963B\u585E\u9501\u83B7\u53D6\uFF0C\u4FDD\u8BC1\u80FD\u83B7\u53D6\u6210\u529F</li></ul></li><li>\u5BF9\u5B9A\u4F4D\u5230\u7684segment\u7684HashEntry\u5224\u65AD\u662F\u5426\u9700\u8981\u8FDB\u884C\u6269\u5BB9\u3002\uFF08\u4E00\u4E2Asegment\u5BF9\u5E94\u4E8E\u4E00\u4E2AHashEntry\u6570\u7EC4\uFF0C\u6570\u7EC4\u7684\u6BCF\u4E2A\u5143\u7D20\u662F\u94FE\u8868\u7ED3\u6784\u7684\u5143\u7D20\uFF0C\u94FE\u8868\u7684\u6BCF\u4E2A\u5143\u7D20\u4E3AHashEntry\uFF09</li></ul><p>ConcurrentHashMap\u53EA\u5BF9\u67D0\u4E2ASegment\u8FDB\u884C\u6269\u5BB9\u800C\u4E0D\u4F1A\u5BF9\u6574\u4E2AMap\u8FDB\u884C\u6269\u5BB9\u3002</p></li><li><p><code>size()</code>\u65B9\u6CD5</p><p>ConcurrentHashMap\u7684\u505A\u6CD5\u662F\u5148\u5C1D\u8BD52\u6B21\u901A\u8FC7\u4E0D\u9501\u4F4FSegment\u7684\u65B9\u5F0F\u6765\u7EDF\u8BA1\u5404\u4E2Asegment\u7684\u5927\u5C0F\uFF0C\u5982\u679C\u5BB9\u5668\u7684count\u53D1\u751F\u4E86\u53D8\u5316\uFF0C\u5219\u518D\u91C7\u7528\u52A0\u9501\u7684\u65B9\u5F0F\u6765\u7EDF\u8BA1\u6240\u6709segment\u7684\u5927\u5C0F</p></li><li><p>\u7528 volatile \u4FEE\u9970\u4E86 HashEntry \u7684\u6570\u636E value \u548C \u4E0B\u4E00\u4E2A\u8282\u70B9 next\uFF0C\u4FDD\u8BC1\u4E86\u591A\u7EBF\u7A0B\u73AF\u5883\u4E0B\u6570\u636E\u83B7\u53D6\u65F6\u7684<strong>\u53EF\u89C1\u6027</strong>\uFF01</p><p>\u6240\u4EE5get\u64CD\u4F5C\u4E0D\u9700\u8981\u52A0\u9501\uFF0C\u4F46\u662Fput\u64CD\u4F5C\u662F\u5199\u64CD\u4F5C\uFF0C\u9700\u8981\u52A0\u9501\uFF0Csegment\u5C31\u662F\u9501\uFF0C\u9700\u8981\u5148\u83B7\u5F97segment\uFF0C\u624D\u80FD\u5BF9segment\u4E0B\u7684HashEntry\u8FDB\u884C\u4E0B\u4E00\u6B65\u64CD\u4F5C\u3002</p><p><img src="'+bi+'" alt="image-20210910171404634"></p></li></ol><h4 id="jdk8-concurrenthashmap" tabindex="-1"><a class="header-anchor" href="#jdk8-concurrenthashmap" aria-hidden="true">#</a> jdk8 ConcurrentHashMap</h4><ol><li><p>\u5728\u6570\u636E\u7ED3\u6784\u4E0A\uFF0C JDK1.8 \u4E2D\u7684ConcurrentHashMap \u9009\u62E9\u4E86\u4E0E HashMap \u76F8\u540C\u7684<strong>Node\u6570\u7EC4+\u94FE\u8868+\u7EA2\u9ED1\u6811</strong>\u7ED3\u6784\uFF1B\u5728\u9501\u7684\u5B9E\u73B0\u4E0A\uFF0C\u629B\u5F03\u4E86\u539F\u6709\u7684 Segment \u5206\u6BB5\u9501\uFF0C\u91C7\u7528<code> CAS + synchronized</code>\u5B9E\u73B0\u66F4\u52A0\u7EC6\u7C92\u5EA6\u7684\u9501\u3002</p><p>jdk7\u662F\u628A\u9501\u52A0\u5728\u6BCF\u4E2Asegment\u5BF9\u8C61\u4E0A\uFF0C\u800Cjdk8\u662F\u628A\u9501\u52A0\u5728\u94FE\u8868\u7684\u5934\u8282\u70B9</p><p>jdk8\u5C06\u9501\u7684\u7EA7\u522B\u63A7\u5236\u5728\u4E86\u66F4\u52A0\u7EC6\u7C92\u5EA6\u7684\u5143\u7D20\u7EA7\u522B\uFF0C\u53EA\u9700\u8981\u9501\u4F4F\u94FE\u8868\u5934\u8282\u70B9\uFF08\u5982\u679C\u662F\u7EA2\u9ED1\u6811\uFF0C\u90A3\u4E48\u9501\u4F4F\u7EA2\u9ED1\u6811\u7684\u6839\u8282\u70B9\uFF09\uFF0C\u5C31\u4E0D\u4F1A\u5F71\u54CD\u5176\u4ED6\u6570\u7EC4\u5143\u7D20\u7684\u8BFB\u5199\uFF0C\u5927\u5927\u63D0\u9AD8\u4E86\u5E76\u53D1\u5EA6\u3002</p></li><li><p><code>put()</code></p><ol><li>\u6839\u636E key \u8BA1\u7B97\u51FA hash \u503C\uFF1B</li><li>\u5224\u65AD\u662F\u5426\u9700\u8981\u8FDB\u884C\u521D\u59CB\u5316\uFF1B</li><li>\u5B9A\u4F4D\u5230 Node\uFF0C\u62FF\u5230\u9996\u8282\u70B9 f\uFF0C\u5224\u65AD\u9996\u8282\u70B9 f\uFF1A <ul><li>\u5982\u679C\u4E3A null \uFF0C\u5219\u901A\u8FC7 CAS \u7684\u65B9\u5F0F\u5C1D\u8BD5\u6DFB\u52A0\uFF1B</li><li>\u5982\u679C\u4E3A <code>f.hash = MOVED = -1</code> \uFF0C\u8BF4\u660E\u5176\u4ED6\u7EBF\u7A0B\u5728\u6269\u5BB9\uFF0C\u53C2\u4E0E\u4E00\u8D77\u6269\u5BB9\uFF1B</li><li>\u5982\u679C\u90FD\u4E0D\u6EE1\u8DB3 \uFF0Csynchronized \u9501\u4F4F f \u8282\u70B9(\u8FD9\u4E2A\u5730\u65B9\u7684\u7EA7\u522B\u662F\u5BF9\u94FE\u8868\u7684\u5934\u8282\u70B9\u8FDB\u884C\u52A0\u9501\uFF0C\u5E76\u4E0D\u5F71\u54CDEntry[]\u6570\u7EC4\u7684\u5176\u4ED6\u5143\u7D20\uFF0C\u5927\u5927\u63D0\u9AD8\u4E86\u6548\u7387)\uFF0C\u5224\u65AD\u662F\u94FE\u8868\u8FD8\u662F\u7EA2\u9ED1\u6811\uFF0C\u904D\u5386\u63D2\u5165\uFF1B</li></ul></li><li>\u5F53\u5728\u94FE\u8868\u957F\u5EA6\u8FBE\u5230 8 \u7684\u65F6\u5019\uFF0C\u6570\u7EC4\u6269\u5BB9\u6216\u8005\u5C06\u94FE\u8868\u8F6C\u6362\u4E3A\u7EA2\u9ED1\u6811\uFF08\u6269\u5BB9\u8FD8\u662F\u8F6C\u6362\u4E3A\u7EA2\u9ED1\u6811\uFF0C\u5C31\u770B\u5F53\u524D\u6570\u7EC4\u7684\u957F\u5EA6\u662F\u5426\u662F\u5927\u4E8E64\uFF0C\u5982\u679C\u6CA1\u6709\u5927\u4E8E64\uFF0C\u90A3\u4E48\u6269\u5BB9\uFF0C\u5927\u4E8E64\uFF0C\u4FBF\u8F6C\u6362\u4E3A\u7EA2\u9ED1\u6811\uFF09\u3002</li></ol></li><li><p><code>get()</code></p><ol><li>\u6839\u636E key \u8BA1\u7B97\u51FA hash \u503C\uFF0C\u5224\u65AD\u6570\u7EC4\u662F\u5426\u4E3A\u7A7A\uFF1B</li><li>\u5982\u679C\u662F\u9996\u8282\u70B9\uFF0C\u5C31\u76F4\u63A5\u8FD4\u56DE\uFF1B</li><li>\u5982\u679C\u662F\u7EA2\u9ED1\u6811\u7ED3\u6784\uFF0C\u5C31\u4ECE\u7EA2\u9ED1\u6811\u91CC\u9762\u67E5\u8BE2\uFF1B</li><li>\u5982\u679C\u662F\u94FE\u8868\u7ED3\u6784\uFF0C\u5FAA\u73AF\u904D\u5386\u5224\u65AD\u3002</li></ol><p><strong>get \u65B9\u6CD5\u548Cjdk1.7\u4E00\u6837\uFF0C\u540C\u6837\u4E0D\u9700\u8981\u52A0\u9501\u3002\u56E0\u4E3A Node \u7684\u5143\u7D20 value \u548C\u6307\u9488 next \u662F\u7528 volatile \u4FEE\u9970\u7684\uFF0C\u4FDD\u8BC1\u4E86\u5171\u4EAB\u53D8\u91CF\u7684\u53EF\u89C1\u6027\uFF0C\u5728\u591A\u7EBF\u7A0B\u73AF\u5883\u4E0B\u7EBF\u7A0BA\u4FEE\u6539\u8282\u70B9\u7684 value \u6216\u8005\u65B0\u589E\u8282\u70B9\u7684\u65F6\u5019\u662F\u5BF9\u7EBF\u7A0BB\u53EF\u89C1\u7684\u3002</strong></p><p><strong>\u8FD9\u4E5F\u662F\u5B83\u6BD4\u5176\u4ED6\u5E76\u53D1\u96C6\u5408\u6BD4\u5982 Hashtable\u3001\u7528 Collections.synchronizedMap()\u5305\u88C5\u7684 HashMap \u6548\u7387\u9AD8\u7684\u539F\u56E0\u4E4B\u4E00\u3002</strong></p></li><li><p>\u603B\u7ED3\uFF1A</p><p>jdk1.7\u548Cjdk1.8\u7684ConcurrentHashMap\u7684put()\u64CD\u4F5C\u90FD\u662F\u8981\u52A0\u9501\u7684\uFF0C\u5206\u522B\u662F\u5206\u6BB5\u9501\uFF08segment---ReentrantLock\uFF09\u548C\u5BF9\u94FE\u8868\u5934\u8282\u70B9\u8FDB\u884C\u52A0\u9501\u3002</p><p>jdk1.7\u5728put\u7684\u65F6\u5019\u4F1A\u901A\u8FC7\u81EA\u65CB\u83B7\u5F97\u9501\uFF0C\u8FBE\u5230\u4E00\u5B9A\u6B21\u6570\u540E\uFF0C\u4E00\u5B9A\u80FD\u83B7\u5F97\u9501</p><p>jdk1.8\u5728put\u7684\u65F6\u5019\u662F\u5BF9\u94FE\u8868\u5934\u90E8\u8282\u70B9\u52A0\u9501\uFF0C\u5E76\u4E0D\u5F71\u54CDEntry[]\u6570\u7EC4\u7684\u5176\u4ED6\u5143\u7D20</p><p>\u800Cget\u65B9\u6CD5\uFF0C\u5728jdk1.7\u548C1.8\u90FD\u4E0D\u9700\u8981\u52A0\u9501\uFF0C\u539F\u56E0\u5C31\u662F\u4E0A\u9762\u7B2C\u56DB\u70B9\u8BF4\u7684\u539F\u56E0</p></li><li><blockquote><p>JDK1.8 \u4E2D\u4E3A\u4EC0\u4E48\u4F7F\u7528\u5185\u7F6E\u9501 synchronized\u66FF\u6362 ReentrantLock\uFF1F\u2605\u2605\u2605\u2605\u2605</p></blockquote><ul><li>\u5728 JDK1.6 \u4E2D\uFF0C\u5BF9 synchronized \u9501\u7684\u5B9E\u73B0\u5F15\u5165\u4E86\u5927\u91CF\u7684\u4F18\u5316\uFF0C\u5E76\u4E14 synchronized \u6709\u591A\u79CD\u9501\u72B6\u6001\uFF0C\u4F1A\u4ECE\u65E0\u9501 -&gt; \u504F\u5411\u9501 -&gt; \u8F7B\u91CF\u7EA7\u9501 -&gt; \u91CD\u91CF\u7EA7\u9501\u4E00\u6B65\u6B65\u8F6C\u6362\u3002</li><li>\u51CF\u5C11\u5185\u5B58\u5F00\u9500 \u3002\u5047\u8BBE\u4F7F\u7528ReentrantLock\u6765\u83B7\u5F97\u540C\u6B65\u652F\u6301\uFF08<strong>ReentrantLock\u5B9E\u73B0\u539F\u7406\u662FAQS\u62BD\u8C61\u961F\u5217\u540C\u6B65\u673A\u5236</strong>\uFF09\uFF0C\u90A3\u4E48\u6BCF\u4E2A\u8282\u70B9\u90FD\u9700\u8981\u901A\u8FC7\u7EE7\u627F AQS \u6765\u83B7\u5F97\u540C\u6B65\u652F\u6301\u3002\u4F46\u5E76\u4E0D\u662F\u6BCF\u4E2A\u8282\u70B9\u90FD\u9700\u8981\u83B7\u5F97\u540C\u6B65\u652F\u6301\u7684\uFF0C\u53EA\u6709\u94FE\u8868\u7684\u5934\u8282\u70B9\uFF08\u7EA2\u9ED1\u6811\u7684\u6839\u8282\u70B9\uFF09\u9700\u8981\u540C\u6B65\uFF0C\u8FD9\u65E0\u7591\u5E26\u6765\u4E86\u5DE8\u5927\u5185\u5B58\u6D6A\u8D39\u3002</li></ul></li><li><blockquote><p>ConcurrentHashMap \u4E0D\u652F\u6301 key \u6216\u8005 value \u4E3A null \u7684\u539F\u56E0\uFF1F\u2605\u2605\u2605</p></blockquote><p>\u6211\u4EEC\u5148\u6765\u8BF4value \u4E3A\u4EC0\u4E48\u4E0D\u80FD\u4E3A null\u3002\u56E0\u4E3A ConcurrentHashMap \u662F\u7528\u4E8E\u591A\u7EBF\u7A0B\u7684 \uFF0C\u5982\u679C<code>ConcurrentHashMap.get(key)</code>\u5F97\u5230\u4E86 null \uFF0C\u8FD9\u5C31\u65E0\u6CD5\u5224\u65AD\uFF0C\u662F\u6620\u5C04\u7684value\u662F null \uFF0C\u8FD8\u662F\u6CA1\u6709\u627E\u5230\u5BF9\u5E94\u7684key\u800C\u4E3A null \uFF0C\u5C31\u6709\u4E86\u4E8C\u4E49\u6027\u3002</p><p>\u800C\u7528\u4E8E\u5355\u7EBF\u7A0B\u72B6\u6001\u7684 HashMap \u5374\u53EF\u4EE5\u7528<code>containsKey(key)</code> \u53BB\u5224\u65AD\u5230\u5E95\u662F\u5426\u5305\u542B\u4E86\u8FD9\u4E2A null \u3002</p></li><li><blockquote><p>ConcurrentHashMap \u7684\u5E76\u53D1\u5EA6\u662F\u4EC0\u4E48\uFF1F\u2605\u2605</p></blockquote><p>\u5E76\u53D1\u5EA6\u53EF\u4EE5\u7406\u89E3\u4E3A\u7A0B\u5E8F\u8FD0\u884C\u65F6<strong>\u80FD\u591F\u540C\u65F6\u66F4\u65B0 ConccurentHashMap\u4E14\u4E0D\u4EA7\u751F\u9501\u7ADE\u4E89\u7684\u6700\u5927\u7EBF\u7A0B\u6570</strong>\u3002\u5728JDK1.7\u4E2D\uFF0C\u5B9E\u9645\u4E0A\u5C31\u662FConcurrentHashMap\u4E2D\u7684\u5206\u6BB5\u9501\u4E2A\u6570\uFF0C\u5373Segment[]\u7684\u6570\u7EC4\u957F\u5EA6\uFF0C\u9ED8\u8BA4\u662F16\uFF0C\u8FD9\u4E2A\u503C\u53EF\u4EE5\u5728\u6784\u9020\u51FD\u6570\u4E2D\u8BBE\u7F6E\u3002</p><p>\u5982\u679C\u81EA\u5DF1\u8BBE\u7F6E\u4E86\u5E76\u53D1\u5EA6\uFF0CConcurrentHashMap \u4F1A<strong>\u4F7F\u7528\u5927\u4E8E\u7B49\u4E8E\u8BE5\u503C\u7684\u6700\u5C0F\u76842\u7684\u5E42\u6307\u6570\u4F5C\u4E3A\u5B9E\u9645\u5E76\u53D1\u5EA6</strong>\uFF0C\u4E5F\u5C31\u662F\u6BD4\u5982\u4F60\u8BBE\u7F6E\u7684\u503C\u662F17\uFF0C\u90A3\u4E48\u5B9E\u9645\u5E76\u53D1\u5EA6\u662F32\u3002\u5982\u679C\u5C0F\u4E8E16\uFF0C\u90A3\u4E48\u5B9E\u9645\u5E76\u53D1\u5EA6\u662F16.</p></li><li><blockquote><p>ConcurrentHashMap \u8FED\u4EE3\u5668\u662F\u5F3A\u4E00\u81F4\u6027\u8FD8\u662F\u5F31\u4E00\u81F4\u6027\uFF1F\u2605\u2605</p></blockquote><p>\u4E0E HashMap \u8FED\u4EE3\u5668\u662F\u5F3A\u4E00\u81F4\u6027\u4E0D\u540C\uFF0CConcurrentHashMap \u8FED\u4EE3\u5668\u662F\u5F31\u4E00\u81F4\u6027\u3002</p><p>ConcurrentHashMap \u7684\u8FED\u4EE3\u5668\u521B\u5EFA\u540E\uFF0C\u5C31\u4F1A\u6309\u7167\u54C8\u5E0C\u8868\u7ED3\u6784\u904D\u5386\u6BCF\u4E2A\u5143\u7D20\uFF0C\u4F46\u5728\u904D\u5386\u8FC7\u7A0B\u4E2D\uFF0C\u5185\u90E8\u5143\u7D20\u53EF\u80FD\u4F1A\u53D1\u751F\u53D8\u5316\uFF0C\u5982\u679C\u53D8\u5316\u53D1\u751F\u5728<strong>\u5DF2\u904D\u5386\u8FC7\u7684\u90E8\u5206\uFF0C\u8FED\u4EE3\u5668\u5C31\u4E0D\u4F1A\u53CD\u6620\u51FA\u6765</strong>\uFF0C\u800C\u5982\u679C\u53D8\u5316\u53D1\u751F<strong>\u5728\u672A\u904D\u5386\u8FC7\u7684\u90E8\u5206\uFF0C\u8FED\u4EE3\u5668\u5C31\u4F1A\u53D1\u73B0\u5E76\u53CD\u6620\u51FA\u6765\uFF0C\u8FD9\u5C31\u662F\u5F31\u4E00\u81F4\u6027\u3002</strong></p></li><li><blockquote><p>\u4E3A\u4EC0\u4E48\u8BF4JDK1.8 \u91C7\u7528<code>CAS+synchronized </code>\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u5168\uFF1F</p></blockquote><ol><li>ConcurrentHashMap \u5728put\u65F6\uFF0C\u5B9A\u4F4D\u5230Node\uFF0C<strong>\u5982\u679C\u8282\u70B9\u4E3Anull\uFF0C\u91C7\u7528CAS\u7684\u65B9\u5F0F\u5C1D\u8BD5\u6DFB\u52A0</strong></li><li>put\u65F6\uFF0C\u5B9A\u4F4D\u5230Node\uFF0C\u5982\u679CNode\u4E0D\u4E3Anull\uFF0C\u4F1A\u9501\u4F4F\u94FE\u8868\u7684\u5934\u8282\u70B9</li><li>\u5B9A\u4F4D\u5230Node\uFF0C\u9996\u5148\u9700\u8981\u6839\u636Ekey\u8BA1\u7B97\u51FAhash\u503C</li></ol></li><li><blockquote><h4 id="jdk1-7-\u4E0E-jdk1-8-\u4E2Dconcurrenthashmap-\u7684\u533A\u522B-\u2605\u2605\u2605\u2605\u2605" tabindex="-1"><a class="header-anchor" href="#jdk1-7-\u4E0E-jdk1-8-\u4E2Dconcurrenthashmap-\u7684\u533A\u522B-\u2605\u2605\u2605\u2605\u2605" aria-hidden="true">#</a> JDK1.7 \u4E0E JDK1.8 \u4E2DConcurrentHashMap \u7684\u533A\u522B\uFF1F\u2605\u2605\u2605\u2605\u2605</h4></blockquote><ul><li><p>\u6570\u636E\u7ED3\u6784\uFF1A\u53D6\u6D88\u4E86 Segment \u5206\u6BB5\u9501\u7684\u6570\u636E\u7ED3\u6784\uFF0C\u53D6\u800C\u4EE3\u4E4B\u7684\u662F\u6570\u7EC4+\u94FE\u8868+\u7EA2\u9ED1\u6811\u7684\u7ED3\u6784\uFF0C\u5C31\u6CA1\u6709segment\u5206\u6BB5\u8FD9\u79CD\u8BF4\u6CD5\u4E86\u3002</p></li><li><p>\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u5168\u673A\u5236\uFF1AJDK1.7\u91C7\u7528 Segment \u7684\u5206\u6BB5\u9501\u673A\u5236\u5B9E\u73B0\u7EBF\u7A0B\u5B89\u5168\uFF0C\u5176\u4E2D <strong>Segment \u7EE7\u627F\u81EA ReentrantLock</strong> \u3002JDK1.8 \u91C7\u7528<code>CAS+synchronized </code>\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u5168\u3002</p></li><li><p>\u9501\u7684\u7C92\u5EA6\uFF1AJDK1.7 \u662F\u5BF9\u9700\u8981\u8FDB\u884C\u6570\u636E\u64CD\u4F5C\u7684 Segment \u52A0\u9501\uFF0CJDK1.8 \u8C03\u6574\u4E3A\u5BF9\u6BCF\u4E2A\u6570\u7EC4\u5143\u7D20\u52A0\u9501\uFF08Node\uFF09\u3002</p></li><li><p>\u94FE\u8868\u8F6C\u5316\u4E3A\u7EA2\u9ED1\u6811\uFF1A\u5B9A\u4F4D\u8282\u70B9\u7684 hash \u7B97\u6CD5\u7B80\u5316\u4F1A\u5E26\u6765\u5F0A\u7AEF\uFF0Chash \u51B2\u7A81\u52A0\u5267\uFF0C\u56E0\u6B64\u5728\u94FE\u8868\u8282\u70B9\u6570\u91CF\u5927\u4E8E 8\uFF08\u4E14\u6570\u636E\u603B\u91CF\u5927\u4E8E\u7B49\u4E8E 64\uFF09\u65F6\uFF0C\u4F1A\u5C06\u94FE\u8868\u8F6C\u5316\u4E3A\u7EA2\u9ED1\u6811\u8FDB\u884C\u5B58\u50A8\u3002</p><ul><li><p><strong>\u5C06\u94FE\u8868\u8F6C\u6362\u4E3A\u7EA2\u9ED1\u6811\u4E4B\u524D\uFF0C\u8981\u5224\u65AD\u80FD\u5426\u8FDB\u884C\u6269\u5BB9\uFF0C\u5982\u679C\u80FD\u8FDB\u884C\u6269\u5BB9\uFF0C\u90A3\u4E48\u8981\u5148\u8FDB\u884C\u6269\u5BB9\uFF0C\u6269\u5BB9\u5230\u6570\u7EC4\u7684\u5BB9\u91CF\u662F64\u4E4B\u540E\uFF0C\u8FD9\u65F6\u5982\u679C\u94FE\u8868\u957F\u5EA6\u5927\u4E8E8\uFF0C\u90A3\u4E48\u5C31\u5C06\u94FE\u8868\u8F6C\u6362\u4E3A\u7EA2\u9ED1\u6811\u3002</strong></p><p><strong>\u5982\u679C\u54C8\u5E0C\u8868\u7684\u957F\u5EA6\u6CA1\u6709\u8FBE\u523064\u65F6\uFF0C\u5148\u4E0D\u4F1A\u628A\u94FE\u8868\u53D8\u4E3A\u7EA2\u9ED1\u6811\uFF0C\u5148\u4F1A\u6269\u5BB9\uFF0C\u6269\u5BB9\u4E4B\u540E\uFF0C\u4F1A\u5C06\u539FEntry[]\u6570\u7EC4\u7684\u6570\u636E\u8FC1\u79FB\uFF0C\u8FD9\u4E2A\u65F6\u5019\u4F1A\u6839\u636E\u65B0\u7684\u5BB9\u91CF\u91CD\u65B0\u8FDB\u884C\u6563\u5217\u5B58\u50A8\u3002\u6240\u4EE5\u5C31\u4E0D\u4E00\u5B9A\u94FE\u8868\u957F\u5EA6\u8D85\u8FC78\uFF0C\u5728\u8FD9\u4E4B\u540E\uFF0C\u8D85\u8FC78\uFF0C\u90A3\u4E48\u8F6C\u6362\u4E3A\u7EA2\u9ED1\u6811</strong></p></li></ul></li><li><p>\u67E5\u8BE2\u65F6\u95F4\u590D\u6742\u5EA6\uFF1A\u4ECE JDK1.7\u7684\u904D\u5386\u94FE\u8868O(n)\uFF0C JDK1.8 \u53D8\u6210\u904D\u5386\u7EA2\u9ED1\u6811O(logN)\u3002</p></li></ul></li></ol><h2 id="happens-before\u7684\u51E0\u79CD\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#happens-before\u7684\u51E0\u79CD\u89C4\u5219" aria-hidden="true">#</a> happens-before\u7684\u51E0\u79CD\u89C4\u5219</h2><ol><li><p>\u7A0B\u5E8F\u987A\u5E8F\u89C4\u5219</p></li><li><p>\u76D1\u89C6\u5668\u9501\u89C4\u5219---\u5BF9\u4E00\u4E2A\u9501\u7684\u89E3\u9501\uFF0Chappens-before\u4E8E\u968F\u540E\u5BF9\u8FD9\u4E2A\u9501\u7684\u52A0\u9501</p></li><li><p>volatile\u53D8\u91CF\u89C4\u5219---\u5BF9\u4E00\u4E2Avolatile\u53D8\u91CF\u7684\u5199\uFF0Chappens-before\u4E8E\u4EFB\u610F\u540E\u7EED\u5BF9\u8FD9\u4E2Avolatile\u53D8\u91CF\u7684\u8BFB\uFF0C\u6D89\u53CA\u5230\u5185\u5B58\u5C4F\u969C</p></li><li><p>\u4F20\u9012\u6027\uFF1A\u5982\u679CA happens-before B, \u4E14B happens-before C\uFF0C \u90A3\u4E48A happens-before C</p></li></ol>',141);function _i(fi,Ai){return Ci}var Mi=i(ki,[["render",_i],["__file","\u5E76\u53D1\u7F16\u7A0B.html.vue"]]);export{Mi as default};
